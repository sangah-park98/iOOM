/*[list] Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞ get*/
var notPdfDate ="";
/*[list] Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞ get*/
$( document ).ready(function() {
	//setTimeout(exportPdf, 500);
});

$(document).ready(function() {
	var dashboardYy = new Date().getFullYear();
	
	
	$('.band-calendar').each(function(){ regCaldash(this) ;})
	  //Ï∫òÎ¶∞Îçî Ìè¨Îß∑
	$('.datepicker').datepicker("option","dateFormat",dashFormat);

	  var date = new Date();
	  var month = date.getMonth();
	  var dayday = date.getDate();
	  
	  var today = new Date().toISOString().substring(0,7);
	  
	  $("#dashbordDate").val(today);

	// ÎåÄÏãúÎ≥¥Îìú Ï†ïÎ≥¥Í≤ÄÏÉâ
	//fn_selectDashboadInfo();
	//fn_moreNotice($("#moreNoticeList"));
	$("#chartTarget a").click(function() {
		$('.subOutter ol li #' + $(this).attr('id')).click();
		$('.subOutter, .bg').hide();

	})

	let nowYear = new Date().getFullYear();
	let nowMonth = new Date().getMonth() + 1;
	const objYMList = [];
	const yearMonthList = [];
	
	for (let i = nowYear; i >= 2020; i--) {
		for (let j = 12; j >= 1; j--) {
			if (i == nowYear && j > nowMonth) continue;
			
			let obj = i + "-" + (j <= 9 ? "0" + j : j);
			objYMList.push({ i: obj });
			yearMonthList.push(obj);
		}
	}
	
	const currentDate = `${nowYear}-${nowMonth <= 9 ? "0" + nowMonth : nowMonth}`;
	const yearMonthOptions = fn_makeSelect(objYMList, currentDate);
	document.getElementById("dashbordDate").innerHTML = yearMonthOptions;


	
	fn_dashInfo1("02");
	fn_dashManagerInfo();
});




function fn_makeSelect(objList, curVal) {
    let result = "";
    const optionHtml = "<option value='{key}' {selected}>{val}</option>";
    for (let i = 0; i < objList.length; i++) {
        const obj = objList[i];
        for (let x in obj) {
            let key = obj[x]; // 'i'
            let selected = key === curVal ? "selected" : "";
            const curObj = { key: key, val: key, selected: selected };
            result += fn_makeObj(curObj, optionHtml);
        }
    }
    return result;
}

function fn_makeObj(obj, template) {
    return template
        .replace("{key}", obj.key)
        .replace("{val}", obj.val)
        .replace("{selected}", obj.selected);
}


function fn_dashSrch(){
	
	const activeElement = document.querySelector("#chartType li.active");
	
	// Í∞í ÏÑ†Ïñ∏
	let activeValue = null;

    if (activeElement.classList.contains("status-tab-imp")) {
        activeValue = "02"; // ÏàòÏûÖ
    } else if (activeElement.classList.contains("status-tab-exp")) {
        activeValue = "01"; // ÏàòÏ∂ú
    }
	
    var dashDate = $("#dashbordDate").val();
	
    fn_dashInfo1(activeValue);
	
}


function fn_rptType(type){
	if (type=="01"){
		const tabType1 = document.querySelector('.status-tab-exp');
		const tabType2 = document.querySelector('.status-tab-imp');
		tabType1.classList.add("active");
	    tabType2.classList.remove("active");
	} else {
		const tabType1 = document.querySelector('.status-tab-exp');
		const tabType2 = document.querySelector('.status-tab-imp');
	    tabType1.classList.remove("active");
	    tabType2.classList.add("active");
	}
	fn_dashInfo1(type);
}

function fn_dashInfo1(type){
	
	
	fn_loading(true);
	var sData = {};
	sData["srch1"] = type;
	sData["srch2"] = $("#dashbordDate").val();
	
	$.ajax({
		type : "POST",
		url : "/dash/selectDashboardInfo1.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			$("#dashInfo1").html('');
			document.querySelector('#myChart').remove();
		    document.querySelector('.myChartClass').innerHTML = '<canvas id="myChart" height="225"></canvas>'
			var newRow = "";
			var labelDate = [];  		// xÏ∂ï Í∞í
			var expCnt = [];  		// Í±¥Ïàò Í∞í
			var expKrw = []; 
			// Í∏àÏï° Í∞í
			var impCnt = [];  		// Í±¥Ïàò Í∞í
			var impKrw = []; 		// Í∏àÏï° Í∞í
			var impTax = []; 		// Í∏àÏï° Í∞í
				
				for (var i = 0; i < data.resultList.length; i++) {
					newRow = "<tr>" +
								 "<td id='sumDate' style='text-align: center;'>"+data.resultList[i].sumDate + "</td>" +
								 "<td>"+data.resultList2[i].cnt + "</td>" +
								 "<td>"+data.resultList2[i].sumTax + "</td>" +
								 "<td>"+data.resultList2[i].sumKrw + "</td>" +
								 "<td>"+data.resultList[i].cnt + "</td>" +
								 "<td>"+data.resultList[i].sumKrw + "</td>" +
								 "</tr>"
					$("#dashInfo1").append(newRow);
				}
				
				for (var i = data.resultList.length - 1; i >= 0; i--) {
					labelDate.push(data.resultList[i].sumDate);
					expCnt.push(data.resultList[i].cnt);
					
					impCnt.push(data.resultList2[i].cnt);
					
					var strNumber = data.resultList[i].sumKrw;
					var number = parseInt(strNumber.replace(/,/g, ""), 10);
					
					var strNumber2 = data.resultList2[i].sumKrw;
					var number2 = parseInt(strNumber2.replace(/,/g, ""), 10);
					
					var strNumber3 = data.resultList2[i].sumTax;
					var number3 = parseInt(strNumber3.replace(/,/g, ""), 10);
					expKrw.push(number);
					impKrw.push(number2);
					impTax.push(number3);
				}
			// Ï∞®Ìä∏ ÏÉùÏÑ±
		if (type == "01"){
		  	var ctx = document.getElementById('myChart').getContext('2d');
		  	var myChart = new Chart(ctx, {
		    	type: 'bar',
		    	data: {
		      		labels: labelDate,
		      		datasets: [
		        		{
		          			type: 'bar',
		          			label: expVal /*'ÏàòÏ∂úÍ∞ÄÍ≤©(KRW)'*/,
		          			data: expKrw,
		          			backgroundColor: 'rgba(255, 99, 132, 0.2)',
		          			borderColor: 'rgba(255, 99, 132, 1)',
		          			borderWidth: 1,
		          			yAxisID: 'bar-y-axis'
		        		},
		        		{
		          			type: 'line',
		          			label: cnt /*'Í±¥Ïàò'*/,
		          			data: expCnt,
		          			backgroundColor: 'rgba(54, 162, 235, 0.2)',
		          			borderColor: 'rgba(54, 162, 235, 1)',
		          			borderWidth: 1,
		          			fill: false,
		          			yAxisID: 'line-y-axis'
		        		}
		      		]
		    	},
		    options: {
			    	responsive: true,
			        maintainAspectRatio: false,
		      		scales: {
		      			'bar-y-axis': {
		  					id: 'bar-y-axis',
		  					type: 'linear',
		  					position: 'left',
		  					beginAtZero: true
						},
		        		'line-y-axis': {
		  					id: 'line-y-axis',
		  					type: 'linear',
		  					position: 'right',
		 	 				beginAtZero: true
		        		}
		    		}
		    	}
			});
				} else {
					var ctx = document.getElementById('myChart').getContext('2d');
				  	var myChart = new Chart(ctx, {
				    	type: 'bar',
				    	data: {
				      		labels: labelDate,
				      		datasets: [
				        		{
				          			type: 'bar',
				          			label: impVal /*'ÏàòÏûÖÍ∞ÄÍ≤©(KRW)'*/,
				          			data: impKrw,
				          			backgroundColor: 'rgba(255, 99, 132, 0.2)',
				          			borderColor: 'rgba(255, 99, 132, 1)',
				          			borderWidth: 1,
				          			yAxisID: 'bar-y-axis'
				        		},
				        		{
				          			type: 'bar',
				          			label: taxPaid /*'ÎÇ©Î∂ÄÏÑ∏Ïï°(KRW)'*/,
				          			data: impTax,
				          			backgroundColor: 'rgba(155, 200, 50, 0.2)',
				          			borderColor: 'rgba(155, 200, 50, 1)',
				          			borderWidth: 1,
				          			yAxisID: 'bar-y-axis'
				        		},
				        		{
				          			type: 'line',
				          			label: cnt /*'Í±¥Ïàò'*/,
				          			data: impCnt,
				          			backgroundColor: 'rgba(54, 162, 235, 0.2)',
				          			borderColor: 'rgba(54, 162, 235, 1)',
				          			borderWidth: 1,
				          			fill: false,
				          			yAxisID: 'line-y-axis'
				        		}
				      		]
				    	},
				    options: {
					    	responsive: true,
					        maintainAspectRatio: false,
				      		scales: {
				      			'bar-y-axis': {
				  					id: 'bar-y-axis',
				  					type: 'linear',
				  					position: 'left',
				  					beginAtZero: true
								},
								
				        		'line-y-axis': {
				  					id: 'line-y-axis',
				  					type: 'linear',
				  					position: 'right',
				 	 				beginAtZero: true
				        		}
				    		}
				    	}
					});
				}
			fn_loading(false);
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSearchError);
        	}
		}
	});
}


function fn_dashManagerInfo(){
    var sData = {};
    $.ajax({
        type : "POST",
        url : "/dash/selectDashManagerInfo.do",
        data : sData,
        beforeSend : function(xmlHttpRequest){
            xmlHttpRequest.setRequestHeader("AJAX", "true");
        },
        dataType : "json",
        success : function(data) {
            $("#dashManagerInfo").html('');
            var newRow = "";
            
            if (data.resultList.length == 0) {
                newRow = "<tr>" +
                         "<td style='text-align: center;'></td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "</tr>";
                $("#dashManagerInfo").append(newRow);
            } else if(lang == 'en') {
            	for (var i = 0; i < data.resultList.length; i++) {
                    newRow = "<tr>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrType + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrEmail + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrTel + "</td>" +
                             "</tr>";
                    $("#dashManagerInfo").append(newRow);
            	}
            } else {
                for (var i = 0; i < data.resultList.length; i++) {
                    newRow = "<tr>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrType + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrNm + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrEmail + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrTel + "</td>" +
                             "</tr>";
                    $("#dashManagerInfo").append(newRow);
                }
            }
        },
        error : function(e, textStatus, errorThrown) {
            if(e.status == 400){
                alert("Your request is up. Please log back in if you wish to continue");
                location.href = document.referrer;
            } else {
                console.log(errorThrown);
                alert("There was an error processing your request.");
            }
        }
    });
}


// Í≥µÏßÄÏÇ¨Ìï≠ ÌÅ¥Î¶≠
function fn_callNoticePop(noticeSeq) {
	$("#dashNoticePop").find("input").val(null);
	$("#dashNoticePop").find("textarea").val(null);
	$("#dashNoticePop").modal("show");
	$("#notiIcon" + noticeSeq + " #newicon").hide();

	var uData = {};
	uData["srch1"] = noticeSeq;
	$.ajax({
		type : "POST",
		url : "/base/updateReadNotice.do",
		data : JSON.stringify(uData),
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		contentType : "application/json; charset=utf-8",
		success : function(data) {
			if (data == "success") {
				fn_searchDashNotice(noticeSeq);
			}
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSaveError);
        	}
		}
	});

};

// Í≥µÏßÄÏÇ¨Ìï≠ ÌåùÏóÖÍ≤ÄÏÉâ
function fn_searchDashNotice(noticeSeq) {
	var sData = {};
	sData["srch1"] = noticeSeq;

	$.ajax({
		type : "POST",
		url : "/dash/selectDashNoticeInfo.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			if (data.result.dashFileNm == undefined
					|| data.result.dashFileNm == "") {
				$("#dashNoticeAttach").hide();
			} else {
				$("#dashNoticeAttach").show();
			}

			$.each(data.result, function(key, value) {
				$("#dashNoticePop").find("input[name='" + key + "']")
						.val(value);
				$("#dashNoticePop").find("textarea[name='" + key + "']").val(
						value);
			});
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSearchError);
        	}
		}
	});

};

// ÏùΩÏùåÏ≤¥ÌÅ¨
function fn_noticeReadCheck() {
	for (i = 0; i < colReadList.length; i++) {
		$("#notiIcon" + colReadList[i] + " #newicon").hide();
	}
}

// Í≥µÏßÄÏÇ¨Ìï≠ Ï°∞Ìöå
function fn_moreNotice(elemVal) {
	elemVal.val(Number(elemVal.val()) + 10);
	var nData = {};
	nData["startPoint"] = Number(elemVal.val());
	$.ajax({
		type : "POST",
		url : "/base/selectMoreNoticeList.do",
		data : nData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			colNoticecnt = data.totCnt;
			setTimeout(function() {
				fn_noticeList(data)
			}, 0.0001);
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				// alert(msgSearchError);
        	}
		}
	});

}

// Î¶¨Ïä§Ìä∏ Í∑∏Î†§Ï£ºÎäî Î∂ÄÎ∂Ñ
function fn_noticeList(data) {
	if (data.totCnt > Number($("#moreNoticeList").val()) - 10
			|| $("#moreNoticeList").val() == "0") {
		$("#noticeTbl tbody").children().remove();
		var rowData;
		for (var i = 0; i < data.noticeList.length; i++) {
			rowData = data.noticeList[i];
			var rowText = "<tr>";
			rowText = rowText + "<tr onclick='fn_callNoticePop("
					+ rowData.noticeSeq + ")' style='cursor:pointer;'>";
			rowText = rowText + "<td>" + rowData.noticeSn + "</td>";
			rowText = rowText + "<td align='left' id='notiTit"
					+ rowData.noticeSeq + "'>" + rowData.title + "</td>";
			rowText = rowText
					+ "<td id='notiIcon"
					+ rowData.noticeSeq
					+ "'><span class='badge badge-info' style='margin-right:5px' id='newicon'>NEW</span></td>"
			rowText = rowText + "<td >" + rowData.regDt + "</td> ";
			rowText = rowText + "</tr>";
			$("#noticeTbl tbody").append(rowText);
			$("#noticeTbl").css("border-collapse", "collapse")
			$("#noticeTbl tbody").css("overflow-y", "hidden ")
			// $("#noticeTbl tbody").css("height","300px")
		}
		fn_noticeReadCheck();
	} else {
		alert(msgNotice);
	}
};

// notice modal popup
$('ul.bg-white li').on('click', function(){
	var dashNoticeSeq = $(this).find('p.text-sm:hidden').text();
    $('#dashNoticePop').show();
    fn_dashNoticeModalContentPopUp(dashNoticeSeq);
});


function fn_dashNoticeModalContentPopUp(dashNoticeSeq){
	var sData = {};
	sData["srch3"] = dashNoticeSeq;
	$.ajax({
		type : "POST",
		url : "/base/selectDashNoticeViewList.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType: "json",
        success : function(data) {
        	fillDashNoticeModalContent(data.resultList);
        },
        error : function(e, textStatus, errorThrown) {
        	if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
	        	console.log(errorThrown);
	        	alert(msgSearchError);
        	}
        }
	});
};

function fillDashNoticeModalContent(resultList) {
    var notice = resultList[0];
    var noticeDt = notice.noticeDt;
    var year = noticeDt.substring(0, 4);
    var month = noticeDt.substring(4, 6);
    var day = noticeDt.substring(6, 8);
    var formattedNoticeDt = year + "." + month + "." + day;
    
    var edtDt = notice.edtDt;

    document.querySelector('.dashNotice-modal h3').textContent = notice.titleKr;
    document.querySelector('.dashNotice-modal span').textContent = notice.date;
    // document.querySelector('.dashNotice-modal span').textContent = notice.edtDt;
    document.querySelector('.dashNotice-modal textarea').textContent = notice.cnKr;
    
    var strHtml = "";
    if (notice.fileOrgNm) {
        strHtml = '<a href="#" id="dashDownload" style="color:#030303"><i class="fa-regular fa-floppy-disk"></i> Ï≤®Î∂ÄÌååÏùº : ' + notice.fileOrgNm + '</a>';
    }
    
    var dateInfo = document.querySelector('.dashNotice-modal .text-sm');
    if(edtDt == '' || edtDt == null) {
    	dateInfo.textContent = 'Îì±Î°ùÏùº: ' + formattedNoticeDt;
    } else {
    	/*var edtyear = edtDt.substring(0, 4);
        var edtmonth = edtDt.substring(4, 6);
        var edtday = edtDt.substring(6, 8);
        var formattedEdtDt = edtyear + "." + edtmonth + "." + edtday;
    	dateInfo.textContent = 'Îì±Î°ùÏùº: ' + formattedNoticeDt + ' , ÏàòÏ†ïÏùº: ' + formattedEdtDt;*/
    }
    dateInfo.style.fontSize = '13px';
    
    document.querySelector('.dashNotice-modal .text-base').innerHTML = strHtml;
    
    var dashDownloadLink = document.getElementById('dashDownload');
    if (notice.fileOrgNm) {
	    dashDownloadLink.addEventListener('mouseenter', function() {
	    dashDownloadLink.style.color = 'rgb(45 126 98)';
	    dashDownloadLink.style.fontWeight = 'bold';
	    });
	
		dashDownloadLink.addEventListener('mouseleave', function() {
			 dashDownloadLink.style.color = '#030303';
			 dashDownloadLink.style.fontWeight = '';
		});
    }
}


$(document).on('click', '#dashDownload', function(){
	const htmlContent = event.target.innerHTML.trim();
	const fileOrgNm = htmlContent.split(' Ï≤®Î∂ÄÌååÏùº : ')[1];
    $("#dashFileDown").val(fileOrgNm);
    document.dashFileDownForm.action = "/cmmn/dashFileDown.do";
    document.dashFileDownForm.submit();
})

// news modal popUp 
function dashNoticeClose(){
	$("#dashNoticePop").hide();
}

$('div.bg-blue li').on('click', function(){
	var dashNewsSeq = $(this).find('p.text-sm:hidden').text();
    $('#dashNewsPop').show();
    fn_dashNewsModalContentPopUp(dashNewsSeq);
});


function fn_dashNewsModalContentPopUp(dashNewsSeq){
	var sData = {};
	sData["srch3"] = dashNewsSeq;
	$.ajax({
		type : "POST",
		url : "/cmmn/selectNewsModalViewList.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType: "json",
        success : function(data) {
        	filldashNewsModalContent(data.resultList);
        },
        error : function(e, textStatus, errorThrown) {
        	if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
	        	console.log(errorThrown);
	        	alert(msgSearchError);
        	}
        }
	});
};


function filldashNewsModalContent(resultList) {
    var news = resultList[0];
    var regDt = news.regDt;
    var year = regDt.substring(0, 4);
    var month = regDt.substring(4, 6);
    var day = regDt.substring(6, 8);
    var formattedNewsDt = year + "." + month + "." + day;

    var edtDt = news.edtDt;

    document.querySelector('.dashNews-modal h3').textContent = news.titleKr || '';
    document.querySelector('.dashNews-modal span').textContent = news.regDt || '';
    
    var strHtml = '';
    if (news.fileName && news.fileName.trim() !== '') {
        var fileNames = news.fileName.split('/');
        strHtml = fileNames.map(function(name) {
            return '<a href="#" class="news-file-name" style="color:#030303;">' + '&nbsp;&nbsp;&nbsp;&nbsp;' + name + '</a>';
        }).join('<br>');
        strHtml = '<i class="fa-regular fa-floppy-disk"></i> Ï≤®Î∂ÄÌååÏùº :<br>' + strHtml;
    }

    document.getElementById('mainNewsFileName').innerHTML = strHtml;

    setTimeout(function() {
        var fileNameElements = document.querySelectorAll('.news-file-name');
        fileNameElements.forEach(function(element) {
            element.addEventListener('mouseenter', function() {
                element.style.color = 'rgb(45, 126, 98)';
                element.style.fontWeight = 'bold';
            });

            element.addEventListener('mouseleave', function() {
                element.style.color = '#030303';
                element.style.fontWeight = '';
            });
        });
    }, 0);

    $("#dashNewsContent").html(news.cnKr || '');
    $('#dashNewsContent a').attr('target', '_blank');

    var dateInfo = document.querySelector('.dashNews-modal .text-sm');
    if (!edtDt) {
        dateInfo.textContent = 'Îì±Î°ùÏùº: ' + formattedNewsDt;
    } else {
        var edtyear = edtDt.substring(0, 4);
        var edtmonth = edtDt.substring(4, 6);
        var edtday = edtDt.substring(6, 8);
        var formattedEdtDt = edtyear + "." + edtmonth + "." + edtday;

        dateInfo.textContent = 'Îì±Î°ùÏùº: ' + formattedNewsDt + ' , ÏàòÏ†ïÏùº: ' + formattedEdtDt;
    }
    dateInfo.style.fontSize = '13px';
}



//Ï≤®Î∂ÄÌååÏùº
$(document).on('click', '.dash-file-name', function(event) {
    const htmlContent = event.target.innerHTML.trim();
    const fileName = htmlContent.replace(/&nbsp;/g, '').trim();
    $("#noticeFileDown").val(fileName);
    document.dashNewsFileDownForm.action = "/cmmn/noticesFileDown.do";
    document.dashNewsFileDownForm.submit();
});

// ÎåÄÏãúÎ≥¥Îìú ÎÇ¥ Í¥ÄÏÑ∏Îâ¥Ïä§ 
$(document).on('click', '.news-file-name', function (event) {
    event.preventDefault();
    const htmlContent = event.target.innerHTML.trim();
    const fileName = htmlContent.replace(/&nbsp;/g, '').trim();
    $("#mainNewsFileDown").val(fileName);
    const form = document.mainNewsFileDown;
    form.action = "/cmmn/mainNewsFileDown.do";
    form.submit();
});

function dashNewsClose(){
	$("#dashNewsPop").hide();
}



function dashExcelDownload(){
	
	fn_loading(true);
	var exCol = "";
	var exTit = "";
	var exTitDiv = "";
			//ÏàòÏ∂úÏûÖÌòÑÌô©
	exCol = "markCont|htLeft|180||cnt1|htRight|70||sum1|htRight|130||cnt2|htRight|70||sum2|htRight|130||cnt3|htRight|70||" +
			"sum3|htRight|130||cnt4|htRight|70||sum4|htRight|130||cnt5|htRight|70||sum5|htRight|130||cnt6|htRight|70||sum6|htRight|150|||" +
			"markCont|htLeft|180||cnt1|htRight|70||sum1|htRight|130||cnt2|htRight|70||sum2|htRight|130||cnt3|htRight|70||sum3|htRight|130||" +
			"cnt4|htRight|70||sum4|htRight|130||cnt5|htRight|70||sum5|htRight|130||cnt6|htRight|70||sum6|htRight|150|||supFirm|htLeft|200||" +
			"cnt1|htRight|80||sum1|htRight|150||cnt2|htRight|80||sum2|htRight|150||cnt3|htRight|80||sum3|htRight|150|||buyFirm|htLeft|200||" +
			"cnt1|htRight|80||sum1|htRight|150||cnt2|htRight|80||sum2|htRight|150||cnt3|htRight|80||sum3|htRight|150|||fodMark|htCenter|80||" +
			"title|htLeft|200||traMetCont|htLeft|160||conCod|htCenter|80||cnt|htRight|80||freKrw|htRight|120||totWt|htRight|100||" +
			"totTaxKrw|htRight|150||cal1|htRight|100||cal2|htRight|100|||fodMark|htCenter|80||title|htLeft|200||traMetCont|htLeft|160||" +
			"conCod|htCenter|80||cnt|htRight|80||insuKrw|htRight|120||totWt|htRight|100||totTaxKrw|htRight|150||cal1|htRight|100||cal2|" +
			"htRight|100|||" +
			//ÏàòÏ∂úÏûÖÌòÑÌô©
			//Îã®Í∞ÄÎ∂ÑÏÑù
			"plant|htLeft|150||invoice|htLeft|100||rptNo|htCenter|130||expLisDay|htCenter|150||totRptKrw|htRight|80||" +
			"excDivi|htCenter|80||excDiviCont|htLeft|80|||plant|htLeft|150||po|htLeft|100||blNo|htLeft|130||rptNo|htCenter|140||ranNo|htCenter|65||" +
			"sil|htCenter|65||lisDay|htCenter|95||rgCode|htCenter|130||upi|htRight|90||ut|htCenter|80||conKi|htCenter|80||supFirm|htLeft|140||" +
			"conCur|htCenter|75||upiWon|htRight|110||max|htRight|110||min|htRight|110||avg|htRight|110||maxDiff|htRight|110||minDiff|htRight|110||" +
			"avgDiff|htRight|110||maxPer|htRight|140||minPer|htRight|140||avgPer|htRight|140|||plant|htLeft|150||po|htLeft|100||blNo|htLeft|150||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||lisDay|htCenter|100||rgCode|htCenter|130||upi|htRight|150||ut|htCenter|80||" +
			"conKi|htCenter|80||supFirm|htLeft|200||conCur|htCenter|100||upiWon|htRight|130||avg|htRight|130|||plant|htLeft|200||rgCode|htLeft|150||" +
			"supFirm|htLeft|200||conCur|htCenter|100||rptCnt|htRight|80||rptSum|htRight|200|||" +
			//Îã®Í∞ÄÎ∂ÑÏÑù
			//ÏàòÏ∂úÏûÖÎç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù
			"rgCode|htCenter|120||hs|htCenter|120||stdGName1|htLeft|200||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||gsDivi|htCenter|80||gsRate|htRight|100||oriStMark1|htCenter|80||fodMark|htCenter|80||" +
			"qty|htRight|100||conAmt|htRight|100||conCur|htCenter|100||upiWon|htRight|200||gs|htRight|200|||rgCode|htCenter|120||hs|htCenter|120||" +
			"stdGName1|htLeft|200||rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||gsDivi|htCenter|80||gsRate|htRight|100||oriStMark1|htCenter|80||" +
			"fodMark|htCenter|80||qty|htRight|100||conAmt|htRight|100||conCur|htCenter|100||upiWon|htRight|200||gs|htRight|200|||supFirm|htLeft|200||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||stdName|htLeft|200||rmvRptNo|htCenter|150||rmvRanNo|htCenter|80||rmvStdName|htLeft|200||" +
			"gsDivi|htCenter|80||gsRate|htCenter|80||gs|htRight|150||vatDivi|htCenter|80||vatRate|htRight|80||vat|htRight|200||gsRmvMark|htCenter|100||" +
			"gsRmvRate|htRight|100||rmv|htRight|200||vatRmvMark|htCenter|100||vatRmvRate|htRight|100||vatRmv|htRight|200|||rgCode|htLeft|200||rptNo|htCenter|200||" +
			"ranNo|htCenter|200||sil|htCenter|200||hs|htCenter|200||taxKiDivi|htCenter|200||gxRate|htRight|200||oriStMark1|htCenter|200||fodMark|htCenter|200||lisDay|htCenter|200";
			//ÏàòÏ∂úÏûÖÎç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù
	
			//ÏàòÏ∂úÏûÖ ÌòÑÌô©
	exTit = "null|null||2020|2||2021|2||2022|2||2023|2||2024-05-29|2||Ìï©Í≥Ñ|2|||Í±∞ÎûòÍµ¨Î∂Ñ|null||ÏàòÏûÖ(Í±¥)|null||ÏàòÏûÖ(KRW)|null||ÏàòÏûÖ(Í±¥)|null||" +
			"ÏàòÏûÖ(KRW)|null||ÏàòÏûÖ(Í±¥)|null||ÏàòÏûÖ(KRW)|null||ÏàòÏûÖ(Í±¥)|null||ÏàòÏûÖ(KRW)|null||ÏàòÏûÖ(Í±¥)|null||ÏàòÏûÖ(KRW)|null||ÏàòÏûÖ(Í±¥)|null||" +
			"ÏàòÏûÖ(KRW)|null||||null|null||2020|2||2021|2||2022|2||2023|2||2024-05-29|2||Ìï©Í≥Ñ|2|||Í±∞ÎûòÍµ¨Î∂Ñ|null||ÏàòÏ∂ú(Í±¥)|null||ÏàòÏ∂ú(KRW)|null||" +
			"ÏàòÏ∂ú(Í±¥)|null||ÏàòÏ∂ú(KRW)|null||ÏàòÏ∂ú(Í±¥)|null||ÏàòÏ∂ú(KRW)|null||ÏàòÏ∂ú(Í±¥)|null||ÏàòÏ∂ú(KRW)|null||ÏàòÏ∂ú(Í±¥)|null||ÏàòÏ∂ú(KRW)|null||ÏàòÏ∂ú(Í±¥)|null||" +
			"ÏàòÏ∂ú(KRW)|null||||Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||ÏùºÎ∞òÏàòÏûÖ(Í±¥)|null||ÏàòÏûÖ(KRW)|null||Í∏∞ÌÉÄÏàòÏûÖ(Í±¥)|null||ÏàòÏûÖ(KRW)|null||ÏàòÏûÖÌï©Í≥Ñ(Í±¥)|null||ÏàòÏûÖÌï©Í≥Ñ(KRW)|null||||" +
			"Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||ÏùºÎ∞òÏàòÏ∂ú(Í±¥)|null||ÏàòÏ∂ú(KRW)|null||Í∏∞ÌÉÄÏàòÏ∂ú(Í±¥)|null||ÏàòÏ∂ú(KRW)|null||ÏàòÏ∂úÌï©Í≥Ñ(Í±¥)|null||ÏàòÏ∂úÌï©Í≥Ñ(KRW)|null||||Ï†ÅÏ∂úÍµ≠|null||" +
			"Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||Ïö¥ÏÜ°ÌòïÌÉú|null||Ïù∏ÎèÑÏ°∞Í±¥|null||Ïã†Í≥†Í±¥Ïàò|null||Ïö¥ÏûÑ|null||Ï¥ùÏ§ëÎüâ(KG)|null||Í≥ºÏÑ∏Í∞ÄÍ≤©(KRW)|null||Ïö¥ÏûÑ/Ï§ëÎüâ(KRW)|null||Ïö¥ÏûÑ/Í≥ºÏÑ∏Í∞ÄÍ≤©(%)|null||||" +
			"Ï†ÅÏ∂úÍµ≠|null||Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||Ïö¥ÏÜ°ÌòïÌÉú|null||Ïù∏ÎèÑÏ°∞Í±¥|null||Ïã†Í≥†Í±¥Ïàò|null||Î≥¥ÌóòÎ£å|null||Ï¥ùÏ§ëÎüâ(KG)|null||Í≥ºÏÑ∏Í∞ÄÍ≤©(KRW)|null||Î≥¥ÌóòÎ£å/Ï§ëÎüâ(KRW)|null||" +
			"Î≥¥ÌóòÎ£å/Í≥ºÏÑ∏Í∞ÄÍ≤©(%)|null||||PO|null||Ïù∏Î≥¥Ïù¥Ïä§Î≤àÌò∏|null||Ïã†Í≥†Î≤àÌò∏|null||ÏàòÎ¶¨ÏùºÏûê|null||Ïã†Í≥†Í∞ÄÍ≤©|null||ÏàòÏ∂úÏΩîÎìú|null||Ïô∏ÌôòÏã†Í≥†ÎåÄÏÉÅÏó¨Î∂Ä|null||||" +
			//ÏàòÏ∂úÏûÖ ÌòÑÌô©
			//Îã®Í∞ÄÎ∂ÑÏÑù
			"Í≥µÏû•ÏΩîÎìú|null||PO|null||B/L|null||Ïã†Í≥†Î≤àÌò∏|null||ÎûÄ|null||Í∑úÍ≤©|null||ÏàòÎ¶¨ÏùºÏûê|null||ÏûêÏû¨ÏΩîÎìú|null||Ïã†Í≥†Îã®Í∞Ä|null||Ïã†Í≥†Îã®ÏúÑ|null||Í≤∞Ï†úÎ∞©Î≤ï|null||Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||" +
			"Í≤∞Ï†úÌÜµÌôî|null||ÏõêÌôîÎã®Í∞Ä|null||ÏµúÍ≥†Îã®Í∞Ä|null||ÏµúÏ†ÄÎã®Í∞Ä|null||ÌèâÍ∑†Îã®Í∞Ä|null||Îã®Í∞ÄÏ∞®Ïù¥(ÏµúÍ≥†)|null||Îã®Í∞ÄÏ∞®Ïù¥(ÏµúÏ†Ä)|null||Îã®Í∞ÄÏ∞®Ïù¥(ÌèâÍ∑†)|null||Îã®Í∞ÄÏ∞®Ïù¥ ÎπÑÏú®(ÏµúÍ≥†)|null||" +
			"Îã®Í∞ÄÏ∞®Ïù¥ ÎπÑÏú®(ÏµúÏ†Ä)|null||Îã®Í∞ÄÏ∞®Ïù¥ ÎπÑÏú®(ÌèâÍ∑†)|null||||Í≥µÏû•ÏΩîÎìú|null||PO|null||B/L|null||Ïã†Í≥†Î≤àÌò∏|null||ÎûÄ|null||Í∑úÍ≤©|null||ÏàòÎ¶¨ÏùºÏûê|null||ÏûêÏû¨ÏΩîÎìú|null||" +
			"Ïã†Í≥†Îã®Í∞Ä|null||Ïã†Í≥†Îã®ÏúÑ|null||Í≤∞Ï†úÎ∞©Î≤ï|null||Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||Í≤∞Ï†úÌÜµÌôî|null||ÏõêÌôîÎã®Í∞Ä|null||ÌèâÍ∑†Îã®Í∞Ä|null||||Í≥µÏû•ÏΩîÎìú|null||ÏûêÏû¨ÏΩîÎìú|null||Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||" +
			"Í≤∞Ï†úÌÜµÌôî|null||Ïã†Í≥†Í±¥Ïàò|null||Ïã†Í≥†Í∏àÏï°(ÏõêÌôî)|null||||ÏûêÏû¨ÏΩîÎìú|null||ÏÑ∏Î≤àÎ∂ÄÌò∏|null||Í±∞ÎûòÌíàÎ™Ö|null||ÏàòÏûÖÏã†Í≥†Î≤àÌò∏|null||ÎûÄÎ≤àÌò∏|null||Í∑úÍ≤©|null||Í¥ÄÏÑ∏Íµ¨Î∂Ñ|null||Í¥ÄÏÑ∏Ïú®|null||" +
			"ÏõêÏÇ∞ÏßÄ|null||Ï†ÅÏ∂úÍµ≠|null||ÏàòÎüâ|null||Í≤∞Ï†úÍ∏àÏï°|null||Í≤∞Ï†úÌÜµÌôî|null||ÏõêÌôîÍ∏àÏï°|null||ÎÇ©Î∂ÄÍ¥ÄÏÑ∏Ïï°|null||||" +
			//Îã®Í∞ÄÎ∂ÑÏÑù
			//ÏàòÏ∂úÏûÖ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù
			"ÏûêÏû¨ÏΩîÎìú|null||ÏÑ∏Î≤àÎ∂ÄÌò∏|null||Í±∞ÎûòÌíàÎ™Ö|null||ÏàòÏûÖÏã†Í≥†Î≤àÌò∏|null||" +
			"ÎûÄÎ≤àÌò∏|null||Í∑úÍ≤©|null||Í¥ÄÏÑ∏Íµ¨Î∂Ñ|null||Í¥ÄÏÑ∏Ïú®|null||ÏõêÏÇ∞ÏßÄ|null||Ï†ÅÏ∂úÍµ≠|null||ÏàòÎüâ|null||Í≤∞Ï†úÍ∏àÏï°|null||Í≤∞Ï†úÌÜµÌôî|null||ÏõêÌôîÍ∏àÏï°|null||ÎÇ©Î∂ÄÍ¥ÄÏÑ∏Ïï°|null||||null|null||" +
			"Í¥ÄÏÑ∏Í∞êÎ©¥Ï†ÅÏö© Í±¥ Ïàò|3||Í¥ÄÏÑ∏Í∞êÎ©¥ÎØ∏Ï†ÅÏö© Í±¥ Ïàò|3||Ï¥ùÍ¥ÄÏÑ∏Ïï°|3||Ï¥ùÎ∂ÄÍ∞ÄÏÑ∏Ïï°|3||Í¥ÄÏÑ∏Í∞êÎ©¥ÏÑ∏Ïï°|3||Î∂ÄÍ∞ÄÏÑ∏Í∞êÎ©¥ÏÑ∏Ïï°|3|||Ìï¥Ïô∏Í±∞ÎûòÏ≤ò|null||ÏàòÏûÖÏã†Í≥†Î≤àÌò∏|null||ÎûÄ|null||Í±∞ÎûòÌíàÎ™Ö|null||" +
			"ÏàòÏûÖÏã†Í≥†Î≤àÌò∏|null||ÎûÄ|null||Í±∞ÎûòÌíàÎ™Ö|null||Í¥ÄÏÑ∏Íµ¨Î∂Ñ|null||Í¥ÄÏÑ∏Ïú®|null||Í¥ÄÏÑ∏Ïï°|null||Î∂ÄÍ∞ÄÏÑ∏Íµ¨Î∂Ñ|null||Î∂ÄÍ∞ÄÏÑ∏Ïú®|null||Î∂ÄÍ∞ÄÏÑ∏Ïï°|null||Í¥ÄÏÑ∏Í∞êÎ©¥Î∂ÄÌò∏|null||Í¥ÄÏÑ∏Í∞êÎ©¥Ïú®|null||" +
			"Í¥ÄÏÑ∏Í∞êÎ©¥ÏÑ∏Ïï°|null||Î∂ÄÍ∞ÄÏÑ∏Í∞êÎ©¥Î∂ÄÌò∏|null||Î∂ÄÍ∞ÄÏÑ∏Í∞êÎ©¥Ïú®|null||Î∂ÄÍ∞ÄÏÑ∏Í∞êÎ©¥ÏÑ∏Ïï°|null||||ÏûêÏû¨ÏΩîÎìú|null||ÏàòÏûÖÏã†Í≥†Î≤àÌò∏|null||ÎûÄ|null||Í∑úÍ≤©|null||HS CODE|null||ÏÑ∏Ï¢Ö|null||ÏÑ∏Ïú®|null||ÏõêÏÇ∞ÏßÄ|null||Ï†ÅÏ∂úÍµ≠|null||ÏàòÏûÖÏã†Í≥† ÏàòÎ¶¨Ïùº|null";
			//ÏàòÏ∂úÏûÖ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù
	
	exTitDiv = "1|5ÎÖÑÏπò_ÏàòÏûÖÏã§Ï†Å||2|5ÎÖÑÏπò_ÏàòÏ∂úÏã§Ï†Å||3|Ìï¥Ïô∏Í±∞ÎûòÏ≤òÎ≥Ñ_ÏàòÏûÖÏã§Ï†Å||4|Ìï¥Ïô∏Í±∞ÎûòÏ≤òÎ≥Ñ_ÏàòÏ∂úÏã§Ï†Å||5|Ïö¥ÏûÑ_ÎπÑÍµê||6|Î≥¥ÌóòÎ£å_ÎπÑÍµê||7|Ïô∏ÌôòÏã†Í≥†ÎåÄÏÉÅ_ÏàòÏ∂ú||" + //ÏàòÏ∂úÏûÖ ÌòÑÌô©
			   "8|ÏàòÏûÖÎ¨ºÌíà_Îã®Í∞ÄÎπÑÍµê||9|Ïú†Î¨¥ÏÉÅ_ÏàòÏûÖÍ±¥_Í≥ºÏÑ∏Í∞ÄÍ≤©_ÎπÑÍµê||10|ÎèôÏùºÍ±∞Îûò,_Í≤∞Ï†úÌÜµÌôî_Î≥ÄÍ≤ΩÏ†êÍ≤Ä||" +  //Îã®Í∞ÄÎ∂ÑÏÑù
			   "11|ÎèôÏùºÏûêÏû¨ÏΩîÎìú_ÌíàÎ™©Î∂ÑÎ•ò_ÏÉÅÏù¥Ï†êÍ≤Ä||12|ÎèôÏùºÏûêÏû¨ÏΩîÎìú_Í¥ÄÏÑ∏Íµ¨Î∂Ñ_ÏÉÅÏù¥Ï†êÍ≤Ä||13|Í∞êÎ©¥_Ï†ÅÏö©_ÏùºÍ¥ÄÏÑ±_Í≤ÄÌÜ†||14|FTA_ÏßÅÏ†ëÏö¥ÏÜ°ÏõêÏπô"; //ÏàòÏ∂úÏûÖ Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù
	
	var date = new Date();
	var month = date.getMonth();
	var dayday = date.getDate();
	var day = date.getDay();
	
	var startDt = new Date();
	startDt.setMonth(startDt.getMonth() - 1);
	startDt.setDate(1);
	
	var endDt = new Date();
	endDt.setMonth(endDt.getMonth(), 1);
	endDt.setDate(endDt.getDate() - 1);
	
	var today = startDt.toISOString().substring(0,10);
	var mtoday = endDt.toISOString().substring(0,10);
	
	$("#importUp_srch2").val(today);
	$("#importUp_srch3").val(mtoday);
	
	var parameters = {exCol : "", exTit: "", exTitDiv: "", exType: "", srch2: "", srch3: "", srch40: ""};
	
	
	parameters.exCol = exCol.replace(/ /g,"_");
	parameters.exTit = exTit.replace(/ /g,"_");
	parameters.exTitDiv = exTitDiv.replace(/ /g,"_");
	parameters.exType = "01";
	parameters.srch2 = today;
	parameters.srch3 = mtoday;
	parameters.srch40 = "TEST";
	
	
	$.ajax({
		 url: "/dashboard/dashDownloadExcel.do",
		 data: parameters,
		 type: 'POST',
		 cache: false,
		 timeout: 200000,
		 xhrFields: {
			 responseType: "blob",
		 },
	    success: function(blob, status, xhr) {
	    	try {
				// check for a filename
				 var fileName = "";
				 var disposition = xhr.getResponseHeader("Content-Disposition");

			       if (disposition && disposition.indexOf("attachment") !== -1) {
			      	 var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
			           var matches = filenameRegex.exec(disposition);

			           if (matches != null && matches[1]) {
			               fileName = decodeURI(matches[1].replace(/['"]/g, ""));
			           }
			       }

			       // for IE
			       if (window.navigator && window.navigator.msSaveOrOpenBlob) {
			           window.navigator.msSaveOrOpenBlob(blob, fileName);
			       } else {
			           var URL = window.URL || window.webkitURL;
			           var downloadUrl = URL.createObjectURL(blob);

			           if (fileName) {
			               var a = document.createElement("a");

			               // for safari
			               if (a.download === undefined) {
			                   window.location.href = downloadUrl;
			               } else {
			                   a.href = downloadUrl;
			                   a.download = fileName;
			                   document.body.appendChild(a);
			                   a.click();
			               }
			           } else {
			               window.location.href = downloadUrl;
			           }
			       }
		       fn_loading(false);
			} catch (e) {
				console.log(e);
				fn_loading(false);
			};
	    },
	    error: function(e, textStatus, errorThrown) {
	    	if(e.status == 400){
	    		alert("Your request is up. Please log back in if you wish continue");
	    		location.href = document.referrer;
	    	} else {
	        	console.log(errorThrown);
	    	}
	    }
	});
	
}

//
document.getElementById("reportAnalysis").addEventListener("click", function(event) {
    event.preventDefault(); // Í∏∞Î≥∏ ÎèôÏûë Î∞©ÏßÄ
    fn_loading(true);
    // FTAÍ∏∞Ï§ÄÏùº
    var url = "/rpt/reportAnalysisPdf.do"; // ÏÑúÎ≤Ñ Ï∏° Îß§ÌïëÍ≥º ÏùºÏπòÌïòÎäî URLÎ°ú ÏÑ§Ï†ï
    // Îç∞Ïù¥ÌÑ∞ Íµ¨ÏÑ±
    var sData = {};
    sData["srch8"] = $("#dashbordDate").val();
    console.log("ÎÇ†Ïßú"+$("#dashbordDate").val());
   
    $.ajax({
		 url: url,
		 data: sData,
		 type: 'GET',
		 dataType : 'json',
		 success: function(response) {
			    console.log("response", response);  
			    exportRptPdf(response); 
			    fn_loading(false);
			},
	    error: function(e, textStatus, errorThrown) {
	    	if(e.status == 400){
	    		alert("Your request is up. Please log back in if you wish continue");
	    		location.href = document.referrer;
	    	} else {
	        	console.log(errorThrown);
	    	}
	    }
	});
});



function exportRptPdf(data){

	let canvas = "";
	let rightCanvas = "";
	// let pdf2canvas = "";
	
	if (!window.jsPDF) window.jsPDF = window.jspdf.jsPDF;
        var doc = new jsPDF({
            orientation: "portrait",
            unit: "mm",
            format: "a4"
        });
        
        // ‚úÖ ÌïúÍ∏Ä Ìè∞Ìä∏ Ï∂îÍ∞Ä (malgun.ttf ÌïÑÏöî)
        doc.addFont('/pf/fonts/NanumSquare.ttf', 'NanumSquare', 'normal');
        doc.setFont('NanumSquare'); // ÏÇ¨Ïö©ÌïòÎ†§Îäî Ìè∞Ìä∏ ÏßÄÏ†ï
        

        var img = new Image();
        //img.src = '/pf/images/report_2.jpg'; //ÌååÎûÄ
        img.src = '/pf/images/green_report2.jpg'; 
        var logoImg = new Image();
        logoImg.src = '/pf/images/report_4.png';

        img.onload = function () {
        	doc.addFont('/pf/fonts/NanumSquareEB.ttf', 'NanumSquareEB', 'normal');
            console.log("Background image loaded successfully");
            doc.addImage(img, 'JPEG', 0, 0, 210, 297);
            doc.addImage(logoImg, 'PNG', 160, 10, 40, 15);

            doc.setFontSize(22);
            //doc.setTextColor(56, 60, 98); ÌååÎûÄ
            doc.setTextColor(35, 69, 56);
            //doc.text(105, 110, String(data.rptDate1) + 'ÎÖÑ ' + String(data.rptDate2) + 'Ïõî', { align: "center" }); ÌååÎûÄ
            doc.text(105, 130, String(data.rptDate1) + 'ÎÖÑ ' + String(data.rptDate2) + 'Ïõî', { align: "center" });
            doc.setFontSize(22);
            //doc.text(105, 120, 'ÌÜµÍ¥ÄÎ¶¨Ìè¨Ìä∏', { align: "center" }); ÌååÎûÄ
            doc.text(105, 140, 'ÌÜµÍ¥ÄÎ¶¨Ìè¨Ìä∏', { align: "center" }); 
            doc.setFontSize(30);
            //doc.text(105, 135, String(data.cmpnyInfo), { align: "center" }); ÌååÎûÄ
            doc.text(105, 155, String(data.cmpnyInfo), { align: "center" }); 
            doc.setFontSize(15);
            doc.text(105, 270, String(data.today), { align: "center" }); 
            doc.text(105, 280, 'Ïã†ÌïúÍ¥ÄÏÑ∏Î≤ïÏù∏', { align: "center" }); //ÌååÎûÄ
           
            // üü¢ ÏÉàÎ°úÏö¥ ÌéòÏù¥ÏßÄ Ï∂îÍ∞Ä
            doc.addPage();

            // üü¢ "ÏàòÏûÖÌÜµÍ¥ÄÌòÑÌô©" Ï†úÎ™© Ï∂îÍ∞Ä
            doc.setFontSize(16);
            doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
            doc.setFont('NanumSquareB', 'normal');
            //doc.setTextColor(62, 113, 175); //ÌååÎûÄÏÉâ
            doc.setTextColor(71, 140, 114); 
            doc.text(8, 15, "ÏàòÏûÖÌÜµÍ¥ÄÌòÑÌô©");
            
            // Ï†úÎ™© + ÏÑ§Î™ÖÏùÑ ÎÑ£ÏùÑ ÏòÅÏó≠ÏùÑ ÎÑ§Î™®Î∞ïÏä§Î°ú Í∑∏Î¶¨Í∏∞
            const boxMargin = 5;  // ÌÖåÎëêÎ¶¨ÏôÄÏùò Ïó¨Î∞±
            const boxWidth = 200;  // Î∞ïÏä§Ïùò ÎÑàÎπÑ
            const boxHeight = 23;  // Î∞ïÏä§Ïùò ÎÜíÏù¥ (ÏÑ§Î™Ö Ìè¨Ìï®)
            
            doc.setLineWidth(0.5);  // ÌÖåÎëêÎ¶¨ ÎëêÍªò ÏÑ§Ï†ï (Í∏∞Î≥∏Í∞íÏùÄ 0.2)
            doc.setDrawColor(35, 69,56); 
            doc.rect(5, 8, boxWidth, boxHeight, 'D'); 
            
            
            const reportData1 = data.reportData1;  // data.reportData1Ïù¥ Ï†úÍ≥µÎêúÎã§Í≥† Í∞ÄÏ†ï

	            // Îç∞Ïù¥ÌÑ∞ Î≥ÄÌôò: Í≥ºÏÑ∏Í∞ÄÍ≤©ÏùÑ Ìè¨Îß§ÌåÖÎêú Í∞íÍ≥º ÏõêÎ≥∏ Í∞íÏúºÎ°ú Íµ¨Î∂ÑÌïòÏó¨ Ï†ÄÏû•
	            const datas = reportData1.map(item => {
	              const amountKrw = parseFloat(item.amountKrw) || 0;  // ÏõêÎ≥∏ Í∞í
	              const formattedAmountKrw = Intl.NumberFormat("ko-KR").format(amountKrw);  // Ìè¨Îß§ÌåÖÎêú Í∞í
	              
	              return [
	                item.lisDay,        // ÏàòÎ¶¨ÏùºÏûê
	                item.cnt,           // Í±¥Ïàò
	                formattedAmountKrw, // Í≥ºÏÑ∏Í∞ÄÍ≤© (Ìè¨Îß§ÌåÖÎêú Í∞í)
	                item.txType1,       // ÏùºÎ∞òÏàòÏûÖ
	                item.txType2,       // ÏàòÎ¶¨Î¨ºÌíà
	                item.txType3,       // Í≤¨Ìíà Î∞è Í¥ëÍ≥†Ïö©Ìíà
	                item.txType4,       // Í∏∞ÌÉÄ ÏàòÏûÖ ÏäπÏù∏Î©¥ÏÑ∏
	                item.txType5,       // Ïû¨ÏàòÏ∂úÏ°∞Í±¥
	                item.txPrc1,        // P/L
	                item.txPrc2,        // Ï†úÏ∂úÏÑúÎ•ò
	                item.txPrc3,        // Í≤ÄÏÇ¨
	              ];
	            });
		        // üü¢ Ïó¥Î≥Ñ Ìï©Í≥Ñ Í≥ÑÏÇ∞
		         const columnCount = datas[0].length;  // Ïó¥ Í∞úÏàò
		         const totals = Array(columnCount).fill(0);  // 0ÏúºÎ°ú Ï±ÑÏö¥ Ìï©Í≥Ñ Î∞∞Ïó¥

		         // Ìï©Í≥Ñ Í≥ÑÏÇ∞ (Ï≤´ Î≤àÏß∏ Ïó¥ÏùÄ "Ìï©Í≥Ñ" Î¨∏ÏûêÏó¥ÏùÑ ÎÑ£Í≥†, ÎÇòÎ®∏ÏßÄÎäî Ïà´Ïûê Ìï©ÏÇ∞)
		         totals[0] = "Ìï©Í≥Ñ"; 
		         for (let i = 1; i < columnCount; i++) {
		        	  // Í≥ºÏÑ∏Í∞ÄÍ≤©(3Î≤àÏß∏ Ïó¥)ÏùÑ Ï†úÏô∏Ìïú Í∞íÎì§Îßå Ìï©ÏÇ∞
		        	  if (i === 2) {
		        	    totals[i] = datas.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0); // ÏõêÎ≥∏ Í∞íÏúºÎ°ú Ìï©Í≥Ñ Í≥ÑÏÇ∞
		        	  } else {
		        	    totals[i] = datas.reduce((sum, row) => sum + (parseFloat(row[i]) || 0), 0);
		        	  }
		        	}

		         // üü¢ ÎπÑÏú® Í≥ÑÏÇ∞ (Í∞Å Í∑∏Î£πÏùÑ 100%Î°ú ÏÑ§Ï†ï)
		         const percentages = Array(columnCount).fill("-");
		         percentages[0] = "ÎπÑÏú®(%)"; // Ï≤´ Î≤àÏß∏ Ïó¥ÏùÄ "ÎπÑÏú®(%)"

		         // üü¢ ÏàòÏûÖ Í±∞ÎûòÌòïÌÉú ÎπÑÏú® Í≥ÑÏÇ∞
		         const tradeTotal = totals.slice(3, 8).reduce((sum, value) => sum + value, 0); // 3~7Î≤àÏß∏ Ïó¥ Ìï©Í≥Ñ
		         for (let i = 3; i < 8; i++) {
		             percentages[i] = tradeTotal > 0 ? ((totals[i] / tradeTotal) * 100).toFixed(1) + "%" : "-";
		         }

		         // üü¢ ÏàòÏûÖÏã†Í≥† Ï≤òÎ¶¨ÌòÑÌô© ÎπÑÏú® Í≥ÑÏÇ∞
		         const processTotal = totals.slice(8, 11).reduce((sum, value) => sum + value, 0); // 8~10Î≤àÏß∏ Ïó¥ Ìï©Í≥Ñ
		         for (let i = 8; i < 11; i++) {
		             percentages[i] = processTotal > 0 ? ((totals[i] / processTotal) * 100).toFixed(1) + "%" : "-";
		         }

		         
		     	 // üü¢ Ïà´Ïûê Îç∞Ïù¥ÌÑ∞ Ìè¨Îß∑ÌåÖ (Ï≤ú Îã®ÏúÑ ÏΩ§Îßà Ï∂îÍ∞Ä)
		         const formattedTotals = totals.map((value, index) =>
		         typeof value === "number" ? Intl.NumberFormat("ko-KR").format(value) : value
		      	);
		         
		     	// üü¢ Í±¥Ïàò, P/L, Ï†úÏ∂úÏÑúÎ•ò, Í≤ÄÏÇ¨ Í∞ÄÏ†∏Ïò§Í∏∞
		         const countTotal = formattedTotals[1]; // ÌÜµÍ¥ÄÍ±¥Ïàò
		         const plTotal = formattedTotals[8]; // P/L Ìï©Í≥Ñ
		         const plPercentage = percentages[8]; // P/L ÎπÑÏú®
		         const submissionTotal = formattedTotals[9]; // Ï†úÏ∂úÏÑúÎ•ò Ìï©Í≥Ñ
		         const submissionPercentage = percentages[9]; // Ï†úÏ∂úÏÑúÎ•ò ÎπÑÏú®
		         const inspectionTotal = formattedTotals[10]; // Í≤ÄÏÇ¨ Ìï©Í≥Ñ
		         const inspectionPercentage = percentages[10]; // Í≤ÄÏÇ¨ ÎπÑÏú®
		            
		            
		            // üü¢ ÏÑ§Î™Ö Ï∂îÍ∞Ä (ÏôºÏ™Ω Ï†ïÎ†¨ + Ï§Ñ ÎÇòÎàÑÍ∏∞)
		            doc.setFontSize(9);
		            doc.addFont('/pf/fonts/NanumSquareR.ttf', 'NanumSquareR', 'normal');
		            doc.setFont('NanumSquareR', 'normal');
		            doc.setTextColor(0, 0, 0);
		            const description = [
		            	`Îã§Ïùå ÏûêÎ£åÎäî ${data.rptDate2}Ïõî ÌïúÎã¨ ÏàòÏûÖÌÜµÍ¥Ä ÏûêÎ£åÏù¥Î©∞ Ï¥ù ${countTotal}Í±¥ ÏàòÏûÖÏã†Í≥†Î•º ÏßÑÌñâÌïòÏòÄÏäµÎãàÎã§.`,
		                `ÏàòÏûÖÏã†Í≥† Ï≤òÎ¶¨ÌòÑÌô©ÏùÄ P/L ${plTotal}Í±¥ (${plPercentage}), Ï†úÏ∂ú ${submissionTotal}Í±¥ (${submissionPercentage}), Í≤ÄÏÇ¨ ${inspectionTotal}Í±¥ (${inspectionPercentage}) ÏûÖÎãàÎã§.`
		            ];
		          
		            let startY = 23; // description ÎÜíÏù¥ ÏúÑÏπò
		            description.forEach((line, index) => {
		            	  doc.text(8, startY, line); // ÏôºÏ™Ω Ï†ïÎ†¨ (x: 8, y: startY)
		            	  startY += 5; // Í∞Å Ï§Ñ Í∞ÑÍ≤©ÏùÑ 5Î°ú ÏÑ§Ï†ïÌïòÏó¨ Îã§Ïùå Ï§ÑÎ°ú ÎÇ¥Î†§Í∞ê
		        	});
		         
		      // üü¢ datasÏóê Ìï©Í≥ÑÏôÄ ÎπÑÏú® Ìñâ Ï∂îÍ∞Ä
		         datas.push(formattedTotals);
		         datas.push(percentages);
		         
            	// ÌÖåÏù¥Î∏î Ìó§Îçî
		       const header = [
		    	   	[ 
		    		    { content: 'ÏàòÎ¶¨ÏùºÏûê', rowSpan: 2, border: [true, true, true, true] },  // ÏàòÎ¶¨ÏùºÏûê ÏÖÄÏóê ÌÖåÎëêÎ¶¨ Ï∂îÍ∞Ä
		    		    { content: 'Í±¥Ïàò', rowSpan: 2, border: [true, true, true, true] },
		    		    { content: 'Í≥ºÏÑ∏Í∞ÄÍ≤©', rowSpan: 2, border: [true, true, true, true] },
		    		    { content: 'ÏàòÏûÖ Í±∞ÎûòÌòïÌÉú ÌòÑÌô©', colSpan: 5, border: [true, true, true, true] },  // ÏàòÏûÖ Í±∞ÎûòÌòïÌÉú ÌòÑÌô© ÏÖÄÏóê ÌÖåÎëêÎ¶¨ Ï∂îÍ∞Ä
		    		    { content: 'ÏàòÏûÖÏã†Í≥† Ï≤òÎ¶¨ÌòÑÌô©', colSpan: 3, border: [true, true, true, true] },  // ÏàòÏûÖÏã†Í≥† Ï≤òÎ¶¨ÌòÑÌô© ÏÖÄÏóê ÌÖåÎëêÎ¶¨ Ï∂îÍ∞Ä
		    		  ],  // Ï≤´ Î≤àÏß∏ Ìñâ
		    		  [
		    		    { content: 'ÏùºÎ∞òÏàòÏûÖ', border: [true, true, true, true] },
		    		    { content: 'ÏàòÎ¶¨Î¨ºÌíà', border: [true, true, true, true] },
		    		    { content: 'Í≤¨Ìíà Î∞è Í¥ëÍ≥†Ïö©Ìíà', border: [true, true, true, true] },
		    		    { content: 'Í∏∞ÌÉÄ ÏàòÏûÖ ÏäπÏù∏Î©¥ÏÑ∏', border: [true, true, true, true] },
		    		    { content: 'Ïû¨ÏàòÏ∂úÏ°∞Í±¥', border: [true, true, true, true] },
		    		    { content: 'P/L', border: [true, true, true, true] },
		    		    { content: 'Ï†úÏ∂úÏÑúÎ•ò', border: [true, true, true, true] },
		    		    { content: 'Í≤ÄÏÇ¨', border: [true, true, true, true] },
		    		  ]
		    	 ];
		       
		       
            	// üü¢ ÌÖåÏù¥Î∏î Ïä§ÌÉÄÏùº Ï†ÅÏö©
            	doc.autoTable({
            	  head: header,
            	  body:datas,
            	  startY: startY + 5, // ÏÑ§Î™Ö ÏïÑÎûòÏóê ÌÖåÏù¥Î∏î Î∞∞Ïπò
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ÏÖÄ Ìå®Îî©ÏùÑ Ï§ÑÏó¨ÏÑú Ìñâ ÎÜíÏù¥ Ï§ÑÏù¥Í∏∞
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    halign: 'center',
            	    overflow: 'linebreak', // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøà Ï†ÅÏö©
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // Ìó§Îçî Î∞∞Í≤Ω (ÌååÎûÄ)
            		fillColor: [35, 69, 56], // Ìó§Îçî Î∞∞Í≤Ω (Ï¥àÎ°ù)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // Ìó§Îçî ÎÜíÏù¥Î•º Ï§ÑÏù¥Í∏∞ ÏúÑÌï¥ Ìå®Îî©ÏùÑ Ï†ÅÍ≤å ÏÑ§Ï†ï
            	    lineWidth: 0.2, // ÌÖåÎëêÎ¶¨ ÎëêÍªò
            	    border: [true, true, true, true],  // Ìó§ÎçîÏóê ÌÖåÎëêÎ¶¨ Ï∂îÍ∞Ä
            	  },
            	  tableWidth: 'auto', // PDF ÌÅ¨Í∏∞Ïóê ÎßûÍ≤å ÏûêÎèô Ï°∞Ï†ï
            	  margin: { left: 5, right: 5 }, // Ï¢åÏö∞ Í≥µÎ∞± Ï∂îÍ∞Ä
            	  columnStyles: {
            		  	0: { halign: 'center' , cellWidth: 23 }, // ÏàòÎ¶¨ÏùºÏûê
            	        1: { halign: 'center' , cellWidth: 18}, // Í±¥Ïàò
            	        2: { halign: 'center' , cellWidth: 23}, // Í≥ºÏÑ∏Í∞ÄÍ≤©
            	        3: { halign: 'center' , cellWidth: 17}, // ÏùºÎ∞òÏàòÏûÖ
            	        4: { halign: 'center' , cellWidth: 17}, // ÏàòÎ¶¨Î¨ºÌíà
            	        5: { halign: 'center' , cellWidth: 17}, // Í≤¨Ìíà Î∞è Í¥ëÍ≥†Ïö©Ìíà
            	        6: { halign: 'center' , cellWidth: 17}, // Í∏∞ÌÉÄ ÏàòÏûÖ ÏäπÏù∏Î©¥ÏÑ∏
            	        7: { halign: 'center' , cellWidth: 17}, // Ïû¨ÏàòÏ∂úÏ°∞Í±¥
            	        8: { halign: 'center' , cellWidth: 17 }, // P/L
            	        9: { halign: 'center' , cellWidth: 17}, // Ï†úÏ∂úÏÑúÎ•ò
            	        10: { halign: 'center' , cellWidth: 17}, // Í≤ÄÏÇ¨
            	  },
        		});
            	
            	//ÌîåÎü¨Í∑∏Ïù∏ Îì±Î°ù
            	Chart.register(ChartDataLabels);
            	
            	// Í±∞ÎûòÌòïÌÉú 
            	// Îç∞Ïù¥ÌÑ∞ Î≥ÄÌôò (NaN Î∞©ÏßÄ)
            	const safeParse = (value) => {
            	    let num = parseFloat(value ? value.replace('%', '') : 0);
            	    return isNaN(num) ? 0 : num;
            	};

            	// ÏôºÏ™Ω Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ Î≥ÄÌôò
            	const leftChartData = percentages.slice(3, 8).map(safeParse);
            	
            	// ÏôºÏ™Ω Ï∞®Ìä∏ Ï∫îÎ≤ÑÏä§ ÏÉùÏÑ±
            	canvas = document.createElement('canvas');
            	const ctx = canvas.getContext('2d');
            	canvas.width = 400;
            	canvas.height = 400;

            	// ÏôºÏ™Ω Ï∞®Ìä∏ ÏÉùÏÑ±
            	const chart = new Chart(ctx, {
            	    type: 'pie',
            	    data: {
            	        labels: ['ÏùºÎ∞òÏàòÏûÖ', 'ÏàòÎ¶¨Î¨ºÌíà', 'Í≤¨Ìíà,Í¥ëÍ≥†Ïö©Ìíà', 'Í∏∞ÌÉÄÏàòÏûÖ', 'Ïû¨ÏàòÏ∂ú'],
            	        datasets: [{
            	            data: leftChartData,
            	            backgroundColor: [  'rgb(113,162, 218)',
				            	            	'rgb(48,123,202)', 
				            	            	'rgb(166,196,232)',
				            	            	'rgb(216,225,234)',
				            	            	'rgb(40,101,168)']
	            	        }]
			            	/* backgroundColor: [  
			            		'rgb(71,140,114)',
			            		'rgb(49,97,79)', 
			 	            	'rgb(84,166, 135)', 
			 	            	'rgb(186,221,139)',
			 	            	'rgb(231,244,218)']
            	    		}]*///Í∑∏Î¶∞
		            	
            	    },
            	    options: {
            	        responsive: false,
            	        maintainAspectRatio: false,  // ÎπÑÏú® Ïú†ÏßÄ Ìï¥Ï†ú
            	        layout: {
            	            padding: {
            	                bottom: 20 // Ï∞®Ìä∏ ÌïòÎã® Ïó¨Î∞± (ÎùºÎ≤® Í≥µÍ∞Ñ ÌôïÎ≥¥)
            	            }
            	        },
            	        plugins: {
            	        	// Îç∞Ïù¥ÌÑ∞ ÎùºÎ≤® ÌîåÎü¨Í∑∏Ïù∏ ÏÑ§Ï†ï 
            	        	datalabels: {
             	                color: 'rgb(89,89,89)',
             	                formatter: function(value, context) {
             	                	let label = context.chart.data.labels[context.dataIndex];
             	                	 // ÏùºÏ†ï Í∞í Ïù¥ÌïòÏù∏ Í≤ΩÏö∞ ÎùºÎ≤®ÏùÑ ÌëúÏãúÌïòÏßÄ ÏïäÎèÑÎ°ù ÏÑ§Ï†ï (Ïòà: 5% ÎØ∏ÎßåÏùÄ Ï†úÏô∏)
             	                   if (value < 10) {  // Í∞íÏù¥ 5% ÎØ∏ÎßåÏù∏ Í≤ΩÏö∞ ÎùºÎ≤®ÏùÑ ÌëúÏãúÌïòÏßÄ ÏïäÏùå
             	                       return null;  // Îπà Í∞íÏùÑ Î∞òÌôòÌïòÍ±∞ÎÇò nullÎ°ú ÏÑ§Ï†ïÌïòÏó¨ ÎùºÎ≤®ÏùÑ Ïà®ÍπÄ
             	                   }
             	                	let percentage = value;
             	                    return label + " : " +percentage + "%"; // ÎùºÎ≤®Í≥º ÌçºÏÑºÌä∏ ÌëúÏãú
             	                },
             	                font: {
             	                    size: 25,
             	                },
             	           
             	            },
            	            legend: {
            	                position: 'bottom',
            	                fullWidth: true,
            	                labels: {
            	                    font: {
            	                        size: 18  // ÎùºÎ≤® ÌÅ¨Í∏∞ ÎèôÏùº
            	                        ,weight: 'bold'
            	                    },
            	                    boxWidth: 15,  // ÏïÑÏù¥ÏΩò ÌÅ¨Í∏∞ ÎèôÏùº
            	                    padding: 15
            	                }
            	            },
            	            title: {
            	                display: true,
            	                text: 'Í±∞ÎûòÌòïÌÉú',
            	                font: {
            	                    size: 25,  // Ï†úÎ™© ÌÅ¨Í∏∞ ÎèôÏùº
            	                    weight: 'bold'},
            	                padding: {
            	                    bottom: 10
            	                }
            	            }
            	        }
            	    }
            	});
            	
            	
            	// Ïò§Î•∏Ï™Ω Ï∞®Ìä∏ (ÏàòÏûÖÏã†Í≥† Ï≤òÎ¶¨ÌòÑÌô© ÎπÑÏú®)
            	const rightChartData = [
            	    parseFloat(percentages[8].replace('%', '')) || 0, 
            	    parseFloat(percentages[9].replace('%', '')) || 0, 
            	    parseFloat(percentages[10].replace('%', '')) || 0 
            	];
            	
            	
            	// Ïò§Î•∏Ï™Ω Ï∞®Ìä∏ Ï∫îÎ≤ÑÏä§ ÏÉùÏÑ±
            	rightCanvas = document.createElement('canvas');
            	const rightCtx = rightCanvas.getContext('2d');
            	rightCanvas.width = 400;
            	rightCanvas.height = 400;

            	// Ïò§Î•∏Ï™Ω Ï∞®Ìä∏ ÏÉùÏÑ±
            	const rightChart = new Chart(rightCtx, {
            	    type: 'pie',
            	    data: {
            	        labels: ['P/L', 'Ï†úÏ∂úÏÑúÎ•ò', 'Í≤ÄÏÇ¨'],
            	        datasets: [{
            	            data: rightChartData,
            	            backgroundColor: [  'rgb(48,123,202)', 				            	             
				            	            	'rgb(113,162, 218)', 
				            	            	'rgb(166,196,232)']
            	        }]
            	            /*backgroundColor: [  
            	            	'rgb(49,97,79)', 
			 	            	'rgb(84,166, 135)', 
			 	            	'rgb(186,221,139)']
        	        		}]*/ //Í∑∏Î¶∞
            	    },
            	    options: {
            	        responsive: false,
            	        //maintainAspectRatio: false,  // ÎπÑÏú® Ïú†ÏßÄ Ìï¥Ï†ú
            	        layout: {
            	            /*padding: {
            	            	top: 20,  // ÏúÑÏ™Ω Ïó¨Î∞± Ï∂îÍ∞Ä
            	                bottom: 10, // ÏïÑÎûòÏ™Ω Ïó¨Î∞± Ï∂îÍ∞Ä
            	                left: 30,  // ÏôºÏ™Ω Ïó¨Î∞± Ï∂îÍ∞Ä
            	                right: 30  // Ïò§Î•∏Ï™Ω Ïó¨Î∞± Ï∂îÍ∞Ä
            	            }*/
            	        },
            	        plugins: {
            	        	datalabels: {
             	                color: 'rgb(89,89,89)',
             	                formatter: function(value, context) {
             	                	let label = context.chart.data.labels[context.dataIndex];
             	                   if (value < 10) {  // Í∞íÏù¥ 10% ÎØ∏ÎßåÏù∏ Í≤ΩÏö∞ ÎùºÎ≤®ÏùÑ ÌëúÏãúÌïòÏßÄ ÏïäÏùå
             	                       return null;  
             	                   }
             	                    return label + " : " +value + "%"; // ÎùºÎ≤®Í≥º ÌçºÏÑºÌä∏ ÌëúÏãú
             	                },
             	                font: {
             	                    size: 20,
             	                    weight : 'bold'
             	                },
             	               align: 'end', // Î∞îÍπ•Ï™ΩÏúºÎ°ú ÏúÑÏπò
             	               anchor: 'end', // Ïõê Î∞ñÏúºÎ°ú Ïù¥Îèô
           	            },  
            	        	legend: {
            	                position: 'bottom',
            	                fullWidth: true,
            	                labels: {
            	                    font: {
            	                        size: 18  // ÎùºÎ≤® ÌÅ¨Í∏∞ ÎèôÏùº
            	                    },
            	                    boxWidth: 15,  // ÏïÑÏù¥ÏΩò ÌÅ¨Í∏∞ ÎèôÏùº
            	                    padding: 30
            	                }
            	            },
            	            title: {
            	                display: true,
            	                text: 'Ïã†Í≥†Ï≤òÎ¶¨',
            	                font: {
            	                    size: 25,  // Ï†úÎ™© ÌÅ¨Í∏∞ ÎèôÏùº
            	                    weight: 'bold'
            	                },
            	                padding: {
            	                    bottom: 30
            	                }
            	            }
            	        }
            	    }
            	});
            	
            	// üü¢ ÏÉàÎ°úÏö¥ ÌéòÏù¥ÏßÄ Ï∂îÍ∞Ä
                doc.addPage();
                // üü¢ "ÏàòÏûÖÌÜµÍ¥Ä ÏÑ∏Ïï°ÌòÑÌô©" Ï†úÎ™© Ï∂îÍ∞Ä
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //ÌååÎûÄÏÉâ
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "ÏàòÏûÖÌÜµÍ¥Ä ÏÑ∏Ïï°ÌòÑÌô©");
                
                // Ï†úÎ™© + ÏÑ§Î™ÖÏùÑ ÎÑ£ÏùÑ ÏòÅÏó≠ÏùÑ ÎÑ§Î™®Î∞ïÏä§Î°ú Í∑∏Î¶¨Í∏∞
                const boxMargin2 = 5;  // ÌÖåÎëêÎ¶¨ÏôÄÏùò Ïó¨Î∞±
                const boxWidth2 = 200;  // Î∞ïÏä§Ïùò ÎÑàÎπÑ
                const boxHeight2 = 18;  // Î∞ïÏä§Ïùò ÎÜíÏù¥ (ÏÑ§Î™Ö Ìè¨Ìï®)
                
                doc.setLineWidth(0.5);  // ÌÖåÎëêÎ¶¨ ÎëêÍªò ÏÑ§Ï†ï (Í∏∞Î≥∏Í∞íÏùÄ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth2, boxHeight2, 'D'); 
	            
                const reportData2 = data.reportData2;
                console.log("reportData2",reportData2);
                const datas2 = reportData2.map(item => {
  	              const formattedCntImp = Intl.NumberFormat("ko-KR").format(item.cntImp);
  	              const formattedTotGs = Intl.NumberFormat("ko-KR").format(item.totGs);
  	              const formattedTotVat= Intl.NumberFormat("ko-KR").format(item.totVat);
  	              const formattedTotTs = Intl.NumberFormat("ko-KR").format(item.totTs);  
  	              const formattedTotGt = Intl.NumberFormat("ko-KR").format(item.totGt); 
  	              const formattedTotHof = Intl.NumberFormat("ko-KR").format(item.totHof); 
  	              const formattedTotKy = Intl.NumberFormat("ko-KR").format(item.totKy); 
  	              const formattedTotNt = Intl.NumberFormat("ko-KR").format(item.totNt); 
  	              const formattedTotDlyTax = Intl.NumberFormat("ko-KR").format(item.totDlyTax); 
  	              const formattedTotAddTax = Intl.NumberFormat("ko-KR").format(item.totAddTax); 
  	              const formattedTotTaxSum = Intl.NumberFormat("ko-KR").format(item.totTaxSum); 
  	              
  	              return [
  	                item.lisDay,        		// ÏàòÎ¶¨ÏùºÏûê
  	                formattedCntImp,			// Í±¥Ïàò
  	                formattedTotGs, 			//Í¥ÄÏÑ∏
  	                formattedTotVat,      	 	// Î∂ÄÍ∞ÄÏÑ∏
  	                formattedTotTs,       		// ÌäπÏÜåÏÑ∏
  	                formattedTotGt,       		// ÍµêÌÜµÏÑ∏
  	                formattedTotHof,       	// Ï£ºÏÉà
  	                formattedTotKy,       		// ÍµêÏú°ÏÑ∏
  	                formattedTotNt,        	// ÎÜçÌäπÏÑ∏
  	                formattedTotDlyTax,        	// Ïã†Í≥†ÏßÄÏó∞Í∞ÄÏÇ∞ÏÑ∏
  	                formattedTotAddTax,        // ÎØ∏Ïã†Í≥†Í∞ÄÏÇ∞ÏÑ∏
  	                formattedTotTaxSum,        // Ï¥ùÏÑ∏Ïï°
  	              ];
  	            });
                
                // üü¢ Ïó¥Î≥Ñ Ìï©Í≥Ñ Í≥ÑÏÇ∞
		         const columnCount2 = datas2[0].length;  // Ïó¥ Í∞úÏàò
		         const totals2 = Array(columnCount2).fill(0);  // 0ÏúºÎ°ú Ï±ÑÏö¥ Ìï©Í≥Ñ Î∞∞Ïó¥

		         // Ìï©Í≥Ñ Í≥ÑÏÇ∞ (Ï≤´ Î≤àÏß∏ Ïó¥ÏùÄ "Ìï©Í≥Ñ" Î¨∏ÏûêÏó¥ÏùÑ ÎÑ£Í≥†, ÎÇòÎ®∏ÏßÄÎäî Ïà´Ïûê Ìï©ÏÇ∞)
		         totals2[0] = "Ìï©Í≥Ñ"; 
		         for (let i = 1; i < columnCount2; i++) {
		        	    // ÏâºÌëú(,)Î•º Ï†úÍ±∞Ìïú ÌõÑ Ïà´ÏûêÎ°ú Î≥ÄÌôòÌïòÏó¨ Ìï©ÏÇ∞
		        	    totals2[i] = datas2.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0);

		        	    // Ìï©Í≥ÑÎ•º Îã§Ïãú ÌïúÍµ≠Ïñ¥ Ïà´Ïûê Ìè¨Îß∑(ko-KR)ÏúºÎ°ú Î≥ÄÌôò
		        	    totals2[i] = Intl.NumberFormat("ko-KR").format(totals2[i]);
		         }
		         
		         
		         // Í¥ÄÏÑ∏ Î∂ÄÍ∞ÄÏÑ∏ ÏÑ∏Ïï°Ìï©Í≥Ñ 
		         var gsTot = totals2[2]; //Í¥ÄÏÑ∏
		         var vatTot = totals2[3]; //Î∂ÄÍ≥ºÏÑ∏
		         var taxSumTot = totals2[11]; //Ï¥ùÏÑ∏Ïï°
		         
  		        
                // üü¢ ÏÑ§Î™Ö Ï∂îÍ∞Ä (ÏôºÏ™Ω Ï†ïÎ†¨ + Ï§Ñ ÎÇòÎàÑÍ∏∞)
	            doc.setFontSize(9);
	            doc.addFont('/pf/fonts/NanumSquareR.ttf', 'NanumSquareR', 'normal');
	            doc.setFont('NanumSquareR', 'normal');
	            doc.setTextColor(0, 0, 0);
	            const description2 = [
	            	` ${data.rptDate2}Ïõî ÌÜµÍ¥Ä Í¥ÄÏÑ∏Îäî${gsTot}Ïõê, Î∂ÄÍ∞ÄÏÑ∏Îäî ${vatTot}Ïõê Ïù¥Î©∞ Ï¥ùÏÑ∏Ïï°Ìï©Í≥ÑÎäî${taxSumTot}ÏõêÏûÖÎãàÎã§.`
	            ];
	          
	             startY = 23; // description ÎÜíÏù¥ ÏúÑÏπò
	            description2.forEach((line, index) => {
	            	  doc.text(8, startY, line); // ÏôºÏ™Ω Ï†ïÎ†¨ (x: 8, y: startY)
	            	  startY += 5; // Í∞Å Ï§Ñ Í∞ÑÍ≤©ÏùÑ 5Î°ú ÏÑ§Ï†ïÌïòÏó¨ Îã§Ïùå Ï§ÑÎ°ú ÎÇ¥Î†§Í∞ê
	        	});
	        	// ÌÖåÏù¥Î∏î Ìó§Îçî
			      var header2 = [[
			    	    'ÏàòÎ¶¨ÏùºÏûê', 'Í±¥Ïàò', 'Í¥ÄÏÑ∏','Î∂ÄÍ∞ÄÏÑ∏' ,'ÌäπÏÜåÏÑ∏', 'ÍµêÌÜµÏÑ∏', 
			    	    'Ï£ºÏÑ∏', 'ÍµêÏú°ÏÑ∏', 'ÎÜçÌäπÏÑ∏', 'Ïã†Í≥†ÏßÄÏó∞Í∞ÄÏÇ∞ÏÑ∏', 'ÎØ∏Ïã†Í≥†Í∞ÄÏÇ∞ÏÑ∏', 'Ï¥ùÏÑ∏Ïï°'
			    	]];
			        
			   //üü¢ datasÏóê Ìï©Í≥ÑÏôÄ ÎπÑÏú® Ìñâ Ï∂îÍ∞Ä
			   datas2.push(totals2);
			        
			     // üü¢ ÌÖåÏù¥Î∏î Ïä§ÌÉÄÏùº Ï†ÅÏö©
	            	doc.autoTable({
	            	  head: header2,
	            	  body:datas2,
	            	  startY: startY + 2, // ÏÑ§Î™Ö ÏïÑÎûòÏóê ÌÖåÏù¥Î∏î Î∞∞Ïπò
	            	  theme: 'grid',
	            	  styles: {
	            	    font: 'NanumSquareR',
	            	    fontSize: 7,
	            	    cellPadding: 2,   // ÏÖÄ Ìå®Îî©ÏùÑ Ï§ÑÏó¨ÏÑú Ìñâ ÎÜíÏù¥ Ï§ÑÏù¥Í∏∞
	            	    textColor: [0, 0, 0],
	            	    valign: 'middle',
	            	    overflow: 'hidden', // ÌÖçÏä§Ìä∏ Ï§ÑÎ∞îÍøàÏùÑ Î∞©ÏßÄÌïòÍ≥† ÎÑòÏπòÏßÄ ÏïäÍ≤å ÏÑ§Ï†ï
	                    wordWrap: 'normal', // Ï§ÑÎ∞îÍøà Î∞©ÏßÄ (Ìïú Ï§ÑÎ°úÎßå Î≥¥Ïù¥Í≤å)
	            	  },
	            	  headStyles: {
	            		//fillColor: [36, 83, 118], // Ìó§Îçî Î∞∞Í≤Ω (ÌååÎûÄ)
	            		fillColor: [35, 69, 56], // Ìó§Îçî Î∞∞Í≤Ω (Ï¥àÎ°ù)
	            	    fontSize: 8,
	            	    textColor: [255, 255, 255],
	            	    font: 'NanumSquareEB',
	            	    fontStyle: 'bold',
	            	    cellPadding: 2, // Ìó§Îçî ÎÜíÏù¥Î•º Ï§ÑÏù¥Í∏∞ ÏúÑÌï¥ Ìå®Îî©ÏùÑ Ï†ÅÍ≤å ÏÑ§Ï†ï
	            	    lineWidth: 0.2, // ÌÖåÎëêÎ¶¨ ÎëêÍªò
	            	    border: [true, true, true, true],  // Ìó§ÎçîÏóê ÌÖåÎëêÎ¶¨ Ï∂îÍ∞Ä
	            	    overflow: 'linebreak', // Ìó§ÎçîÏùò ÌÖçÏä§Ìä∏Í∞Ä Îëê Ï§ÑÎ°ú ÎÑòÏñ¥Í∞ÄÎèÑÎ°ù ÏÑ§Ï†ï
	                    wordWrap: 'break-word', // ÌÖçÏä§Ìä∏Í∞Ä ÏÖÄ ÎÑàÎπÑÎ•º ÎÑòÏñ¥ÏÑúÎ©¥ Ï§ÑÎ∞îÍøà ÎêòÎèÑÎ°ù ÏÑ§Ï†ï
	                    halign: 'center', // ÌÖçÏä§Ìä∏ Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨
	            	  },
	            	  tableWidth: 'auto', // PDF ÌÅ¨Í∏∞Ïóê ÎßûÍ≤å ÏûêÎèô Ï°∞Ï†ï
	            	  margin: { left: 5, right: 5 }, // Ï¢åÏö∞ Í≥µÎ∞± Ï∂îÍ∞Ä
	            	  columnStyles: {
	            		  	0: { halign: 'center'}, // ÏàòÎ¶¨ÏùºÏûê
	            	        1: { halign: 'center'}, // Í±¥Ïàò
	            	        2: { halign: 'right'}, // Í¥ÄÏÑ∏
	            	        3: { halign: 'right'}, // Î∂ÄÍ∞ÄÏÑ∏
	            	        4: { halign: 'right'}, // ÌäπÏÜåÏÑ∏
	            	        5: { halign: 'right'}, // ÍµêÌÜµÏÑ∏
	            	        6: { halign: 'right'}, // Ï£ºÏÑ∏
	            	        7: { halign: 'right'}, // ÍµêÏú°ÏÑ∏
	            	        8: { halign: 'right'}, // ÎÜçÌäπÏÑ∏
	            	        9: { halign: 'right'}, // Ïã†Í≥†ÏßÄÏó∞Í∞ÄÏÇ∞ÏÑ∏
	            	        10: { halign: 'right'}, // ÎØ∏Ïã†Í≥†Í∞ÄÏÇ∞ÏÑ∏
	            	        11: { halign: 'right'}, // Ï¥ùÏÑ∏Ïï°
	            	  },
	            	  didParseCell: function (data) {
	            	        // üü° ÎßàÏßÄÎßâ Ìñâ (Ìï©Í≥Ñ Ìñâ)Îßå Î∞∞Í≤ΩÏÉâ Î≥ÄÍ≤Ω
	            	        if (data.row.index === datas2.length - 1) {
	            	            data.cell.styles.fillColor = [246, 243, 202]; // Ïó∞Ìïú ÌöåÏÉâ Î∞∞Í≤Ω
	            	            data.cell.styles.font = 'NanumSquareB'; // ÍµµÏùÄ Ìè∞Ìä∏ Ï†ÅÏö©
	            	            data.cell.styles.fontStyle = 'bold'; // Î≥ºÎìú Ï≤òÎ¶¨
	            	        }
	            	    }
	        		});
	            	
	            	const reportData3 = data.reportData3;
	                console.log("reportData3",reportData3);
	                
	                // Ï≤´ Î≤àÏß∏ÏôÄ ÎßàÏßÄÎßâ `lisDay`ÏóêÏÑú ÎÖÑÎèÑÎßå Ï∂îÏ∂ú
	                const firstYear = reportData3[0].lisDay.substring(0, 4);  // Ï≤´ Î≤àÏß∏ ÏöîÏÜåÏóêÏÑú '202401' -> '2024'
	                const lastYear = reportData3[reportData3.length - 1].lisDay.substring(0, 4);  // ÎßàÏßÄÎßâ ÏöîÏÜåÏóêÏÑú '202503' -> '2025'
	                
	                const firstYearData = [];
	                const lastYearData = [];

	                reportData3.forEach(item => {
	                  const year = item.lisDay.substring(0, 4);  // '202401' -> '2024', '202502' -> '2025'
	                  if (year === firstYear) {
	                    // Ï†ÑÎÖÑÎèÑ
	                    firstYearData.push(item.cntImp);  // cntImp Í∞íÏùÑ ÎÑ£Ïùå
	                  } else if (year === lastYear) {
	                	// Ïò¨Ìï¥
	                    lastYearData.push(item.cntImp);  // cntImp Í∞íÏùÑ ÎÑ£Ïùå
	                  }
	                });
	                
	                // Ï≤´ Î≤àÏß∏ÏôÄ Îëê Î≤àÏß∏ Î∞∞Ïó¥ÏóêÏÑú Í∞ÄÏû• ÌÅ∞ Í∞í Ï∂îÏ∂ú
	                const maxFirstYearData = Math.max(...firstYearData);
	                const maxLastYearData = Math.max(...lastYearData);

	                // Îëê Î∞∞Ïó¥ÏóêÏÑú Í∞ÄÏû• ÌÅ∞ Í∞í Ï§ë Îçî ÌÅ∞ Í∞íÏùÑ ÏÑ†ÌÉù
	                const maxValue = Math.max(maxFirstYearData, maxLastYearData) + 30;  // Í∞ÄÏû• ÌÅ∞ Í∞íÏóê 30ÏùÑ ÎçîÌï®

	                
	                // Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ (Ï†ÑÎÖÑÎèÑÏôÄ Ïò¨Ìï¥ Îç∞Ïù¥ÌÑ∞)
	            	const barChartData = {
	            	    labels: ['1Ïõî', '2Ïõî', '3Ïõî', '4Ïõî', '5Ïõî', '6Ïõî', '7Ïõî', '8Ïõî', '9Ïõî', '10Ïõî', '11Ïõî', '12Ïõî'],
	            	    datasets: [
	            	        {
	            	            label: `${firstYear}ÎÖÑ`, // Ï†ÑÎÖÑÎèÑ
	            	            backgroundColor: 'rgba(75, 192, 192, 0.2)', // Ïó∞ÎèÑÎ≥Ñ ÏÉâÏÉÅ
	            	            borderColor: 'rgba(75, 192, 192, 1)',
	            	            borderWidth: 1,
	            	            data: firstYearData // Ï†ÑÎÖÑÎèÑ Îç∞Ïù¥ÌÑ∞
	            	        },
	            	        {
	            	            label: `${lastYear}ÎÖÑ`, // Ïò¨Ìï¥
	            	            backgroundColor: 'rgba(255, 99, 132, 0.2)', // Ïó∞ÎèÑÎ≥Ñ ÏÉâÏÉÅ
	            	            borderColor: 'rgba(255, 99, 132, 1)',
	            	            borderWidth: 1,
	            	            data: lastYearData // Ïò¨Ìï¥ Îç∞Ïù¥ÌÑ∞
	            	        }
	            	    ]
	            	};
            	
	                
	                
	                //Ï†ÑÎÖÑ ÎèôÏõî ÎåÄÎπÑ Í±¥Ïàò ÎπÑÍµê Ï∞®Ìä∏ 
	            	//  Ï∫îÎ≤ÑÏä§ ÏÉùÏÑ±
		            const pdf2canvas = document.createElement('canvas');
	            	const pdf2ctx = pdf2canvas.getContext('2d');
	            	pdf2canvas.width = 450;
	            	pdf2canvas.height = 180;
	            	// Ï∫îÎ≤ÑÏä§Î•º ÌôîÎ©¥Ïóê Î≥¥Ïù¥ÏßÄ ÏïäÎèÑÎ°ù Ïà®ÍπÄ Ï≤òÎ¶¨
	            	pdf2canvas.style.display = 'none'; // Ïõπ ÌôîÎ©¥ÏóêÏÑú Ïà®ÍπÄ Ï≤òÎ¶¨
	            	
	            	document.body.appendChild(pdf2canvas);  // Ï∫îÎ≤ÑÏä§Î•º DOMÏóê Ï∂îÍ∞Ä (Ï∞®Ìä∏Í∞Ä Î≥¥Ïù¥ÎèÑÎ°ù)
	                
	               
            	const pdf2chart = new Chart(pdf2ctx, {
            		  type: 'bar',
            		  data: barChartData,
            		  options: {
            		    responsive: true,
            		    scales: {
            		    	x: {
            	                ticks: {
            	                    font: {
            	                        size: 18, // xÏ∂ï Ìè∞Ìä∏ ÌÅ¨Í∏∞
            	                        //weight: 'bold' // xÏ∂ï Ìè∞Ìä∏ ÎëêÍªò
            	                    }
            	                }
            	            },
            	            y: {
            	                ticks: {
            	                    beginAtZero: true, // yÏ∂ïÏù¥ 0Î∂ÄÌÑ∞ ÏãúÏûë
            	                    max: maxValue, // yÏ∂ï ÏµúÎåÄÍ∞í ÏÑ§Ï†ï
            	                    font: {
            	                        size: 18, // yÏ∂ï Ìè∞Ìä∏ ÌÅ¨Í∏∞
            	                        //weight: 'bold' // yÏ∂ï Ìè∞Ìä∏ ÎëêÍªò
            	                    }
            	                }
            	            }
            	        },
            		    plugins: {
            		    	legend: {
            	                position: 'bottom',
            	                fullWidth: true,
            	                labels: {
            	                    font: {
            	                        size: 20  // ÎùºÎ≤® ÌÅ¨Í∏∞ ÎèôÏùº
            	                        ,weight: 'bold'
            	                    },
            	                    boxWidth: 20,  // ÏïÑÏù¥ÏΩò ÌÅ¨Í∏∞ ÎèôÏùº
            	                    padding: 20
            	                }
            	            },
            		      title: {
          	                display: true,
          	                text: 'Ï†ÑÎÖÑ ÎèôÏõî ÎåÄÎπÑ Í±¥Ïàò ÎπÑÍµê',
          	                font: {
          	                    size: 28,  // Ï†úÎ™© ÌÅ¨Í∏∞ ÎèôÏùº
          	                    weight: 'bold'},
          	                padding: {
          	                    bottom: 10
          	                }
          	              }
            		    },
            		  }
            		});
	            	
	         // üü¢ Ï∞®Ìä∏ Î†åÎçîÎßÅ ÌõÑ 2Î≤àÏß∏ ÌéòÏù¥ÏßÄÏóê Ï∂îÍ∞Ä
	            setTimeout(() => {
	            	const imgData = canvas.toDataURL('image/png'); // ÏôºÏ™Ω Ï∞®Ìä∏ Ï∫îÎ≤ÑÏä§Î•º PNGÎ°ú Î≥ÄÌôò
	                const rightImgData = rightCanvas.toDataURL('image/png'); // Ïò§Î•∏Ï™Ω Ï∞®Ìä∏ Ï∫îÎ≤ÑÏä§Î•º PNGÎ°ú Î≥ÄÌôò
	                const pdf2ImgData = pdf2canvas.toDataURL('image/png');
	                
	                
	                doc.setPage(2);  
            	    let startY2 = doc.lastAutoTable.finalY + 30; // ÌÖåÏù¥Î∏î ÏïÑÎûòÏóê Ï∞®Ìä∏ Ï∂îÍ∞Ä
            	    doc.addImage(imgData, 'PNG', 35, startY2, 55, 55); // ÏôºÏ™Ω Ï∞®Ìä∏ (x, y, width, height)
            	    doc.addImage(rightImgData, 'PNG', 125, startY2, 55, 55); // Ïò§Î•∏Ï™Ω Ï∞®Ìä∏ (x, y, width, height)
            	    
            	    doc.setPage(3);
            	    let startY3 = doc.lastAutoTable.finalY + 10; // 3Î≤àÏß∏ ÌéòÏù¥ÏßÄ ÌÖåÏù¥Î∏î ÏïÑÎûòÏóê Ï†ÑÏõî ÎåÄÎπÑ Ï∞®Ìä∏ Ï∂îÍ∞Ä
            	    doc.addImage(pdf2ImgData, 'PNG', 15, startY3, 180, 68); // Ï†ÑÏõî ÎåÄÎπÑ Ï∞®Ìä∏ (x, y, width, height)

	                // üü¢ PDF Ï†ÄÏû•
	                doc.save('report.pdf');

	            }, 3000); // 3Ï¥à ÎîúÎ†àÏù¥ (Ï∞®Ìä∏ Î†åÎçîÎßÅ Í∏∞Îã§Î¶¨Í∏∞)
	            
 
        
        }

        img.onerror = function() {
            console.error("Failed to load background image");
        };

	}




