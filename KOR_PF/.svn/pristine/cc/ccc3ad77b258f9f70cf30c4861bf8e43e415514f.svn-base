/*[list] ì´ˆê¸° ë°ì´í„° get*/
var notPdfDate ="";
/*[list] ì´ˆê¸° ë°ì´í„° get*/
$( document ).ready(function() {
	//setTimeout(exportPdf, 500);
});

$(document).ready(function() {
	var dashboardYy = new Date().getFullYear();
	
	
	$('.band-calendar').each(function(){ regCaldash(this) ;})
	  //ìº˜ë¦°ë” í¬ë§·
	$('.datepicker').datepicker("option","dateFormat",dashFormat);

	  var date = new Date();
	  var month = date.getMonth();
	  var dayday = date.getDate();
	  
	  var today = new Date().toISOString().substring(0,7);
	  
	  $("#dashbordDate").val(today);

	// ëŒ€ì‹œë³´ë“œ ì •ë³´ê²€ìƒ‰
	//fn_selectDashboadInfo();
	//fn_moreNotice($("#moreNoticeList"));
	$("#chartTarget a").click(function() {
		$('.subOutter ol li #' + $(this).attr('id')).click();
		$('.subOutter, .bg').hide();

	})

	let nowYear = new Date().getFullYear();
	let nowMonth = new Date().getMonth() + 1;
	const objYMList = [];
	const yearMonthList = [];
	
	for (let i = nowYear; i >= 2020; i--) {
		for (let j = 12; j >= 1; j--) {
			if (i == nowYear && j > nowMonth) continue;
			
			let obj = i + "-" + (j <= 9 ? "0" + j : j);
			objYMList.push({ i: obj });
			yearMonthList.push(obj);
		}
	}
	
	const currentDate = `${nowYear}-${nowMonth <= 9 ? "0" + nowMonth : nowMonth}`;
	const yearMonthOptions = fn_makeSelect(objYMList, currentDate);
	document.getElementById("dashbordDate").innerHTML = yearMonthOptions;


	
	/*fn_dashInfo1("02");
	fn_dashManagerInfo();*/
});




function fn_makeSelect(objList, curVal) {
    let result = "";
    const optionHtml = "<option value='{key}' {selected}>{val}</option>";
    for (let i = 0; i < objList.length; i++) {
        const obj = objList[i];
        for (let x in obj) {
            let key = obj[x]; // 'i'
            let selected = key === curVal ? "selected" : "";
            const curObj = { key: key, val: key, selected: selected };
            result += fn_makeObj(curObj, optionHtml);
        }
    }
    return result;
}

function fn_makeObj(obj, template) {
    return template
        .replace("{key}", obj.key)
        .replace("{val}", obj.val)
        .replace("{selected}", obj.selected);
}


function fn_dashSrch(){
	
	const activeElement = document.querySelector("#chartType li.active");
	
	// ê°’ ì„ ì–¸
	let activeValue = null;

    if (activeElement.classList.contains("status-tab-imp")) {
        activeValue = "02"; // ìˆ˜ì…
    } else if (activeElement.classList.contains("status-tab-exp")) {
        activeValue = "01"; // ìˆ˜ì¶œ
    }
	
    var dashDate = $("#dashbordDate").val();
	
    fn_dashInfo1(activeValue);
	
}


function fn_rptType(type){
	if (type=="01"){
		const tabType1 = document.querySelector('.status-tab-exp');
		const tabType2 = document.querySelector('.status-tab-imp');
		tabType1.classList.add("active");
	    tabType2.classList.remove("active");
	} else {
		const tabType1 = document.querySelector('.status-tab-exp');
		const tabType2 = document.querySelector('.status-tab-imp');
	    tabType1.classList.remove("active");
	    tabType2.classList.add("active");
	}
	fn_dashInfo1(type);
}

function fn_dashInfo1(type){
	
	
	fn_loading(true);
	var sData = {};
	sData["srch1"] = type;
	sData["srch2"] = $("#dashbordDate").val();
	
	$.ajax({
		type : "POST",
		url : "/dash/selectDashboardInfo1.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			$("#dashInfo1").html('');
			document.querySelector('#myChart').remove();
		    document.querySelector('.myChartClass').innerHTML = '<canvas id="myChart" height="225"></canvas>'
			var newRow = "";
			var labelDate = [];  		// xì¶• ê°’
			var expCnt = [];  		// ê±´ìˆ˜ ê°’
			var expKrw = []; 
			// ê¸ˆì•¡ ê°’
			var impCnt = [];  		// ê±´ìˆ˜ ê°’
			var impKrw = []; 		// ê¸ˆì•¡ ê°’
			var impTax = []; 		// ê¸ˆì•¡ ê°’
				
				for (var i = 0; i < data.resultList.length; i++) {
					newRow = "<tr>" +
								 "<td id='sumDate'>"+data.resultList[i].sumDate + "</td>" +
								 "<td>"+data.resultList2[i].cnt + "</td>" +
								 "<td>"+data.resultList2[i].sumTax + "</td>" +
								 "<td>"+data.resultList2[i].sumKrw + "</td>" +
								 "<td>"+data.resultList[i].cnt + "</td>" +
								 "<td>"+data.resultList[i].sumKrw + "</td>" +
								 "</tr>"
					$("#dashInfo1").append(newRow);
				}
				
				for (var i = data.resultList.length - 1; i >= 0; i--) {
					labelDate.push(data.resultList[i].sumDate);
					expCnt.push(data.resultList[i].cnt);
					
					impCnt.push(data.resultList2[i].cnt);
					
					var strNumber = data.resultList[i].sumKrw;
					var number = parseInt(strNumber.replace(/,/g, ""), 10);
					
					var strNumber2 = data.resultList2[i].sumKrw;
					var number2 = parseInt(strNumber2.replace(/,/g, ""), 10);
					
					var strNumber3 = data.resultList2[i].sumTax;
					var number3 = parseInt(strNumber3.replace(/,/g, ""), 10);
					expKrw.push(number);
					impKrw.push(number2);
					impTax.push(number3);
				}
			// ì°¨íŠ¸ ìƒì„±
		if (type == "01"){
		  	var ctx = document.getElementById('myChart').getContext('2d');
		  	var myChart = new Chart(ctx, {
		    	type: 'bar',
		    	data: {
		      		labels: labelDate,
		      		datasets: [
		        		{
		          			type: 'bar',
		          			label: 'ìˆ˜ì¶œê°€ê²©(KRW)',
		          			data: expKrw,
		          			backgroundColor: 'rgba(255, 99, 132, 0.2)',
		          			borderColor: 'rgba(255, 99, 132, 1)',
		          			borderWidth: 1,
		          			yAxisID: 'bar-y-axis'
		        		},
		        		{
		          			type: 'line',
		          			label: 'ê±´ìˆ˜',
		          			data: expCnt,
		          			backgroundColor: 'rgba(54, 162, 235, 0.2)',
		          			borderColor: 'rgba(54, 162, 235, 1)',
		          			borderWidth: 1,
		          			fill: false,
		          			yAxisID: 'line-y-axis'
		        		}
		      		]
		    	},
		    options: {
			    	responsive: true,
			        maintainAspectRatio: false,
		      		scales: {
		      			'bar-y-axis': {
		  					id: 'bar-y-axis',
		  					type: 'linear',
		  					position: 'left',
		  					beginAtZero: true
						},
		        		'line-y-axis': {
		  					id: 'line-y-axis',
		  					type: 'linear',
		  					position: 'right',
		 	 				beginAtZero: true
		        		}
		    		}
		    	}
			});
				} else {
					var ctx = document.getElementById('myChart').getContext('2d');
				  	var myChart = new Chart(ctx, {
				    	type: 'bar',
				    	data: {
				      		labels: labelDate,
				      		datasets: [
				        		{
				          			type: 'bar',
				          			label: 'ìˆ˜ì…ê°€ê²©(KRW)',
				          			data: impKrw,
				          			backgroundColor: 'rgba(255, 99, 132, 0.2)',
				          			borderColor: 'rgba(255, 99, 132, 1)',
				          			borderWidth: 1,
				          			yAxisID: 'bar-y-axis'
				        		},
				        		{
				          			type: 'bar',
				          			label: 'ë‚©ë¶€ì„¸ì•¡(KRW)',
				          			data: impTax,
				          			backgroundColor: 'rgba(155, 200, 50, 0.2)',
				          			borderColor: 'rgba(155, 200, 50, 1)',
				          			borderWidth: 1,
				          			yAxisID: 'bar-y-axis'
				        		},
				        		{
				          			type: 'line',
				          			label: 'ê±´ìˆ˜',
				          			data: impCnt,
				          			backgroundColor: 'rgba(54, 162, 235, 0.2)',
				          			borderColor: 'rgba(54, 162, 235, 1)',
				          			borderWidth: 1,
				          			fill: false,
				          			yAxisID: 'line-y-axis'
				        		}
				      		]
				    	},
				    options: {
					    	responsive: true,
					        maintainAspectRatio: false,
				      		scales: {
				      			'bar-y-axis': {
				  					id: 'bar-y-axis',
				  					type: 'linear',
				  					position: 'left',
				  					beginAtZero: true
								},
								
				        		'line-y-axis': {
				  					id: 'line-y-axis',
				  					type: 'linear',
				  					position: 'right',
				 	 				beginAtZero: true
				        		}
				    		}
				    	}
					});
				}
			fn_loading(false);
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSearchError);
        	}
		}
	});
}


function fn_dashManagerInfo(){
    var sData = {};
    
    $.ajax({
        type : "POST",
        url : "/dash/selectDashManagerInfo.do",
        data : sData,
        beforeSend : function(xmlHttpRequest){
            xmlHttpRequest.setRequestHeader("AJAX", "true");
        },
        dataType : "json",
        success : function(data) {
            $("#dashManagerInfo").html('');
            var newRow = "";
            
            if (data.resultList.length == 0) {
                newRow = "<tr>" +
                         "<td style='text-align: center;'></td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "</tr>";
                $("#dashManagerInfo").append(newRow);
            } else {
                for (var i = 0; i < data.resultList.length; i++) {
                    newRow = "<tr>" +
                             "<td style='text-align: center;'>" + data.resultList[i].usrType + "</td>" +
                             "<td style='text-align: center;'>" + data.resultList[i].usrNm + "</td>" +
                             "<td style='text-align: center;'>" + data.resultList[i].usrEmail + "</td>" +
                             "<td style='text-align: center;'>" + data.resultList[i].usrTel + "</td>" +
                             "</tr>";
                    $("#dashManagerInfo").append(newRow);
                }
            }
        },
        error : function(e, textStatus, errorThrown) {
            if(e.status == 400){
                alert("Your request is up. Please log back in if you wish to continue");
                location.href = document.referrer;
            } else {
                console.log(errorThrown);
                alert("There was an error processing your request.");
            }
        }
    });
}


// ê³µì§€ì‚¬í•­ í´ë¦­
function fn_callNoticePop(noticeSeq) {
	$("#dashNoticePop").find("input").val(null);
	$("#dashNoticePop").find("textarea").val(null);
	$("#dashNoticePop").modal("show");
	$("#notiIcon" + noticeSeq + " #newicon").hide();

	var uData = {};
	uData["srch1"] = noticeSeq;
	$.ajax({
		type : "POST",
		url : "/base/updateReadNotice.do",
		data : JSON.stringify(uData),
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		contentType : "application/json; charset=utf-8",
		success : function(data) {
			if (data == "success") {
				fn_searchDashNotice(noticeSeq);
			}
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSaveError);
        	}
		}
	});

};

// ê³µì§€ì‚¬í•­ íŒì—…ê²€ìƒ‰
function fn_searchDashNotice(noticeSeq) {
	var sData = {};
	sData["srch1"] = noticeSeq;

	$.ajax({
		type : "POST",
		url : "/dash/selectDashNoticeInfo.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			if (data.result.dashFileNm == undefined
					|| data.result.dashFileNm == "") {
				$("#dashNoticeAttach").hide();
			} else {
				$("#dashNoticeAttach").show();
			}

			$.each(data.result, function(key, value) {
				$("#dashNoticePop").find("input[name='" + key + "']")
						.val(value);
				$("#dashNoticePop").find("textarea[name='" + key + "']").val(
						value);
			});
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSearchError);
        	}
		}
	});

};

// ì½ìŒì²´í¬
function fn_noticeReadCheck() {
	for (i = 0; i < colReadList.length; i++) {
		$("#notiIcon" + colReadList[i] + " #newicon").hide();
	}
}

// ê³µì§€ì‚¬í•­ ì¡°íšŒ
function fn_moreNotice(elemVal) {
	elemVal.val(Number(elemVal.val()) + 10);
	var nData = {};
	nData["startPoint"] = Number(elemVal.val());
	$.ajax({
		type : "POST",
		url : "/base/selectMoreNoticeList.do",
		data : nData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			colNoticecnt = data.totCnt;
			setTimeout(function() {
				fn_noticeList(data)
			}, 0.0001);
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				// alert(msgSearchError);
        	}
		}
	});

}

// ë¦¬ìŠ¤íŠ¸ ê·¸ë ¤ì£¼ëŠ” ë¶€ë¶„
function fn_noticeList(data) {
	if (data.totCnt > Number($("#moreNoticeList").val()) - 10
			|| $("#moreNoticeList").val() == "0") {
		$("#noticeTbl tbody").children().remove();
		var rowData;
		for (var i = 0; i < data.noticeList.length; i++) {
			rowData = data.noticeList[i];
			var rowText = "<tr>";
			rowText = rowText + "<tr onclick='fn_callNoticePop("
					+ rowData.noticeSeq + ")' style='cursor:pointer;'>";
			rowText = rowText + "<td>" + rowData.noticeSn + "</td>";
			rowText = rowText + "<td align='left' id='notiTit"
					+ rowData.noticeSeq + "'>" + rowData.title + "</td>";
			rowText = rowText
					+ "<td id='notiIcon"
					+ rowData.noticeSeq
					+ "'><span class='badge badge-info' style='margin-right:5px' id='newicon'>NEW</span></td>"
			rowText = rowText + "<td >" + rowData.regDt + "</td> ";
			rowText = rowText + "</tr>";
			$("#noticeTbl tbody").append(rowText);
			$("#noticeTbl").css("border-collapse", "collapse")
			$("#noticeTbl tbody").css("overflow-y", "hidden ")
			// $("#noticeTbl tbody").css("height","300px")
		}
		fn_noticeReadCheck();
	} else {
		alert(msgNotice);
	}
};

// notice modal popup
$('ul.bg-white li').on('click', function(){
	var dashNoticeSeq = $(this).find('p.text-sm:hidden').text();
    $('#dashNoticePop').show();
    fn_dashNoticeModalContentPopUp(dashNoticeSeq);
});


function fn_dashNoticeModalContentPopUp(dashNoticeSeq){
	var sData = {};
	sData["srch3"] = dashNoticeSeq;
	$.ajax({
		type : "POST",
		url : "/base/selectDashNoticeViewList.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType: "json",
        success : function(data) {
        	fillDashNoticeModalContent(data.resultList);
        },
        error : function(e, textStatus, errorThrown) {
        	if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
	        	console.log(errorThrown);
	        	alert(msgSearchError);
        	}
        }
	});
};

function fillDashNoticeModalContent(resultList) {
    var notice = resultList[0];
    var noticeDt = notice.noticeDt;
    var year = noticeDt.substring(0, 4);
    var month = noticeDt.substring(4, 6);
    var day = noticeDt.substring(6, 8);
    var formattedNoticeDt = year + "." + month + "." + day;
    
    var edtDt = notice.edtDt;

    document.querySelector('.dashNotice-modal h3').textContent = notice.titleKr;
    document.querySelector('.dashNotice-modal span').textContent = notice.date;
    // document.querySelector('.dashNotice-modal span').textContent = notice.edtDt;
    document.querySelector('.dashNotice-modal textarea').textContent = notice.cnKr;
    
    var strHtml = "";
    if (notice.fileOrgNm) {
        strHtml = '<a href="#" id="dashDownload" style="color:#030303"><i class="fa-regular fa-floppy-disk"></i> ì²¨ë¶€íŒŒì¼ : ' + notice.fileOrgNm + '</a>';
    }
    
    var dateInfo = document.querySelector('.dashNotice-modal .text-sm');
    if(edtDt == '' || edtDt == null) {
    	dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNoticeDt;
    } else {
    	/*var edtyear = edtDt.substring(0, 4);
        var edtmonth = edtDt.substring(4, 6);
        var edtday = edtDt.substring(6, 8);
        var formattedEdtDt = edtyear + "." + edtmonth + "." + edtday;
    	dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNoticeDt + ' , ìˆ˜ì •ì¼: ' + formattedEdtDt;*/
    }
    dateInfo.style.fontSize = '13px';
    
    document.querySelector('.dashNotice-modal .text-base').innerHTML = strHtml;
    
    var dashDownloadLink = document.getElementById('dashDownload');
    if (notice.fileOrgNm) {
	    dashDownloadLink.addEventListener('mouseenter', function() {
	    dashDownloadLink.style.color = 'rgb(45 126 98)';
	    dashDownloadLink.style.fontWeight = 'bold';
	    });
	
		dashDownloadLink.addEventListener('mouseleave', function() {
			 dashDownloadLink.style.color = '#030303';
			 dashDownloadLink.style.fontWeight = '';
		});
    }
}


$(document).on('click', '#dashDownload', function(){
	const htmlContent = event.target.innerHTML.trim();
	const fileOrgNm = htmlContent.split(' ì²¨ë¶€íŒŒì¼ : ')[1];
    $("#dashFileDown").val(fileOrgNm);
    document.dashFileDownForm.action = "/cmmn/dashFileDown.do";
    document.dashFileDownForm.submit();
})

// news modal popUp 
function dashNoticeClose(){
	$("#dashNoticePop").hide();
}

$('div.bg-blue li').on('click', function(){
	var dashNewsSeq = $(this).find('p.text-sm:hidden').text();
    $('#dashNewsPop').show();
    fn_dashNewsModalContentPopUp(dashNewsSeq);
});


function fn_dashNewsModalContentPopUp(dashNewsSeq){
	var sData = {};
	sData["srch3"] = dashNewsSeq;
	$.ajax({
		type : "POST",
		url : "/cmmn/selectNewsModalViewList.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType: "json",
        success : function(data) {
        	filldashNewsModalContent(data.resultList);
        },
        error : function(e, textStatus, errorThrown) {
        	if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
	        	console.log(errorThrown);
	        	alert(msgSearchError);
        	}
        }
	});
};


function filldashNewsModalContent(resultList) {
    var news = resultList[0];
    var regDt = news.regDt;
    var year = regDt.substring(0, 4);
    var month = regDt.substring(4, 6);
    var day = regDt.substring(6, 8);
    var formattedNewsDt = year + "." + month + "." + day;

    var edtDt = news.edtDt;

    document.querySelector('.dashNews-modal h3').textContent = news.titleKr || '';
    document.querySelector('.dashNews-modal span').textContent = news.regDt || '';
    
    var strHtml = '';
    if (news.fileName && news.fileName.trim() !== '') {
        var fileNames = news.fileName.split('/');
        strHtml = fileNames.map(function(name) {
            return '<a href="#" class="news-file-name" style="color:#030303;">' + '&nbsp;&nbsp;&nbsp;&nbsp;' + name + '</a>';
        }).join('<br>');
        strHtml = '<i class="fa-regular fa-floppy-disk"></i> ì²¨ë¶€íŒŒì¼ :<br>' + strHtml;
    }

    document.getElementById('mainNewsFileName').innerHTML = strHtml;

    setTimeout(function() {
        var fileNameElements = document.querySelectorAll('.news-file-name');
        fileNameElements.forEach(function(element) {
            element.addEventListener('mouseenter', function() {
                element.style.color = 'rgb(45, 126, 98)';
                element.style.fontWeight = 'bold';
            });

            element.addEventListener('mouseleave', function() {
                element.style.color = '#030303';
                element.style.fontWeight = '';
            });
        });
    }, 0);

    $("#dashNewsContent").html(news.cnKr || '');
    $('#dashNewsContent a').attr('target', '_blank');

    var dateInfo = document.querySelector('.dashNews-modal .text-sm');
    if (!edtDt) {
        dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNewsDt;
    } else {
        var edtyear = edtDt.substring(0, 4);
        var edtmonth = edtDt.substring(4, 6);
        var edtday = edtDt.substring(6, 8);
        var formattedEdtDt = edtyear + "." + edtmonth + "." + edtday;

        dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNewsDt + ' , ìˆ˜ì •ì¼: ' + formattedEdtDt;
    }
    dateInfo.style.fontSize = '13px';
}



//ì²¨ë¶€íŒŒì¼
$(document).on('click', '.dash-file-name', function(event) {
    const htmlContent = event.target.innerHTML.trim();
    const fileName = htmlContent.replace(/&nbsp;/g, '').trim();
    $("#noticeFileDown").val(fileName);
    document.dashNewsFileDownForm.action = "/cmmn/noticesFileDown.do";
    document.dashNewsFileDownForm.submit();
});

// ëŒ€ì‹œë³´ë“œ ë‚´ ê´€ì„¸ë‰´ìŠ¤ 
$(document).on('click', '.news-file-name', function (event) {
    event.preventDefault();
    const htmlContent = event.target.innerHTML.trim();
    const fileName = htmlContent.replace(/&nbsp;/g, '').trim();
    $("#mainNewsFileDown").val(fileName);
    const form = document.mainNewsFileDown;
    form.action = "/cmmn/mainNewsFileDown.do";
    form.submit();
});

function dashNewsClose(){
	$("#dashNewsPop").hide();
}



function dashExcelDownload(){
	
	fn_loading(true);
	var exCol = "";
	var exTit = "";
	var exTitDiv = "";
			//ìˆ˜ì¶œì…í˜„í™©
	exCol = "markCont|htLeft|180||cnt1|htRight|70||sum1|htRight|130||cnt2|htRight|70||sum2|htRight|130||cnt3|htRight|70||" +
			"sum3|htRight|130||cnt4|htRight|70||sum4|htRight|130||cnt5|htRight|70||sum5|htRight|130||cnt6|htRight|70||sum6|htRight|150|||" +
			"markCont|htLeft|180||cnt1|htRight|70||sum1|htRight|130||cnt2|htRight|70||sum2|htRight|130||cnt3|htRight|70||sum3|htRight|130||" +
			"cnt4|htRight|70||sum4|htRight|130||cnt5|htRight|70||sum5|htRight|130||cnt6|htRight|70||sum6|htRight|150|||supFirm|htLeft|200||" +
			"cnt1|htRight|80||sum1|htRight|150||cnt2|htRight|80||sum2|htRight|150||cnt3|htRight|80||sum3|htRight|150|||buyFirm|htLeft|200||" +
			"cnt1|htRight|80||sum1|htRight|150||cnt2|htRight|80||sum2|htRight|150||cnt3|htRight|80||sum3|htRight|150|||fodMark|htCenter|80||" +
			"title|htLeft|200||traMetCont|htLeft|160||conCod|htCenter|80||cnt|htRight|80||freKrw|htRight|120||totWt|htRight|100||" +
			"totTaxKrw|htRight|150||cal1|htRight|100||cal2|htRight|100|||fodMark|htCenter|80||title|htLeft|200||traMetCont|htLeft|160||" +
			"conCod|htCenter|80||cnt|htRight|80||insuKrw|htRight|120||totWt|htRight|100||totTaxKrw|htRight|150||cal1|htRight|100||cal2|" +
			"htRight|100|||" +
			//ìˆ˜ì¶œì…í˜„í™©
			//ë‹¨ê°€ë¶„ì„
			"plant|htLeft|150||invoice|htLeft|100||rptNo|htCenter|130||expLisDay|htCenter|150||totRptKrw|htRight|80||" +
			"excDivi|htCenter|80||excDiviCont|htLeft|80|||plant|htLeft|150||po|htLeft|100||blNo|htLeft|130||rptNo|htCenter|140||ranNo|htCenter|65||" +
			"sil|htCenter|65||lisDay|htCenter|95||rgCode|htCenter|130||upi|htRight|90||ut|htCenter|80||conKi|htCenter|80||supFirm|htLeft|140||" +
			"conCur|htCenter|75||upiWon|htRight|110||max|htRight|110||min|htRight|110||avg|htRight|110||maxDiff|htRight|110||minDiff|htRight|110||" +
			"avgDiff|htRight|110||maxPer|htRight|140||minPer|htRight|140||avgPer|htRight|140|||plant|htLeft|150||po|htLeft|100||blNo|htLeft|150||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||lisDay|htCenter|100||rgCode|htCenter|130||upi|htRight|150||ut|htCenter|80||" +
			"conKi|htCenter|80||supFirm|htLeft|200||conCur|htCenter|100||upiWon|htRight|130||avg|htRight|130|||plant|htLeft|200||rgCode|htLeft|150||" +
			"supFirm|htLeft|200||conCur|htCenter|100||rptCnt|htRight|80||rptSum|htRight|200|||" +
			//ë‹¨ê°€ë¶„ì„
			//ìˆ˜ì¶œì…ë°ì´í„° ë¶„ì„
			"rgCode|htCenter|120||hs|htCenter|120||stdGName1|htLeft|200||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||gsDivi|htCenter|80||gsRate|htRight|100||oriStMark1|htCenter|80||fodMark|htCenter|80||" +
			"qty|htRight|100||conAmt|htRight|100||conCur|htCenter|100||upiWon|htRight|200||gs|htRight|200|||rgCode|htCenter|120||hs|htCenter|120||" +
			"stdGName1|htLeft|200||rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||gsDivi|htCenter|80||gsRate|htRight|100||oriStMark1|htCenter|80||" +
			"fodMark|htCenter|80||qty|htRight|100||conAmt|htRight|100||conCur|htCenter|100||upiWon|htRight|200||gs|htRight|200|||supFirm|htLeft|200||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||stdName|htLeft|200||rmvRptNo|htCenter|150||rmvRanNo|htCenter|80||rmvStdName|htLeft|200||" +
			"gsDivi|htCenter|80||gsRate|htCenter|80||gs|htRight|150||vatDivi|htCenter|80||vatRate|htRight|80||vat|htRight|200||gsRmvMark|htCenter|100||" +
			"gsRmvRate|htRight|100||rmv|htRight|200||vatRmvMark|htCenter|100||vatRmvRate|htRight|100||vatRmv|htRight|200|||rgCode|htLeft|200||rptNo|htCenter|200||" +
			"ranNo|htCenter|200||sil|htCenter|200||hs|htCenter|200||taxKiDivi|htCenter|200||gxRate|htRight|200||oriStMark1|htCenter|200||fodMark|htCenter|200||lisDay|htCenter|200";
			//ìˆ˜ì¶œì…ë°ì´í„° ë¶„ì„
	
			//ìˆ˜ì¶œì… í˜„í™©
	exTit = "null|null||2020|2||2021|2||2022|2||2023|2||2024-05-29|2||í•©ê³„|2|||ê±°ë˜êµ¬ë¶„|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||" +
			"ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||" +
			"ìˆ˜ì…(KRW)|null||||null|null||2020|2||2021|2||2022|2||2023|2||2024-05-29|2||í•©ê³„|2|||ê±°ë˜êµ¬ë¶„|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||" +
			"ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||" +
			"ìˆ˜ì¶œ(KRW)|null||||í•´ì™¸ê±°ë˜ì²˜|null||ì¼ë°˜ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ê¸°íƒ€ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…í•©ê³„(ê±´)|null||ìˆ˜ì…í•©ê³„(KRW)|null||||" +
			"í•´ì™¸ê±°ë˜ì²˜|null||ì¼ë°˜ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ê¸°íƒ€ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œí•©ê³„(ê±´)|null||ìˆ˜ì¶œí•©ê³„(KRW)|null||||ì ì¶œêµ­|null||" +
			"í•´ì™¸ê±°ë˜ì²˜|null||ìš´ì†¡í˜•íƒœ|null||ì¸ë„ì¡°ê±´|null||ì‹ ê³ ê±´ìˆ˜|null||ìš´ì„|null||ì´ì¤‘ëŸ‰(KG)|null||ê³¼ì„¸ê°€ê²©(KRW)|null||ìš´ì„/ì¤‘ëŸ‰(KRW)|null||ìš´ì„/ê³¼ì„¸ê°€ê²©(%)|null||||" +
			"ì ì¶œêµ­|null||í•´ì™¸ê±°ë˜ì²˜|null||ìš´ì†¡í˜•íƒœ|null||ì¸ë„ì¡°ê±´|null||ì‹ ê³ ê±´ìˆ˜|null||ë³´í—˜ë£Œ|null||ì´ì¤‘ëŸ‰(KG)|null||ê³¼ì„¸ê°€ê²©(KRW)|null||ë³´í—˜ë£Œ/ì¤‘ëŸ‰(KRW)|null||" +
			"ë³´í—˜ë£Œ/ê³¼ì„¸ê°€ê²©(%)|null||||PO|null||ì¸ë³´ì´ìŠ¤ë²ˆí˜¸|null||ì‹ ê³ ë²ˆí˜¸|null||ìˆ˜ë¦¬ì¼ì|null||ì‹ ê³ ê°€ê²©|null||ìˆ˜ì¶œì½”ë“œ|null||ì™¸í™˜ì‹ ê³ ëŒ€ìƒì—¬ë¶€|null||||" +
			//ìˆ˜ì¶œì… í˜„í™©
			//ë‹¨ê°€ë¶„ì„
			"ê³µì¥ì½”ë“œ|null||PO|null||B/L|null||ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê·œê²©|null||ìˆ˜ë¦¬ì¼ì|null||ìì¬ì½”ë“œ|null||ì‹ ê³ ë‹¨ê°€|null||ì‹ ê³ ë‹¨ìœ„|null||ê²°ì œë°©ë²•|null||í•´ì™¸ê±°ë˜ì²˜|null||" +
			"ê²°ì œí†µí™”|null||ì›í™”ë‹¨ê°€|null||ìµœê³ ë‹¨ê°€|null||ìµœì €ë‹¨ê°€|null||í‰ê· ë‹¨ê°€|null||ë‹¨ê°€ì°¨ì´(ìµœê³ )|null||ë‹¨ê°€ì°¨ì´(ìµœì €)|null||ë‹¨ê°€ì°¨ì´(í‰ê· )|null||ë‹¨ê°€ì°¨ì´ ë¹„ìœ¨(ìµœê³ )|null||" +
			"ë‹¨ê°€ì°¨ì´ ë¹„ìœ¨(ìµœì €)|null||ë‹¨ê°€ì°¨ì´ ë¹„ìœ¨(í‰ê· )|null||||ê³µì¥ì½”ë“œ|null||PO|null||B/L|null||ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê·œê²©|null||ìˆ˜ë¦¬ì¼ì|null||ìì¬ì½”ë“œ|null||" +
			"ì‹ ê³ ë‹¨ê°€|null||ì‹ ê³ ë‹¨ìœ„|null||ê²°ì œë°©ë²•|null||í•´ì™¸ê±°ë˜ì²˜|null||ê²°ì œí†µí™”|null||ì›í™”ë‹¨ê°€|null||í‰ê· ë‹¨ê°€|null||||ê³µì¥ì½”ë“œ|null||ìì¬ì½”ë“œ|null||í•´ì™¸ê±°ë˜ì²˜|null||" +
			"ê²°ì œí†µí™”|null||ì‹ ê³ ê±´ìˆ˜|null||ì‹ ê³ ê¸ˆì•¡(ì›í™”)|null||||ìì¬ì½”ë“œ|null||ì„¸ë²ˆë¶€í˜¸|null||ê±°ë˜í’ˆëª…|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€ë²ˆí˜¸|null||ê·œê²©|null||ê´€ì„¸êµ¬ë¶„|null||ê´€ì„¸ìœ¨|null||" +
			"ì›ì‚°ì§€|null||ì ì¶œêµ­|null||ìˆ˜ëŸ‰|null||ê²°ì œê¸ˆì•¡|null||ê²°ì œí†µí™”|null||ì›í™”ê¸ˆì•¡|null||ë‚©ë¶€ê´€ì„¸ì•¡|null||||" +
			//ë‹¨ê°€ë¶„ì„
			//ìˆ˜ì¶œì… ë°ì´í„° ë¶„ì„
			"ìì¬ì½”ë“œ|null||ì„¸ë²ˆë¶€í˜¸|null||ê±°ë˜í’ˆëª…|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||" +
			"ë€ë²ˆí˜¸|null||ê·œê²©|null||ê´€ì„¸êµ¬ë¶„|null||ê´€ì„¸ìœ¨|null||ì›ì‚°ì§€|null||ì ì¶œêµ­|null||ìˆ˜ëŸ‰|null||ê²°ì œê¸ˆì•¡|null||ê²°ì œí†µí™”|null||ì›í™”ê¸ˆì•¡|null||ë‚©ë¶€ê´€ì„¸ì•¡|null||||null|null||" +
			"ê´€ì„¸ê°ë©´ì ìš© ê±´ ìˆ˜|3||ê´€ì„¸ê°ë©´ë¯¸ì ìš© ê±´ ìˆ˜|3||ì´ê´€ì„¸ì•¡|3||ì´ë¶€ê°€ì„¸ì•¡|3||ê´€ì„¸ê°ë©´ì„¸ì•¡|3||ë¶€ê°€ì„¸ê°ë©´ì„¸ì•¡|3|||í•´ì™¸ê±°ë˜ì²˜|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê±°ë˜í’ˆëª…|null||" +
			"ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê±°ë˜í’ˆëª…|null||ê´€ì„¸êµ¬ë¶„|null||ê´€ì„¸ìœ¨|null||ê´€ì„¸ì•¡|null||ë¶€ê°€ì„¸êµ¬ë¶„|null||ë¶€ê°€ì„¸ìœ¨|null||ë¶€ê°€ì„¸ì•¡|null||ê´€ì„¸ê°ë©´ë¶€í˜¸|null||ê´€ì„¸ê°ë©´ìœ¨|null||" +
			"ê´€ì„¸ê°ë©´ì„¸ì•¡|null||ë¶€ê°€ì„¸ê°ë©´ë¶€í˜¸|null||ë¶€ê°€ì„¸ê°ë©´ìœ¨|null||ë¶€ê°€ì„¸ê°ë©´ì„¸ì•¡|null||||ìì¬ì½”ë“œ|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê·œê²©|null||HS CODE|null||ì„¸ì¢…|null||ì„¸ìœ¨|null||ì›ì‚°ì§€|null||ì ì¶œêµ­|null||ìˆ˜ì…ì‹ ê³  ìˆ˜ë¦¬ì¼|null";
			//ìˆ˜ì¶œì… ë°ì´í„° ë¶„ì„
	
	exTitDiv = "1|5ë…„ì¹˜_ìˆ˜ì…ì‹¤ì ||2|5ë…„ì¹˜_ìˆ˜ì¶œì‹¤ì ||3|í•´ì™¸ê±°ë˜ì²˜ë³„_ìˆ˜ì…ì‹¤ì ||4|í•´ì™¸ê±°ë˜ì²˜ë³„_ìˆ˜ì¶œì‹¤ì ||5|ìš´ì„_ë¹„êµ||6|ë³´í—˜ë£Œ_ë¹„êµ||7|ì™¸í™˜ì‹ ê³ ëŒ€ìƒ_ìˆ˜ì¶œ||" + //ìˆ˜ì¶œì… í˜„í™©
			   "8|ìˆ˜ì…ë¬¼í’ˆ_ë‹¨ê°€ë¹„êµ||9|ìœ ë¬´ìƒ_ìˆ˜ì…ê±´_ê³¼ì„¸ê°€ê²©_ë¹„êµ||10|ë™ì¼ê±°ë˜,_ê²°ì œí†µí™”_ë³€ê²½ì ê²€||" +  //ë‹¨ê°€ë¶„ì„
			   "11|ë™ì¼ìì¬ì½”ë“œ_í’ˆëª©ë¶„ë¥˜_ìƒì´ì ê²€||12|ë™ì¼ìì¬ì½”ë“œ_ê´€ì„¸êµ¬ë¶„_ìƒì´ì ê²€||13|ê°ë©´_ì ìš©_ì¼ê´€ì„±_ê²€í† ||14|FTA_ì§ì ‘ìš´ì†¡ì›ì¹™"; //ìˆ˜ì¶œì… ë°ì´í„° ë¶„ì„
	
	var date = new Date();
	var month = date.getMonth();
	var dayday = date.getDate();
	var day = date.getDay();
	
	var startDt = new Date();
	startDt.setMonth(startDt.getMonth() - 1);
	startDt.setDate(1);
	
	var endDt = new Date();
	endDt.setMonth(endDt.getMonth(), 1);
	endDt.setDate(endDt.getDate() - 1);
	
	var today = startDt.toISOString().substring(0,10);
	var mtoday = endDt.toISOString().substring(0,10);
	
	$("#importUp_srch2").val(today);
	$("#importUp_srch3").val(mtoday);
	
	var parameters = {exCol : "", exTit: "", exTitDiv: "", exType: "", srch2: "", srch3: "", srch40: ""};
	
	
	parameters.exCol = exCol.replace(/ /g,"_");
	parameters.exTit = exTit.replace(/ /g,"_");
	parameters.exTitDiv = exTitDiv.replace(/ /g,"_");
	parameters.exType = "01";
	parameters.srch2 = today;
	parameters.srch3 = mtoday;
	parameters.srch40 = "TEST";
	
	
	$.ajax({
		 url: "/dashboard/dashDownloadExcel.do",
		 data: parameters,
		 type: 'POST',
		 cache: false,
		 timeout: 200000,
		 xhrFields: {
			 responseType: "blob",
		 },
	    success: function(blob, status, xhr) {
	    	try {
				// check for a filename
				 var fileName = "";
				 var disposition = xhr.getResponseHeader("Content-Disposition");

			       if (disposition && disposition.indexOf("attachment") !== -1) {
			      	 var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
			           var matches = filenameRegex.exec(disposition);

			           if (matches != null && matches[1]) {
			               fileName = decodeURI(matches[1].replace(/['"]/g, ""));
			           }
			       }

			       // for IE
			       if (window.navigator && window.navigator.msSaveOrOpenBlob) {
			           window.navigator.msSaveOrOpenBlob(blob, fileName);
			       } else {
			           var URL = window.URL || window.webkitURL;
			           var downloadUrl = URL.createObjectURL(blob);

			           if (fileName) {
			               var a = document.createElement("a");

			               // for safari
			               if (a.download === undefined) {
			                   window.location.href = downloadUrl;
			               } else {
			                   a.href = downloadUrl;
			                   a.download = fileName;
			                   document.body.appendChild(a);
			                   a.click();
			               }
			           } else {
			               window.location.href = downloadUrl;
			           }
			       }
		       fn_loading(false);
			} catch (e) {
				console.log(e);
				fn_loading(false);
			};
	    },
	    error: function(e, textStatus, errorThrown) {
	    	if(e.status == 400){
	    		alert("Your request is up. Please log back in if you wish continue");
	    		location.href = document.referrer;
	    	} else {
	        	console.log(errorThrown);
	    	}
	    }
	});
}

//
document.getElementById("reportAnalysis").addEventListener("click", function(event) {
    event.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
    fn_loading(true);
    // FTAê¸°ì¤€ì¼
    var url = "/rpt/reportAnalysisPdf.do"; // ì„œë²„ ì¸¡ ë§¤í•‘ê³¼ ì¼ì¹˜í•˜ëŠ” URLë¡œ ì„¤ì •
    // ë°ì´í„° êµ¬ì„±
    var sData = {};
    sData["srch8"] = $("#dashbordDate").val();
    console.log("ë‚ ì§œ"+$("#dashbordDate").val());
   
    $.ajax({
		 url: url,
		 data: sData,
		 type: 'GET',
		 dataType : 'json',
		 success: function(response) {
			    console.log("response", response);  
			    exportRptPdf(response); 
			    fn_loading(false);
			},
	    error: function(e, textStatus, errorThrown) {
	    	if(e.status == 400){
	    		alert("Your request is up. Please log back in if you wish continue");
	    		location.href = document.referrer;
	    	} else {
	        	console.log(errorThrown);
	    	}
	    }
	});
});



function exportRptPdf(data){

        if (!window.jsPDF) window.jsPDF = window.jspdf.jsPDF;
        var doc = new jsPDF({
            orientation: "portrait",
            unit: "mm",
            format: "a4"
        });
        
        console.log(window.jspdf);           // jsPDF ê°ì²´ê°€ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
        console.log(window.jspdf.autoTable);
        
        
        // âœ… í•œê¸€ í°íŠ¸ ì¶”ê°€ (malgun.ttf í•„ìš”)
        doc.addFont('/pf/fonts/NanumSquare.ttf', 'NanumSquare', 'normal');
        doc.setFont('NanumSquare'); // ì‚¬ìš©í•˜ë ¤ëŠ” í°íŠ¸ ì§€ì •
        

        var img = new Image();
        img.src = '/pf/images/report_2.jpg';
        var logoImg = new Image();
        logoImg.src = '/pf/images/report_4.png';

        img.onload = function () {
            console.log("Background image loaded successfully");
            doc.addImage(img, 'JPEG', 0, 0, 210, 297);
            doc.addImage(logoImg, 'PNG', 160, 10, 40, 15);

            doc.setFontSize(22);
            doc.setTextColor(56, 60, 98);
            doc.text(105, 110, String(data.rptDate1) + 'ë…„ ' + String(data.rptDate2) + 'ì›”', { align: "center" });

            doc.setFontSize(22);
            doc.text(105, 120, 'í†µê´€ë¦¬í¬íŠ¸', { align: "center" });

            doc.setFontSize(30);
            doc.text(105, 135, String(data.cmpnyInfo), { align: "center" });

            doc.setFontSize(15);
            doc.text(105, 270, String(data.today), { align: "center" });
            doc.text(105, 280, 'ì‹ í•œê´€ì„¸ë²•ì¸', { align: "center" });
            
            // ğŸŸ¢ ìƒˆë¡œìš´ í˜ì´ì§€ ì¶”ê°€
            doc.addPage();

            // ğŸŸ¢ "ìˆ˜ì…í†µê´€í˜„í™©" ì œëª© ì¶”ê°€
            doc.setFontSize(18);
            doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
            doc.setFont('NanumSquareB', 'normal');
            doc.setTextColor(62, 113, 175); 
            //doc.setFillColor(56, 60, 98); // íŒŒë€ìƒ‰ ë°°ê²½
            //doc.rect(10, 10, 190, 15, "F"); // ë°°ê²½ ì‚¬ê°í˜•
            doc.text(15, 20, "ìˆ˜ì…í†µê´€í˜„í™©");

            // ğŸŸ¢ ì„¤ëª… ì¶”ê°€ (ì™¼ìª½ ì •ë ¬ + ì¤„ ë‚˜ëˆ„ê¸°)
            doc.setFontSize(10);
            doc.addFont('/pf/fonts/NanumSquareR.ttf', 'NanumSquareR', 'normal');
            doc.setFont('NanumSquareR', 'normal');
            doc.setTextColor(0, 0, 0);
            const description = [
              `ë‹¤ìŒ ìë£ŒëŠ” ${data.rptDate2}ì›” í•œë‹¬ ìˆ˜ì…í†µê´€ ìë£Œì´ë©° ì´ 70ê±´ ìˆ˜ì…ì‹ ê³ ë¥¼ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.`,
              `ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™©ì€ P/L 10ê±´(10%), ì œì¶œ 10ê±´(10%), ê²€ì‚¬ 10ê±´(10%) ì…ë‹ˆë‹¤.`
            ];
            doc.text(15, 28, description);
        
            const datas = [
            	  ['2025-03-18', 10, 100000, 50, 30, 20, 10, 15, 5, 5],
            	  ['2025-03-19', 15, 150000, 60, 35, 25, 12, 18, 7, 7],
            	];

            	// í…Œì´ë¸” í—¤ë”
            	const header = [
            	  ['ìˆ˜ë¦¬ì¼ì', 'ê±´ìˆ˜', 'ê³¼ì„¸ê°€ê²©', 'ìˆ˜ì… ê±°ë˜í˜•íƒœ í˜„í™©', '', '', '', '', '', ''],  // ì²« ë²ˆì§¸ í–‰
            	  ['', '', '', 'ì¼ë°˜ìˆ˜ì…', 'ìˆ˜ë¦¬ë¬¼í’ˆ', 'ê²¬í’ˆ ë° ê´‘ê³ ìš©í’ˆ', 'ê¸°íƒ€ ìˆ˜ì… ìŠ¹ì¸ë©´ì„¸', 'ì¬ìˆ˜ì¶œì¡°ê±´', 'P/L', 'ì œì¶œì„œë¥˜']  // ë‘ ë²ˆì§¸ í–‰
            	];

            	const columns = [
            	  { header: 'ìˆ˜ë¦¬ì¼ì', dataKey: 'Lis_Day' },
            	  { header: 'ê±´ìˆ˜', dataKey: 'cnt' },
            	  { header: 'ê³¼ì„¸ê°€ê²©', dataKey: 'amount_krw' },
            	  { header: 'ìˆ˜ì… ê±°ë˜í˜•íƒœ í˜„í™©', colspan: 5, dataKey: '' },
            	  { header: 'ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™©', colspan: 3, dataKey: '' }
            	];

            	// í…Œì´ë¸” ì˜µì…˜ ì„¤ì •
            	doc.autoTable({
            	  head: header,
            	  body: datas,
            	  startY: 30,  // í…Œì´ë¸” ì‹œì‘ ìœ„ì¹˜ (Yì¶•)
            	  theme: 'grid',  // í…Œì´ë¸” ìŠ¤íƒ€ì¼
            	  columnStyles: {
            	    0: { halign: 'center' }, // ìˆ˜ë¦¬ì¼ì ì—´ì„ ê°€ìš´ë° ì •ë ¬
            	    1: { halign: 'center' }, // ê±´ìˆ˜ ì—´ì„ ê°€ìš´ë° ì •ë ¬
            	    2: { halign: 'center' }, // ê³¼ì„¸ê°€ê²© ì—´ì„ ê°€ìš´ë° ì •ë ¬
            	    3: { halign: 'center' }, // ìˆ˜ì… ê±°ë˜í˜•íƒœ í˜„í™©
            	    4: { halign: 'center' }, // ì¼ë°˜ìˆ˜ì…
            	    5: { halign: 'center' }, // ìˆ˜ë¦¬ë¬¼í’ˆ
            	    6: { halign: 'center' }, // ê²¬í’ˆ ë° ê´‘ê³ ìš©í’ˆ
            	    7: { halign: 'center' }, // ê¸°íƒ€ ìˆ˜ì… ìŠ¹ì¸ë©´ì„¸
            	    8: { halign: 'center' }, // ì¬ìˆ˜ì¶œì¡°ê±´
            	    9: { halign: 'center' }, // P/L
            	    10: { halign: 'center' }, // ì œì¶œì„œë¥˜
            	  },
            	  headStyles: {
            	    fontSize: 10,
            	    fontStyle: 'normal',
            	    fillColor: [255, 255, 255], // í—¤ë” ë°°ê²½ ìƒ‰ìƒ
            	    textColor: [0, 0, 0], // ê¸€ì ìƒ‰ìƒ
            	    valign: 'middle', // ìˆ˜ì§ ì •ë ¬
            	    halign: 'center', // ìˆ˜í‰ ì •ë ¬
            	  },
            	  margin: { left: 15, top: 15 },
            	});
            // ğŸŸ¢ PDF ì €ì¥
            doc.save("report1.pdf");
            
            
            
        };

        img.onerror = function() {
            console.error("Failed to load background image");
        };

	}




