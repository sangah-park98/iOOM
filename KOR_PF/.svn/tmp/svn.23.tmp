/*[list] ì´ˆê¸° ë°ì´í„° get*/
var notPdfDate ="";
/*[list] ì´ˆê¸° ë°ì´í„° get*/
$( document ).ready(function() {
	//setTimeout(exportPdf, 500);
});

$(document).ready(function() {
	var dashboardYy = new Date().getFullYear();
	
	
	$('.band-calendar').each(function(){ regCaldash(this) ;})
	  //ìº˜ë¦°ë” í¬ë§·
	$('.datepicker').datepicker("option","dateFormat",dashFormat);

	  var date = new Date();
	  var month = date.getMonth();
	  var dayday = date.getDate();
	  
	  var today = new Date().toISOString().substring(0,7);
	  
	  $("#dashbordDate").val(today);

	// ëŒ€ì‹œë³´ë“œ ì •ë³´ê²€ìƒ‰
	//fn_selectDashboadInfo();
	//fn_moreNotice($("#moreNoticeList"));
	$("#chartTarget a").click(function() {
		$('.subOutter ol li #' + $(this).attr('id')).click();
		$('.subOutter, .bg').hide();

	})

	let nowYear = new Date().getFullYear();
	let nowMonth = new Date().getMonth() + 1;
	const objYMList = [];
	const yearMonthList = [];
	
	for (let i = nowYear; i >= 2020; i--) {
		for (let j = 12; j >= 1; j--) {
			if (i == nowYear && j > nowMonth) continue;
			
			let obj = i + "-" + (j <= 9 ? "0" + j : j);
			objYMList.push({ i: obj });
			yearMonthList.push(obj);
		}
	}
	
	const currentDate = `${nowYear}-${nowMonth <= 9 ? "0" + nowMonth : nowMonth}`;
	const yearMonthOptions = fn_makeSelect(objYMList, currentDate);
	document.getElementById("dashbordDate").innerHTML = yearMonthOptions;


	
	//fn_dashInfo1("02");
	//fn_dashManagerInfo();
});




function fn_makeSelect(objList, curVal) {
    let result = "";
    const optionHtml = "<option value='{key}' {selected}>{val}</option>";
    for (let i = 0; i < objList.length; i++) {
        const obj = objList[i];
        for (let x in obj) {
            let key = obj[x]; // 'i'
            let selected = key === curVal ? "selected" : "";
            const curObj = { key: key, val: key, selected: selected };
            result += fn_makeObj(curObj, optionHtml);
        }
    }
    return result;
}

function fn_makeObj(obj, template) {
    return template
        .replace("{key}", obj.key)
        .replace("{val}", obj.val)
        .replace("{selected}", obj.selected);
}


function fn_dashSrch(){
	
	const activeElement = document.querySelector("#chartType li.active");
	
	// ê°’ ì„ ì–¸
	let activeValue = null;

    if (activeElement.classList.contains("status-tab-imp")) {
        activeValue = "02"; // ìˆ˜ì…
    } else if (activeElement.classList.contains("status-tab-exp")) {
        activeValue = "01"; // ìˆ˜ì¶œ
    }
	
    var dashDate = $("#dashbordDate").val();
	
    fn_dashInfo1(activeValue);
	
}


function fn_rptType(type){
	if (type=="01"){
		const tabType1 = document.querySelector('.status-tab-exp');
		const tabType2 = document.querySelector('.status-tab-imp');
		tabType1.classList.add("active");
	    tabType2.classList.remove("active");
	} else {
		const tabType1 = document.querySelector('.status-tab-exp');
		const tabType2 = document.querySelector('.status-tab-imp');
	    tabType1.classList.remove("active");
	    tabType2.classList.add("active");
	}
	fn_dashInfo1(type);
}

function fn_dashInfo1(type){
	
	
	fn_loading(true);
	var sData = {};
	sData["srch1"] = type;
	sData["srch2"] = $("#dashbordDate").val();
	
	$.ajax({
		type : "POST",
		url : "/dash/selectDashboardInfo1.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			$("#dashInfo1").html('');
			document.querySelector('#myChart').remove();
		    document.querySelector('.myChartClass').innerHTML = '<canvas id="myChart" height="225"></canvas>'
			var newRow = "";
			var labelDate = [];  		// xì¶• ê°’
			var expCnt = [];  		// ê±´ìˆ˜ ê°’
			var expKrw = []; 
			// ê¸ˆì•¡ ê°’
			var impCnt = [];  		// ê±´ìˆ˜ ê°’
			var impKrw = []; 		// ê¸ˆì•¡ ê°’
			var impTax = []; 		// ê¸ˆì•¡ ê°’
				
				for (var i = 0; i < data.resultList.length; i++) {
					newRow = "<tr>" +
								 "<td id='sumDate' style='text-align: center;'>"+data.resultList[i].sumDate + "</td>" +
								 "<td>"+data.resultList2[i].cnt + "</td>" +
								 "<td>"+data.resultList2[i].sumTax + "</td>" +
								 "<td>"+data.resultList2[i].sumKrw + "</td>" +
								 "<td>"+data.resultList[i].cnt + "</td>" +
								 "<td>"+data.resultList[i].sumKrw + "</td>" +
								 "</tr>"
					$("#dashInfo1").append(newRow);
				}
				
				for (var i = data.resultList.length - 1; i >= 0; i--) {
					labelDate.push(data.resultList[i].sumDate);
					expCnt.push(data.resultList[i].cnt);
					
					impCnt.push(data.resultList2[i].cnt);
					
					var strNumber = data.resultList[i].sumKrw;
					var number = parseInt(strNumber.replace(/,/g, ""), 10);
					
					var strNumber2 = data.resultList2[i].sumKrw;
					var number2 = parseInt(strNumber2.replace(/,/g, ""), 10);
					
					var strNumber3 = data.resultList2[i].sumTax;
					var number3 = parseInt(strNumber3.replace(/,/g, ""), 10);
					expKrw.push(number);
					impKrw.push(number2);
					impTax.push(number3);
				}
			// ì°¨íŠ¸ ìƒì„±
		if (type == "01"){
		  	var ctx = document.getElementById('myChart').getContext('2d');
		  	var myChart = new Chart(ctx, {
		    	type: 'bar',
		    	data: {
		      		labels: labelDate,
		      		datasets: [
		        		{
		          			type: 'bar',
		          			label: expVal /*'ìˆ˜ì¶œê°€ê²©(KRW)'*/,
		          			data: expKrw,
		          			backgroundColor: 'rgba(255, 99, 132, 0.2)',
		          			borderColor: 'rgba(255, 99, 132, 1)',
		          			borderWidth: 1,
		          			yAxisID: 'bar-y-axis'
		        		},
		        		{
		          			type: 'line',
		          			label: cnt /*'ê±´ìˆ˜'*/,
		          			data: expCnt,
		          			backgroundColor: 'rgba(54, 162, 235, 0.2)',
		          			borderColor: 'rgba(54, 162, 235, 1)',
		          			borderWidth: 1,
		          			fill: false,
		          			yAxisID: 'line-y-axis'
		        		}
		      		]
		    	},
		    options: {
			    	responsive: true,
			        maintainAspectRatio: false,
			        plugins: {
			            datalabels: {
			                display: false // ğŸ”¥ ìˆ«ì ë¼ë²¨ ìˆ¨ê¸°ê¸°
			            }
			        },
			        scales: {
		      			'bar-y-axis': {
		  					id: 'bar-y-axis',
		  					type: 'linear',
		  					position: 'left',
		  					beginAtZero: true
						},
		        		'line-y-axis': {
		  					id: 'line-y-axis',
		  					type: 'linear',
		  					position: 'right',
		 	 				beginAtZero: true
		        		}
		    		}
		    	}
			});
				} else {
					var ctx = document.getElementById('myChart').getContext('2d');
				  	var myChart = new Chart(ctx, {
				    	type: 'bar',
				    	data: {
				      		labels: labelDate,
				      		datasets: [
				        		{
				          			type: 'bar',
				          			label: impVal /*'ìˆ˜ì…ê°€ê²©(KRW)'*/,
				          			data: impKrw,
				          			backgroundColor: 'rgba(255, 99, 132, 0.2)',
				          			borderColor: 'rgba(255, 99, 132, 1)',
				          			borderWidth: 1,
				          			yAxisID: 'bar-y-axis'
				        		},
				        		{
				          			type: 'bar',
				          			label: taxPaid /*'ë‚©ë¶€ì„¸ì•¡(KRW)'*/,
				          			data: impTax,
				          			backgroundColor: 'rgba(155, 200, 50, 0.2)',
				          			borderColor: 'rgba(155, 200, 50, 1)',
				          			borderWidth: 1,
				          			yAxisID: 'bar-y-axis'
				        		},
				        		{
				          			type: 'line',
				          			label: cnt /*'ê±´ìˆ˜'*/,
				          			data: impCnt,
				          			backgroundColor: 'rgba(54, 162, 235, 0.2)',
				          			borderColor: 'rgba(54, 162, 235, 1)',
				          			borderWidth: 1,
				          			fill: false,
				          			yAxisID: 'line-y-axis'
				        		}
				      		]
				    	},
				    options: {
					    	responsive: true,
					        maintainAspectRatio: false,
					        plugins: {
					            datalabels: {
					                display: false // ğŸ”¥ ìˆ«ì ë¼ë²¨ ìˆ¨ê¸°ê¸°
					            }
					        },
					        scales: {
				      			'bar-y-axis': {
				  					id: 'bar-y-axis',
				  					type: 'linear',
				  					position: 'left',
				  					beginAtZero: true
								},
								
				        		'line-y-axis': {
				  					id: 'line-y-axis',
				  					type: 'linear',
				  					position: 'right',
				 	 				beginAtZero: true
				        		}
				    		}
				    	}
					});
				}
			fn_loading(false);
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSearchError);
        	}
		}
	});
}


function fn_dashManagerInfo(){
    var sData = {};
    $.ajax({
        type : "POST",
        url : "/dash/selectDashManagerInfo.do",
        data : sData,
        beforeSend : function(xmlHttpRequest){
            xmlHttpRequest.setRequestHeader("AJAX", "true");
        },
        dataType : "json",
        success : function(data) {
            $("#dashManagerInfo").html('');
            var newRow = "";
            
            if (data.resultList.length == 0) {
                newRow = "<tr>" +
                         "<td style='text-align: center;'></td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "<td style='text-align: center;'>" + '-' + "</td>" +
                         "</tr>";
                $("#dashManagerInfo").append(newRow);
            } else if(lang == 'en') {
            	for (var i = 0; i < data.resultList.length; i++) {
                    newRow = "<tr>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrType + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrEmail + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrTel + "</td>" +
                             "</tr>";
                    $("#dashManagerInfo").append(newRow);
            	}
            } else {
                for (var i = 0; i < data.resultList.length; i++) {
                    newRow = "<tr>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrType + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrNm + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrEmail + "</td>" +
	                             "<td style='text-align: center;'>" + data.resultList[i].usrTel + "</td>" +
                             "</tr>";
                    $("#dashManagerInfo").append(newRow);
                }
            }
        },
        error : function(e, textStatus, errorThrown) {
            if(e.status == 400){
                alert("Your request is up. Please log back in if you wish to continue");
                location.href = document.referrer;
            } else {
                console.log(errorThrown);
                alert("There was an error processing your request.");
            }
        }
    });
}


// ê³µì§€ì‚¬í•­ í´ë¦­
function fn_callNoticePop(noticeSeq) {
	$("#dashNoticePop").find("input").val(null);
	$("#dashNoticePop").find("textarea").val(null);
	$("#dashNoticePop").modal("show");
	$("#notiIcon" + noticeSeq + " #newicon").hide();

	var uData = {};
	uData["srch1"] = noticeSeq;
	$.ajax({
		type : "POST",
		url : "/base/updateReadNotice.do",
		data : JSON.stringify(uData),
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		contentType : "application/json; charset=utf-8",
		success : function(data) {
			if (data == "success") {
				fn_searchDashNotice(noticeSeq);
			}
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSaveError);
        	}
		}
	});

};

// ê³µì§€ì‚¬í•­ íŒì—…ê²€ìƒ‰
function fn_searchDashNotice(noticeSeq) {
	var sData = {};
	sData["srch1"] = noticeSeq;

	$.ajax({
		type : "POST",
		url : "/dash/selectDashNoticeInfo.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			if (data.result.dashFileNm == undefined
					|| data.result.dashFileNm == "") {
				$("#dashNoticeAttach").hide();
			} else {
				$("#dashNoticeAttach").show();
			}

			$.each(data.result, function(key, value) {
				$("#dashNoticePop").find("input[name='" + key + "']")
						.val(value);
				$("#dashNoticePop").find("textarea[name='" + key + "']").val(
						value);
			});
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				alert(msgSearchError);
        	}
		}
	});

};

// ì½ìŒì²´í¬
function fn_noticeReadCheck() {
	for (i = 0; i < colReadList.length; i++) {
		$("#notiIcon" + colReadList[i] + " #newicon").hide();
	}
}

// ê³µì§€ì‚¬í•­ ì¡°íšŒ
function fn_moreNotice(elemVal) {
	elemVal.val(Number(elemVal.val()) + 10);
	var nData = {};
	nData["startPoint"] = Number(elemVal.val());
	$.ajax({
		type : "POST",
		url : "/base/selectMoreNoticeList.do",
		data : nData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType : "json",
		success : function(data) {
			colNoticecnt = data.totCnt;
			setTimeout(function() {
				fn_noticeList(data)
			}, 0.0001);
		},
		error : function(e, textStatus, errorThrown) {
			if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
				console.log(errorThrown);
				// alert(msgSearchError);
        	}
		}
	});

}

// ë¦¬ìŠ¤íŠ¸ ê·¸ë ¤ì£¼ëŠ” ë¶€ë¶„
function fn_noticeList(data) {
	if (data.totCnt > Number($("#moreNoticeList").val()) - 10
			|| $("#moreNoticeList").val() == "0") {
		$("#noticeTbl tbody").children().remove();
		var rowData;
		for (var i = 0; i < data.noticeList.length; i++) {
			rowData = data.noticeList[i];
			var rowText = "<tr>";
			rowText = rowText + "<tr onclick='fn_callNoticePop("
					+ rowData.noticeSeq + ")' style='cursor:pointer;'>";
			rowText = rowText + "<td>" + rowData.noticeSn + "</td>";
			rowText = rowText + "<td align='left' id='notiTit"
					+ rowData.noticeSeq + "'>" + rowData.title + "</td>";
			rowText = rowText
					+ "<td id='notiIcon"
					+ rowData.noticeSeq
					+ "'><span class='badge badge-info' style='margin-right:5px' id='newicon'>NEW</span></td>"
			rowText = rowText + "<td >" + rowData.regDt + "</td> ";
			rowText = rowText + "</tr>";
			$("#noticeTbl tbody").append(rowText);
			$("#noticeTbl").css("border-collapse", "collapse")
			$("#noticeTbl tbody").css("overflow-y", "hidden ")
			// $("#noticeTbl tbody").css("height","300px")
		}
		fn_noticeReadCheck();
	} else {
		alert(msgNotice);
	}
};

// notice modal popup
$('ul.bg-white li').on('click', function(){
	var dashNoticeSeq = $(this).find('p.text-sm:hidden').text();
    $('#dashNoticePop').show();
    fn_dashNoticeModalContentPopUp(dashNoticeSeq);
});


function fn_dashNoticeModalContentPopUp(dashNoticeSeq){
	var sData = {};
	sData["srch3"] = dashNoticeSeq;
	$.ajax({
		type : "POST",
		url : "/base/selectDashNoticeViewList.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType: "json",
        success : function(data) {
        	fillDashNoticeModalContent(data.resultList);
        },
        error : function(e, textStatus, errorThrown) {
        	if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
	        	console.log(errorThrown);
	        	alert(msgSearchError);
        	}
        }
	});
};

function fillDashNoticeModalContent(resultList) {
    var notice = resultList[0];
    var noticeDt = notice.noticeDt;
    var year = noticeDt.substring(0, 4);
    var month = noticeDt.substring(4, 6);
    var day = noticeDt.substring(6, 8);
    var formattedNoticeDt = year + "." + month + "." + day;
    
    var edtDt = notice.edtDt;

    document.querySelector('.dashNotice-modal h3').textContent = notice.titleKr;
    document.querySelector('.dashNotice-modal span').textContent = notice.date;
    // document.querySelector('.dashNotice-modal span').textContent = notice.edtDt;
    document.querySelector('.dashNotice-modal textarea').textContent = notice.cnKr;
    
    var strHtml = "";
    if (notice.fileOrgNm) {
        strHtml = '<a href="#" id="dashDownload" style="color:#030303"><i class="fa-regular fa-floppy-disk"></i> ì²¨ë¶€íŒŒì¼ : ' + notice.fileOrgNm + '</a>';
    }
    
    var dateInfo = document.querySelector('.dashNotice-modal .text-sm');
    if(edtDt == '' || edtDt == null) {
    	dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNoticeDt;
    } else {
    	/*var edtyear = edtDt.substring(0, 4);
        var edtmonth = edtDt.substring(4, 6);
        var edtday = edtDt.substring(6, 8);
        var formattedEdtDt = edtyear + "." + edtmonth + "." + edtday;
    	dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNoticeDt + ' , ìˆ˜ì •ì¼: ' + formattedEdtDt;*/
    }
    dateInfo.style.fontSize = '13px';
    
    document.querySelector('.dashNotice-modal .text-base').innerHTML = strHtml;
    
    var dashDownloadLink = document.getElementById('dashDownload');
    if (notice.fileOrgNm) {
	    dashDownloadLink.addEventListener('mouseenter', function() {
	    dashDownloadLink.style.color = 'rgb(45 126 98)';
	    dashDownloadLink.style.fontWeight = 'bold';
	    });
	
		dashDownloadLink.addEventListener('mouseleave', function() {
			 dashDownloadLink.style.color = '#030303';
			 dashDownloadLink.style.fontWeight = '';
		});
    }
}


$(document).on('click', '#dashDownload', function(){
	const htmlContent = event.target.innerHTML.trim();
	const fileOrgNm = htmlContent.split(' ì²¨ë¶€íŒŒì¼ : ')[1];
    $("#dashFileDown").val(fileOrgNm);
    document.dashFileDownForm.action = "/cmmn/dashFileDown.do";
    document.dashFileDownForm.submit();
})

// news modal popUp 
function dashNoticeClose(){
	$("#dashNoticePop").hide();
}

$('div.bg-blue li').on('click', function(){
	var dashNewsSeq = $(this).find('p.text-sm:hidden').text();
    $('#dashNewsPop').show();
    fn_dashNewsModalContentPopUp(dashNewsSeq);
});


function fn_dashNewsModalContentPopUp(dashNewsSeq){
	var sData = {};
	sData["srch3"] = dashNewsSeq;
	$.ajax({
		type : "POST",
		url : "/cmmn/selectNewsModalViewList.do",
		data : sData,
		beforeSend : function(xmlHttpRequest){
			xmlHttpRequest.setRequestHeader("AJAX", "true");
		},
		dataType: "json",
        success : function(data) {
        	filldashNewsModalContent(data.resultList);
        },
        error : function(e, textStatus, errorThrown) {
        	if(e.status == 400){
        		alert("Your request is up. Please log back in if you wish continue");
        		location.href = document.referrer;
        	} else {
	        	console.log(errorThrown);
	        	alert(msgSearchError);
        	}
        }
	});
};


function filldashNewsModalContent(resultList) {
    var news = resultList[0];
    var regDt = news.regDt;
    var year = regDt.substring(0, 4);
    var month = regDt.substring(4, 6);
    var day = regDt.substring(6, 8);
    var formattedNewsDt = year + "." + month + "." + day;

    var edtDt = news.edtDt;

    document.querySelector('.dashNews-modal h3').textContent = news.titleKr || '';
    document.querySelector('.dashNews-modal span').textContent = news.regDt || '';
    
    var strHtml = '';
    if (news.fileName && news.fileName.trim() !== '') {
        var fileNames = news.fileName.split('/');
        strHtml = fileNames.map(function(name) {
            return '<a href="#" class="news-file-name" style="color:#030303;">' + '&nbsp;&nbsp;&nbsp;&nbsp;' + name + '</a>';
        }).join('<br>');
        strHtml = '<i class="fa-regular fa-floppy-disk"></i> ì²¨ë¶€íŒŒì¼ :<br>' + strHtml;
    }

    document.getElementById('mainNewsFileName').innerHTML = strHtml;

    setTimeout(function() {
        var fileNameElements = document.querySelectorAll('.news-file-name');
        fileNameElements.forEach(function(element) {
            element.addEventListener('mouseenter', function() {
                element.style.color = 'rgb(45, 126, 98)';
                element.style.fontWeight = 'bold';
            });

            element.addEventListener('mouseleave', function() {
                element.style.color = '#030303';
                element.style.fontWeight = '';
            });
        });
    }, 0);

    $("#dashNewsContent").html(news.cnKr || '');
    $('#dashNewsContent a').attr('target', '_blank');

    var dateInfo = document.querySelector('.dashNews-modal .text-sm');
    if (!edtDt) {
        dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNewsDt;
    } else {
        var edtyear = edtDt.substring(0, 4);
        var edtmonth = edtDt.substring(4, 6);
        var edtday = edtDt.substring(6, 8);
        var formattedEdtDt = edtyear + "." + edtmonth + "." + edtday;

        dateInfo.textContent = 'ë“±ë¡ì¼: ' + formattedNewsDt + ' , ìˆ˜ì •ì¼: ' + formattedEdtDt;
    }
    dateInfo.style.fontSize = '13px';
}



//ì²¨ë¶€íŒŒì¼
$(document).on('click', '.dash-file-name', function(event) {
    const htmlContent = event.target.innerHTML.trim();
    const fileName = htmlContent.replace(/&nbsp;/g, '').trim();
    $("#noticeFileDown").val(fileName);
    document.dashNewsFileDownForm.action = "/cmmn/noticesFileDown.do";
    document.dashNewsFileDownForm.submit();
});

// ëŒ€ì‹œë³´ë“œ ë‚´ ê´€ì„¸ë‰´ìŠ¤ 
$(document).on('click', '.news-file-name', function (event) {
    event.preventDefault();
    const htmlContent = event.target.innerHTML.trim();
    const fileName = htmlContent.replace(/&nbsp;/g, '').trim();
    $("#mainNewsFileDown").val(fileName);
    const form = document.mainNewsFileDown;
    form.action = "/cmmn/mainNewsFileDown.do";
    form.submit();
});

function dashNewsClose(){
	$("#dashNewsPop").hide();
}



function dashExcelDownload(){
	
	fn_loading(true);
	var exCol = "";
	var exTit = "";
	var exTitDiv = "";
			//ìˆ˜ì¶œì…í˜„í™©
	exCol = "markCont|htLeft|180||cnt1|htRight|70||sum1|htRight|130||cnt2|htRight|70||sum2|htRight|130||cnt3|htRight|70||" +
			"sum3|htRight|130||cnt4|htRight|70||sum4|htRight|130||cnt5|htRight|70||sum5|htRight|130||cnt6|htRight|70||sum6|htRight|150|||" +
			"markCont|htLeft|180||cnt1|htRight|70||sum1|htRight|130||cnt2|htRight|70||sum2|htRight|130||cnt3|htRight|70||sum3|htRight|130||" +
			"cnt4|htRight|70||sum4|htRight|130||cnt5|htRight|70||sum5|htRight|130||cnt6|htRight|70||sum6|htRight|150|||supFirm|htLeft|200||" +
			"cnt1|htRight|80||sum1|htRight|150||cnt2|htRight|80||sum2|htRight|150||cnt3|htRight|80||sum3|htRight|150|||buyFirm|htLeft|200||" +
			"cnt1|htRight|80||sum1|htRight|150||cnt2|htRight|80||sum2|htRight|150||cnt3|htRight|80||sum3|htRight|150|||fodMark|htCenter|80||" +
			"title|htLeft|200||traMetCont|htLeft|160||conCod|htCenter|80||cnt|htRight|80||freKrw|htRight|120||totWt|htRight|100||" +
			"totTaxKrw|htRight|150||cal1|htRight|100||cal2|htRight|100|||fodMark|htCenter|80||title|htLeft|200||traMetCont|htLeft|160||" +
			"conCod|htCenter|80||cnt|htRight|80||insuKrw|htRight|120||totWt|htRight|100||totTaxKrw|htRight|150||cal1|htRight|100||cal2|" +
			"htRight|100|||" +
			//ìˆ˜ì¶œì…í˜„í™©
			//ë‹¨ê°€ë¶„ì„
			"plant|htLeft|150||invoice|htLeft|100||rptNo|htCenter|130||expLisDay|htCenter|150||totRptKrw|htRight|80||" +
			"excDivi|htCenter|80||excDiviCont|htLeft|80|||plant|htLeft|150||po|htLeft|100||blNo|htLeft|130||rptNo|htCenter|140||ranNo|htCenter|65||" +
			"sil|htCenter|65||lisDay|htCenter|95||rgCode|htCenter|130||upi|htRight|90||ut|htCenter|80||conKi|htCenter|80||supFirm|htLeft|140||" +
			"conCur|htCenter|75||upiWon|htRight|110||max|htRight|110||min|htRight|110||avg|htRight|110||maxDiff|htRight|110||minDiff|htRight|110||" +
			"avgDiff|htRight|110||maxPer|htRight|140||minPer|htRight|140||avgPer|htRight|140|||plant|htLeft|150||po|htLeft|100||blNo|htLeft|150||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||lisDay|htCenter|100||rgCode|htCenter|130||upi|htRight|150||ut|htCenter|80||" +
			"conKi|htCenter|80||supFirm|htLeft|200||conCur|htCenter|100||upiWon|htRight|130||avg|htRight|130|||plant|htLeft|200||rgCode|htLeft|150||" +
			"supFirm|htLeft|200||conCur|htCenter|100||rptCnt|htRight|80||rptSum|htRight|200|||" +
			//ë‹¨ê°€ë¶„ì„
			//ìˆ˜ì¶œì…ë°ì´í„° ë¶„ì„
			"rgCode|htCenter|120||hs|htCenter|120||stdGName1|htLeft|200||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||gsDivi|htCenter|80||gsRate|htRight|100||oriStMark1|htCenter|80||fodMark|htCenter|80||" +
			"qty|htRight|100||conAmt|htRight|100||conCur|htCenter|100||upiWon|htRight|200||gs|htRight|200|||rgCode|htCenter|120||hs|htCenter|120||" +
			"stdGName1|htLeft|200||rptNo|htCenter|150||ranNo|htCenter|80||sil|htCenter|80||gsDivi|htCenter|80||gsRate|htRight|100||oriStMark1|htCenter|80||" +
			"fodMark|htCenter|80||qty|htRight|100||conAmt|htRight|100||conCur|htCenter|100||upiWon|htRight|200||gs|htRight|200|||supFirm|htLeft|200||" +
			"rptNo|htCenter|150||ranNo|htCenter|80||stdName|htLeft|200||rmvRptNo|htCenter|150||rmvRanNo|htCenter|80||rmvStdName|htLeft|200||" +
			"gsDivi|htCenter|80||gsRate|htCenter|80||gs|htRight|150||vatDivi|htCenter|80||vatRate|htRight|80||vat|htRight|200||gsRmvMark|htCenter|100||" +
			"gsRmvRate|htRight|100||rmv|htRight|200||vatRmvMark|htCenter|100||vatRmvRate|htRight|100||vatRmv|htRight|200|||rgCode|htLeft|200||rptNo|htCenter|200||" +
			"ranNo|htCenter|200||sil|htCenter|200||hs|htCenter|200||taxKiDivi|htCenter|200||gxRate|htRight|200||oriStMark1|htCenter|200||fodMark|htCenter|200||lisDay|htCenter|200";
			//ìˆ˜ì¶œì…ë°ì´í„° ë¶„ì„
	
			//ìˆ˜ì¶œì… í˜„í™©
	exTit = "null|null||2020|2||2021|2||2022|2||2023|2||2024-05-29|2||í•©ê³„|2|||ê±°ë˜êµ¬ë¶„|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||" +
			"ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…(ê±´)|null||" +
			"ìˆ˜ì…(KRW)|null||||null|null||2020|2||2021|2||2022|2||2023|2||2024-05-29|2||í•©ê³„|2|||ê±°ë˜êµ¬ë¶„|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||" +
			"ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œ(ê±´)|null||" +
			"ìˆ˜ì¶œ(KRW)|null||||í•´ì™¸ê±°ë˜ì²˜|null||ì¼ë°˜ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ê¸°íƒ€ìˆ˜ì…(ê±´)|null||ìˆ˜ì…(KRW)|null||ìˆ˜ì…í•©ê³„(ê±´)|null||ìˆ˜ì…í•©ê³„(KRW)|null||||" +
			"í•´ì™¸ê±°ë˜ì²˜|null||ì¼ë°˜ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ê¸°íƒ€ìˆ˜ì¶œ(ê±´)|null||ìˆ˜ì¶œ(KRW)|null||ìˆ˜ì¶œí•©ê³„(ê±´)|null||ìˆ˜ì¶œí•©ê³„(KRW)|null||||ì ì¶œêµ­|null||" +
			"í•´ì™¸ê±°ë˜ì²˜|null||ìš´ì†¡í˜•íƒœ|null||ì¸ë„ì¡°ê±´|null||ì‹ ê³ ê±´ìˆ˜|null||ìš´ì„|null||ì´ì¤‘ëŸ‰(KG)|null||ê³¼ì„¸ê°€ê²©(KRW)|null||ìš´ì„/ì¤‘ëŸ‰(KRW)|null||ìš´ì„/ê³¼ì„¸ê°€ê²©(%)|null||||" +
			"ì ì¶œêµ­|null||í•´ì™¸ê±°ë˜ì²˜|null||ìš´ì†¡í˜•íƒœ|null||ì¸ë„ì¡°ê±´|null||ì‹ ê³ ê±´ìˆ˜|null||ë³´í—˜ë£Œ|null||ì´ì¤‘ëŸ‰(KG)|null||ê³¼ì„¸ê°€ê²©(KRW)|null||ë³´í—˜ë£Œ/ì¤‘ëŸ‰(KRW)|null||" +
			"ë³´í—˜ë£Œ/ê³¼ì„¸ê°€ê²©(%)|null||||PO|null||ì¸ë³´ì´ìŠ¤ë²ˆí˜¸|null||ì‹ ê³ ë²ˆí˜¸|null||ìˆ˜ë¦¬ì¼ì|null||ì‹ ê³ ê°€ê²©|null||ìˆ˜ì¶œì½”ë“œ|null||ì™¸í™˜ì‹ ê³ ëŒ€ìƒì—¬ë¶€|null||||" +
			//ìˆ˜ì¶œì… í˜„í™©
			//ë‹¨ê°€ë¶„ì„
			"ê³µì¥ì½”ë“œ|null||PO|null||B/L|null||ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê·œê²©|null||ìˆ˜ë¦¬ì¼ì|null||ìì¬ì½”ë“œ|null||ì‹ ê³ ë‹¨ê°€|null||ì‹ ê³ ë‹¨ìœ„|null||ê²°ì œë°©ë²•|null||í•´ì™¸ê±°ë˜ì²˜|null||" +
			"ê²°ì œí†µí™”|null||ì›í™”ë‹¨ê°€|null||ìµœê³ ë‹¨ê°€|null||ìµœì €ë‹¨ê°€|null||í‰ê· ë‹¨ê°€|null||ë‹¨ê°€ì°¨ì´(ìµœê³ )|null||ë‹¨ê°€ì°¨ì´(ìµœì €)|null||ë‹¨ê°€ì°¨ì´(í‰ê· )|null||ë‹¨ê°€ì°¨ì´ ë¹„ìœ¨(ìµœê³ )|null||" +
			"ë‹¨ê°€ì°¨ì´ ë¹„ìœ¨(ìµœì €)|null||ë‹¨ê°€ì°¨ì´ ë¹„ìœ¨(í‰ê· )|null||||ê³µì¥ì½”ë“œ|null||PO|null||B/L|null||ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê·œê²©|null||ìˆ˜ë¦¬ì¼ì|null||ìì¬ì½”ë“œ|null||" +
			"ì‹ ê³ ë‹¨ê°€|null||ì‹ ê³ ë‹¨ìœ„|null||ê²°ì œë°©ë²•|null||í•´ì™¸ê±°ë˜ì²˜|null||ê²°ì œí†µí™”|null||ì›í™”ë‹¨ê°€|null||í‰ê· ë‹¨ê°€|null||||ê³µì¥ì½”ë“œ|null||ìì¬ì½”ë“œ|null||í•´ì™¸ê±°ë˜ì²˜|null||" +
			"ê²°ì œí†µí™”|null||ì‹ ê³ ê±´ìˆ˜|null||ì‹ ê³ ê¸ˆì•¡(ì›í™”)|null||||ìì¬ì½”ë“œ|null||ì„¸ë²ˆë¶€í˜¸|null||ê±°ë˜í’ˆëª…|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€ë²ˆí˜¸|null||ê·œê²©|null||ê´€ì„¸êµ¬ë¶„|null||ê´€ì„¸ìœ¨|null||" +
			"ì›ì‚°ì§€|null||ì ì¶œêµ­|null||ìˆ˜ëŸ‰|null||ê²°ì œê¸ˆì•¡|null||ê²°ì œí†µí™”|null||ì›í™”ê¸ˆì•¡|null||ë‚©ë¶€ê´€ì„¸ì•¡|null||||" +
			//ë‹¨ê°€ë¶„ì„
			//ìˆ˜ì¶œì… ë°ì´í„° ë¶„ì„
			"ìì¬ì½”ë“œ|null||ì„¸ë²ˆë¶€í˜¸|null||ê±°ë˜í’ˆëª…|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||" +
			"ë€ë²ˆí˜¸|null||ê·œê²©|null||ê´€ì„¸êµ¬ë¶„|null||ê´€ì„¸ìœ¨|null||ì›ì‚°ì§€|null||ì ì¶œêµ­|null||ìˆ˜ëŸ‰|null||ê²°ì œê¸ˆì•¡|null||ê²°ì œí†µí™”|null||ì›í™”ê¸ˆì•¡|null||ë‚©ë¶€ê´€ì„¸ì•¡|null||||null|null||" +
			"ê´€ì„¸ê°ë©´ì ìš© ê±´ ìˆ˜|3||ê´€ì„¸ê°ë©´ë¯¸ì ìš© ê±´ ìˆ˜|3||ì´ê´€ì„¸ì•¡|3||ì´ë¶€ê°€ì„¸ì•¡|3||ê´€ì„¸ê°ë©´ì„¸ì•¡|3||ë¶€ê°€ì„¸ê°ë©´ì„¸ì•¡|3|||í•´ì™¸ê±°ë˜ì²˜|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê±°ë˜í’ˆëª…|null||" +
			"ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê±°ë˜í’ˆëª…|null||ê´€ì„¸êµ¬ë¶„|null||ê´€ì„¸ìœ¨|null||ê´€ì„¸ì•¡|null||ë¶€ê°€ì„¸êµ¬ë¶„|null||ë¶€ê°€ì„¸ìœ¨|null||ë¶€ê°€ì„¸ì•¡|null||ê´€ì„¸ê°ë©´ë¶€í˜¸|null||ê´€ì„¸ê°ë©´ìœ¨|null||" +
			"ê´€ì„¸ê°ë©´ì„¸ì•¡|null||ë¶€ê°€ì„¸ê°ë©´ë¶€í˜¸|null||ë¶€ê°€ì„¸ê°ë©´ìœ¨|null||ë¶€ê°€ì„¸ê°ë©´ì„¸ì•¡|null||||ìì¬ì½”ë“œ|null||ìˆ˜ì…ì‹ ê³ ë²ˆí˜¸|null||ë€|null||ê·œê²©|null||HS CODE|null||ì„¸ì¢…|null||ì„¸ìœ¨|null||ì›ì‚°ì§€|null||ì ì¶œêµ­|null||ìˆ˜ì…ì‹ ê³  ìˆ˜ë¦¬ì¼|null";
			//ìˆ˜ì¶œì… ë°ì´í„° ë¶„ì„
	
	exTitDiv = "1|5ë…„ì¹˜_ìˆ˜ì…ì‹¤ì ||2|5ë…„ì¹˜_ìˆ˜ì¶œì‹¤ì ||3|í•´ì™¸ê±°ë˜ì²˜ë³„_ìˆ˜ì…ì‹¤ì ||4|í•´ì™¸ê±°ë˜ì²˜ë³„_ìˆ˜ì¶œì‹¤ì ||5|ìš´ì„_ë¹„êµ||6|ë³´í—˜ë£Œ_ë¹„êµ||7|ì™¸í™˜ì‹ ê³ ëŒ€ìƒ_ìˆ˜ì¶œ||" + //ìˆ˜ì¶œì… í˜„í™©
			   "8|ìˆ˜ì…ë¬¼í’ˆ_ë‹¨ê°€ë¹„êµ||9|ìœ ë¬´ìƒ_ìˆ˜ì…ê±´_ê³¼ì„¸ê°€ê²©_ë¹„êµ||10|ë™ì¼ê±°ë˜,_ê²°ì œí†µí™”_ë³€ê²½ì ê²€||" +  //ë‹¨ê°€ë¶„ì„
			   "11|ë™ì¼ìì¬ì½”ë“œ_í’ˆëª©ë¶„ë¥˜_ìƒì´ì ê²€||12|ë™ì¼ìì¬ì½”ë“œ_ê´€ì„¸êµ¬ë¶„_ìƒì´ì ê²€||13|ê°ë©´_ì ìš©_ì¼ê´€ì„±_ê²€í† ||14|FTA_ì§ì ‘ìš´ì†¡ì›ì¹™"; //ìˆ˜ì¶œì… ë°ì´í„° ë¶„ì„
	
	var date = new Date();
	var month = date.getMonth();
	var dayday = date.getDate();
	var day = date.getDay();
	
	var startDt = new Date();
	startDt.setMonth(startDt.getMonth() - 1);
	startDt.setDate(1);
	
	var endDt = new Date();
	endDt.setMonth(endDt.getMonth(), 1);
	endDt.setDate(endDt.getDate() - 1);
	
	var today = startDt.toISOString().substring(0,10);
	var mtoday = endDt.toISOString().substring(0,10);
	
	$("#importUp_srch2").val(today);
	$("#importUp_srch3").val(mtoday);
	
	var parameters = {exCol : "", exTit: "", exTitDiv: "", exType: "", srch2: "", srch3: "", srch40: ""};
	
	
	parameters.exCol = exCol.replace(/ /g,"_");
	parameters.exTit = exTit.replace(/ /g,"_");
	parameters.exTitDiv = exTitDiv.replace(/ /g,"_");
	parameters.exType = "01";
	parameters.srch2 = today;
	parameters.srch3 = mtoday;
	parameters.srch40 = "TEST";
	
	
	$.ajax({
		 url: "/dashboard/dashDownloadExcel.do",
		 data: parameters,
		 type: 'POST',
		 cache: false,
		 timeout: 200000,
		 xhrFields: {
			 responseType: "blob",
		 },
	    success: function(blob, status, xhr) {
	    	try {
				// check for a filename
				 var fileName = "";
				 var disposition = xhr.getResponseHeader("Content-Disposition");

			       if (disposition && disposition.indexOf("attachment") !== -1) {
			      	 var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
			           var matches = filenameRegex.exec(disposition);

			           if (matches != null && matches[1]) {
			               fileName = decodeURI(matches[1].replace(/['"]/g, ""));
			           }
			       }

			       // for IE
			       if (window.navigator && window.navigator.msSaveOrOpenBlob) {
			           window.navigator.msSaveOrOpenBlob(blob, fileName);
			       } else {
			           var URL = window.URL || window.webkitURL;
			           var downloadUrl = URL.createObjectURL(blob);

			           if (fileName) {
			               var a = document.createElement("a");

			               // for safari
			               if (a.download === undefined) {
			                   window.location.href = downloadUrl;
			               } else {
			                   a.href = downloadUrl;
			                   a.download = fileName;
			                   document.body.appendChild(a);
			                   a.click();
			               }
			           } else {
			               window.location.href = downloadUrl;
			           }
			       }
		       fn_loading(false);
			} catch (e) {
				console.log(e);
				fn_loading(false);
			};
	    },
	    error: function(e, textStatus, errorThrown) {
	    	if(e.status == 400){
	    		alert("Your request is up. Please log back in if you wish continue");
	    		location.href = document.referrer;
	    	} else {
	        	console.log(errorThrown);
	    	}
	    }
	});
	
}

//
document.getElementById("reportAnalysis").addEventListener("click", function(event) {
    event.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
    fn_loading(true);
    // FTAê¸°ì¤€ì¼
    var url = "/rpt/reportAnalysisPdf.do"; // ì„œë²„ ì¸¡ ë§¤í•‘ê³¼ ì¼ì¹˜í•˜ëŠ” URLë¡œ ì„¤ì •
    // ë°ì´í„° êµ¬ì„±
    var sData = {};
    sData["srch8"] = $("#dashbordDate").val();
    console.log("ë‚ ì§œ"+$("#dashbordDate").val());
   
    $.ajax({
		 url: url,
		 data: sData,
		 type: 'GET',
		 dataType : 'json',
		 success: function(response) {
			    console.log("response", response);  
			    exportRptPdf(response); 
			    
			    
			},
	    error: function(e, textStatus, errorThrown) {
	    	if(e.status == 400){
	    		alert("Your request is up. Please log back in if you wish continue");
	    		location.href = document.referrer;
	    	} else {
	        	console.log(errorThrown);
	    	}
	    }
	});
});



function exportRptPdf(data){

	let canvas = "";
	let rightCanvas = "";
	
	let lastYPage1 = 0;
	let lastYPage2 = 0;
	let lastYPage3 = 0;
	let lastYPage4 = 0;
	let lastYPage5 = 0;
	let lastYPage6 = 0;
	let lastYPage7 = 0;
	let lastYPage8 = 0;
	let lastYPage9 = 0;
	let lastYPage10 = 0;
	let lastYPage11 = 0;
	
	
	if (!window.jsPDF) window.jsPDF = window.jspdf.jsPDF;
        var doc = new jsPDF({
            orientation: "portrait",
            unit: "mm",
            format: "a4"
        });
        
        // âœ… í•œê¸€ í°íŠ¸ ì¶”ê°€ (malgun.ttf í•„ìš”)
        doc.addFont('/pf/fonts/NanumSquare.ttf', 'NanumSquare', 'normal');
        doc.setFont('NanumSquare'); // ì‚¬ìš©í•˜ë ¤ëŠ” í°íŠ¸ ì§€ì •
        

        var img = new Image();
        //img.src = '/pf/images/report_2.jpg'; //íŒŒë€
        img.src = '/pf/images/green_report2.jpg'; 
        var logoImg = new Image();
        logoImg.src = '/pf/images/report_4.png';

        img.onload = function () {
        	doc.addFont('/pf/fonts/NanumSquareEB.ttf', 'NanumSquareEB', 'normal');
            console.log("Background image loaded successfully");
            doc.addImage(img, 'JPEG', 0, 0, 210, 297);
            doc.addImage(logoImg, 'PNG', 160, 10, 40, 15);

            doc.setFontSize(22);
            //doc.setTextColor(56, 60, 98); íŒŒë€
            doc.setTextColor(35, 69, 56);
            //doc.text(105, 110, String(data.rptDate1) + 'ë…„ ' + String(data.rptDate2) + 'ì›”', { align: "center" }); íŒŒë€
            doc.text(105, 130, String(data.rptDate1) + 'ë…„ ' + String(data.rptDate2) + 'ì›”', { align: "center" });
            doc.setFontSize(22);
            //doc.text(105, 120, 'í†µê´€ë¦¬í¬íŠ¸', { align: "center" }); íŒŒë€
            doc.text(105, 140, 'í†µê´€ë¦¬í¬íŠ¸', { align: "center" }); 
            doc.setFontSize(30);
            //doc.text(105, 135, String(data.cmpnyInfo), { align: "center" }); íŒŒë€
            doc.text(105, 155, String(data.cmpnyInfo), { align: "center" }); 
            doc.setFontSize(13);
            if (data.cmpnyList && data.cmpnyList.length > 1) {
            	  const companyText = data.cmpnyList.join(', ');
            	  doc.text(105, 250, 'ë¶„ì„ ëŒ€ìƒ íšŒì‚¬ : ' + companyText, { align: "center" });
            }
            doc.text(105, 260, 'ë¶„ì„ ëŒ€ìƒ ê¸°ê°„ : '+String(data.fomateStartDate)+" ~ "+String(data.fomateEndDate), { align: "center" }); 
            doc.text(105, 270, 'ë¦¬í¬íŠ¸ ìƒì„± ì¼ì : '+String(data.today), { align: "center" }); 
            doc.text(105, 280, 'ì‹ í•œê´€ì„¸ë²•ì¸', { align: "center" }); //íŒŒë€
           
            // ëª©ì°¨
            doc.addPage();
            
            const pageHeight13 = doc.internal.pageSize.getHeight();
            const boxMargin13 = 5; // ìœ„ì•„ë˜ ì—¬ë°±

            const boxY13 = boxMargin13;
            const boxHeight13 = pageHeight13 - boxMargin13 * 2;

            
            doc.setLineWidth(1);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
            doc.setDrawColor(35, 69,56); 
            doc.rect(5, boxY13, 200, boxHeight13);  // (x, y, width, height)


           
            const pageWidth = doc.internal.pageSize.getWidth();
            let currentY = 60;

            // === ì œëª© "Contents" ì¤‘ì•™ ì •ë ¬ ë° ìœ„ì•„ë˜ ì‹¤ì„  ===
            const title = "Contents";
            doc.addFont('/pf/fonts/NanumSquareEB.ttf', 'NanumSquareEB', 'normal');
            doc.setFont('NanumSquareEB', 'normal');
            doc.setFontSize(22);
            const titleWidth = doc.getTextWidth(title);
            const centerX = pageWidth / 2;

            // ìœ„ ì„ 
            doc.setLineWidth(0.7);
            doc.line(centerX - titleWidth / 2 - 15, currentY - 9, centerX + titleWidth / 2 + 15, currentY - 9);

            // ì•„ë˜ ì„ 
            doc.line(centerX - titleWidth / 2 - 15, currentY + 4, centerX + titleWidth / 2 + 15, currentY + 4);

            // ì œëª© ì¶œë ¥
            doc.text(title, centerX, currentY, { align: 'center' });
            currentY += 25; // ë‹¤ìŒ ì¤„ë¡œ ì´ë™

            // === ëª©ì°¨ í•­ëª© ì„¤ì • ===
            doc.setFontSize(12);

            const contents = [
              { number: '1', title: 'ìˆ˜ì…í†µê´€í˜„í™©' },
              { number: '2', title: 'ìˆ˜ì…í†µê´€ ì„¸ì•¡í˜„í™©' },
              { number: '3', title: 'ìˆ˜ì…ë¬¼í’ˆ ê³¼ì„¸í˜„í™©' },
              { number: '4', title: 'ìˆ˜ì…ë¬¼í’ˆ ì ìš©ì„¸ìœ¨' },
              { number: '5', title: 'FTA ì‚¬í›„ì ìš©ê¸ˆì•¡' },
              { number: '6', title: 'ì£¼ìš” í•´ì™¸ ê±°ë˜ì²˜(ìˆ˜ì…)' },
              { number: '7', title: 'ìˆ˜ì¶œí†µê´€í˜„í™©' },
              { number: '8', title: 'ì£¼ìš” í•´ì™¸ ê±°ë˜ì²˜(ìˆ˜ì¶œ)' },
              { number: '9', title: 'ìˆ˜ì¶œì… ì •ì • ê·€ì±…ìë³„ ë¹„ìœ¨' },
              { number: '10', title: 'ìˆ˜ì¶œì… ì •í˜•ì¡°ê±´' },
              { number: '11', title: 'ì„¸ê´€ë³„ ì‹ ê³ ê±´ìˆ˜ ë° ê¸ˆì•¡' },
            ];

            // ê° í•­ëª© ì¶œë ¥
            contents.forEach(item => {
              doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
              doc.setFont('NanumSquareB', 'normal');
              doc.text(item.number, 75, currentY);

              doc.setFont('NanumSquareB', 'normal');
              doc.text(item.title, 120, currentY, { align: 'center' });

              currentY += 15;
            });
            
            
            // ğŸŸ¢ ìƒˆë¡œìš´ í˜ì´ì§€ ì¶”ê°€
            doc.addPage();

            // ğŸŸ¢ "ìˆ˜ì…í†µê´€í˜„í™©" ì œëª© ì¶”ê°€
            doc.setFontSize(16);
            doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
            doc.setFont('NanumSquareB', 'normal');
            doc.setTextColor(71, 140, 114); 
            doc.text(8, 15, "1.ìˆ˜ì…í†µê´€í˜„í™©");
            
            // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
            const boxMargin = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
            const boxWidth = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
            const boxHeight = 23;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
            
            doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
            doc.setDrawColor(35, 69,56); 
            doc.rect(5, 8, boxWidth, boxHeight, 'D'); 
            
            
            const reportData1 = data.reportData1;  // data.reportData1ì´ ì œê³µëœë‹¤ê³  ê°€ì •

	            // ë°ì´í„° ë³€í™˜: ê³¼ì„¸ê°€ê²©ì„ í¬ë§¤íŒ…ëœ ê°’ê³¼ ì›ë³¸ ê°’ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì €ì¥
	            const datas = reportData1.map(item => {
	              const amountKrw = parseFloat(item.amountKrw) || 0;  // ì›ë³¸ ê°’
	              const formattedAmountKrw = Intl.NumberFormat("ko-KR").format(amountKrw);  // í¬ë§¤íŒ…ëœ ê°’
	              
	              return [
	                item.lisDay,        // ìˆ˜ë¦¬ì¼ì
	                item.cnt,           // ê±´ìˆ˜
	                formattedAmountKrw, // ê³¼ì„¸ê°€ê²© (í¬ë§¤íŒ…ëœ ê°’)
	                item.txType1,       // ì¼ë°˜ìˆ˜ì…
	                item.txType2,       // ìˆ˜ë¦¬ë¬¼í’ˆ
	                item.txType3,       // ê²¬í’ˆ ë° ê´‘ê³ ìš©í’ˆ
	                item.txType4,       // ê¸°íƒ€ ìˆ˜ì… ìŠ¹ì¸ë©´ì„¸
	                item.txType5,       // ì¬ìˆ˜ì¶œì¡°ê±´
	                item.txPrc1,        // P/L
	                item.txPrc2,        // ì œì¶œì„œë¥˜
	                item.txPrc3,        // ê²€ì‚¬
	              ];
	            });
		        // ğŸŸ¢ ì—´ë³„ í•©ê³„ ê³„ì‚°
	            const defaultColumnCount = 10;
	            const defaultRow = Array(defaultColumnCount).fill("");

	            // datasê°€ ìœ íš¨í•œ ë°°ì—´ì´ê³ , ìµœì†Œí•œ í•˜ë‚˜ ì´ìƒì˜ í–‰ì´ ìˆë‹¤ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³ 
	            // ì•„ë‹ˆë©´ defaultRowë¥¼ ë„£ì–´ì„œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
	            const safeDatas = (Array.isArray(datas) && datas.length > 0)
	              ? datas
	              : [defaultRow];

	            // ì‹¤ì œë¡œ ì‚¬ìš©í•  columnCountëŠ” safeDatasì—ì„œ ê°€ì ¸ì˜¤ë©´ ë¨
	            const columnCount = safeDatas[0].length;
		         const totals = Array(columnCount).fill(0);  // 0ìœ¼ë¡œ ì±„ìš´ í•©ê³„ ë°°ì—´

		         // í•©ê³„ ê³„ì‚° (ì²« ë²ˆì§¸ ì—´ì€ "í•©ê³„" ë¬¸ìì—´ì„ ë„£ê³ , ë‚˜ë¨¸ì§€ëŠ” ìˆ«ì í•©ì‚°)
		         totals[0] = "í•©ê³„"; 
		         for (let i = 1; i < columnCount; i++) {
		        	  // ê³¼ì„¸ê°€ê²©(3ë²ˆì§¸ ì—´)ì„ ì œì™¸í•œ ê°’ë“¤ë§Œ í•©ì‚°
		        	  if (i === 2) {
		        	    totals[i] = datas.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0); // ì›ë³¸ ê°’ìœ¼ë¡œ í•©ê³„ ê³„ì‚°
		        	  } else {
		        	    totals[i] = datas.reduce((sum, row) => sum + (parseFloat(row[i]) || 0), 0);
		        	  }
		        	}

		         // ğŸŸ¢ ë¹„ìœ¨ ê³„ì‚° (ê° ê·¸ë£¹ì„ 100%ë¡œ ì„¤ì •)
		         const percentages = Array(columnCount).fill("-");
		         percentages[0] = "ë¹„ìœ¨(%)"; // ì²« ë²ˆì§¸ ì—´ì€ "ë¹„ìœ¨(%)"

		         // ğŸŸ¢ ìˆ˜ì… ê±°ë˜í˜•íƒœ ë¹„ìœ¨ ê³„ì‚°
		         const tradeTotal = totals.slice(3, 8).reduce((sum, value) => sum + value, 0); // 3~7ë²ˆì§¸ ì—´ í•©ê³„
		         for (let i = 3; i < 8; i++) {
		             percentages[i] = tradeTotal > 0 ? ((totals[i] / tradeTotal) * 100).toFixed(1) + "%" : "-";
		         }

		         // ğŸŸ¢ ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™© ë¹„ìœ¨ ê³„ì‚°
		         const processTotal = totals.slice(8, 11).reduce((sum, value) => sum + value, 0); // 8~10ë²ˆì§¸ ì—´ í•©ê³„
		         for (let i = 8; i < 11; i++) {
		             percentages[i] = processTotal > 0 ? ((totals[i] / processTotal) * 100).toFixed(1) + "%" : "-";
		         }

		         
		     	 // ğŸŸ¢ ìˆ«ì ë°ì´í„° í¬ë§·íŒ… (ì²œ ë‹¨ìœ„ ì½¤ë§ˆ ì¶”ê°€)
		         const formattedTotals = totals.map((value, index) =>
		         typeof value === "number" ? Intl.NumberFormat("ko-KR").format(value) : value
		      	);
		         
		     	// ğŸŸ¢ ê±´ìˆ˜, P/L, ì œì¶œì„œë¥˜, ê²€ì‚¬ ê°€ì ¸ì˜¤ê¸°
		         const countTotal = formattedTotals[1]; // í†µê´€ê±´ìˆ˜
		         const plTotal = formattedTotals[8]; // P/L í•©ê³„
		         const plPercentage = percentages[8]; // P/L ë¹„ìœ¨
		         const submissionTotal = formattedTotals[9]; // ì œì¶œì„œë¥˜ í•©ê³„
		         const submissionPercentage = percentages[9]; // ì œì¶œì„œë¥˜ ë¹„ìœ¨
		         const inspectionTotal = formattedTotals[10]; // ê²€ì‚¬ í•©ê³„
		         const inspectionPercentage = percentages[10]; // ê²€ì‚¬ ë¹„ìœ¨
		            
		            
		            // ğŸŸ¢ ì„¤ëª… ì¶”ê°€ (ì™¼ìª½ ì •ë ¬ + ì¤„ ë‚˜ëˆ„ê¸°)
		            doc.setFontSize(9);
		            doc.addFont('/pf/fonts/NanumSquareR.ttf', 'NanumSquareR', 'normal');
		            doc.setFont('NanumSquareR', 'normal');
		            doc.setTextColor(0, 0, 0);
		            const description = [
		            	`ë‹¤ìŒ ìë£ŒëŠ” ${data.rptDate2}ì›” í•œë‹¬ ìˆ˜ì…í†µê´€ ìë£Œì´ë©° ì´ ${countTotal}ê±´ ìˆ˜ì…ì‹ ê³ ë¥¼ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.`,
		                `ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™©ì€ P/L ${plTotal}ê±´ (${plPercentage}), ì œì¶œ ${submissionTotal}ê±´ (${submissionPercentage}), ê²€ì‚¬ ${inspectionTotal}ê±´ (${inspectionPercentage}) ì…ë‹ˆë‹¤.`
		            ];
		          
		            let startY = 23; // description ë†’ì´ ìœ„ì¹˜
		            description.forEach((line, index) => {
		            	  doc.text(8, startY, line); // ì™¼ìª½ ì •ë ¬ (x: 8, y: startY)
		            	  startY += 5; // ê° ì¤„ ê°„ê²©ì„ 5ë¡œ ì„¤ì •í•˜ì—¬ ë‹¤ìŒ ì¤„ë¡œ ë‚´ë ¤ê°
		        	});
		         
		      // ğŸŸ¢ datasì— í•©ê³„ì™€ ë¹„ìœ¨ í–‰ ì¶”ê°€
		         datas.push(formattedTotals);
		         datas.push(percentages);
		         
            	// í…Œì´ë¸” í—¤ë”
		       const header = [
		    	   	[ 
		    		    { content: 'ìˆ˜ë¦¬ì¼ì', rowSpan: 2, border: [true, true, true, true] },  // ìˆ˜ë¦¬ì¼ì ì…€ì— í…Œë‘ë¦¬ ì¶”ê°€
		    		    { content: 'ê±´ìˆ˜', rowSpan: 2, border: [true, true, true, true] },
		    		    { content: 'ê³¼ì„¸ê°€ê²©(KRW)', rowSpan: 2, border: [true, true, true, true] },
		    		    { content: 'ìˆ˜ì… ê±°ë˜í˜•íƒœ í˜„í™©', colSpan: 5, border: [true, true, true, true] },  // ìˆ˜ì… ê±°ë˜í˜•íƒœ í˜„í™© ì…€ì— í…Œë‘ë¦¬ ì¶”ê°€
		    		    { content: 'ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™©', colSpan: 3, border: [true, true, true, true] },  // ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™© ì…€ì— í…Œë‘ë¦¬ ì¶”ê°€
		    		  ],  // ì²« ë²ˆì§¸ í–‰
		    		  [
		    		    { content: 'ì¼ë°˜ìˆ˜ì…', border: [true, true, true, true] },
		    		    { content: 'ìˆ˜ë¦¬ë¬¼í’ˆ', border: [true, true, true, true] },
		    		    { content: 'ê²¬í’ˆ ë° ê´‘ê³ ìš©í’ˆ', border: [true, true, true, true] },
		    		    { content: 'ê¸°íƒ€ ìˆ˜ì… ìŠ¹ì¸ë©´ì„¸', border: [true, true, true, true] },
		    		    { content: 'ì¬ìˆ˜ì¶œì¡°ê±´', border: [true, true, true, true] },
		    		    { content: 'P/L', border: [true, true, true, true] },
		    		    { content: 'ì œì¶œì„œë¥˜', border: [true, true, true, true] },
		    		    { content: 'ê²€ì‚¬', border: [true, true, true, true] },
		    		  ]
		    	 ];
		       
		       
            	// ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
            	doc.autoTable({
            	  head: header,
            	  body:datas,
            	  startY: startY + 2, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    halign: 'center',
            	    overflow: 'linebreak', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ì ìš©
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
            	  },
            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
            	  columnStyles: {
            		  	0: { halign: 'center' , cellWidth: 23 }, // ìˆ˜ë¦¬ì¼ì
            	        1: { halign: 'right' , cellWidth: 18}, // ê±´ìˆ˜
            	        2: { halign: 'right' , cellWidth: 23}, // ê³¼ì„¸ê°€ê²©
            	        3: { halign: 'center' , cellWidth: 17}, // ì¼ë°˜ìˆ˜ì…
            	        4: { halign: 'center' , cellWidth: 17}, // ìˆ˜ë¦¬ë¬¼í’ˆ
            	        5: { halign: 'center' , cellWidth: 17}, // ê²¬í’ˆ ë° ê´‘ê³ ìš©í’ˆ
            	        6: { halign: 'center' , cellWidth: 17}, // ê¸°íƒ€ ìˆ˜ì… ìŠ¹ì¸ë©´ì„¸
            	        7: { halign: 'center' , cellWidth: 17}, // ì¬ìˆ˜ì¶œì¡°ê±´
            	        8: { halign: 'center' , cellWidth: 17 }, // P/L
            	        9: { halign: 'center' , cellWidth: 17}, // ì œì¶œì„œë¥˜
            	        10: { halign: 'center' , cellWidth: 17}, // ê²€ì‚¬
            	  },
            	  didParseCell: function(data) {
            		    // ğŸŸ¢ í•©ê³„ í–‰ ìŠ¤íƒ€ì¼ ì ìš© (ë§ˆì§€ë§‰ì—ì„œ ë‘ ë²ˆì§¸ í–‰)
            		    if (data.row.index === datas.length - 2) {
            		      data.cell.styles.fillColor = [246, 243, 202]; // ë°°ê²½
          	              data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
          	              data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
            		    }
            		    // ğŸŸ¢ ë¹„ìœ¨ í–‰ ìŠ¤íƒ€ì¼ ì ìš© (ë§ˆì§€ë§‰ í–‰)
            		    if (data.row.index === datas.length - 1) {
            		    	data.cell.styles.fillColor = [246, 243, 202]; // ë°°ê²½
            	            data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
            	            data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
            		    }
            		  }
        		});
            	
            	// 1ë²ˆì§¸ í…Œì´ë¸” yì¢Œí‘œ ì €ì¥ 
            	let lastY1 = doc.lastAutoTable.finalY;
            	let page1 = doc.internal.getCurrentPageInfo().pageNumber;
            	let spaceLeft1 = doc.internal.pageSize.height - lastY1 - 10;
            	let chartPage1, chartY1;
            	
            	if (spaceLeft1 < 70) {
            		  doc.addPage(); // ê·¸ëƒ¥ ë’¤ì— ì¶”ê°€
            		  chartPage1 = page1 + 1;
            		  chartY1 = 15;
            		} else {
            		  chartPage1 = page1;
            		  chartY1 = lastY1 + 10;
            		}
            	
            	//í”ŒëŸ¬ê·¸ì¸ ë“±ë¡
            	Chart.register(ChartDataLabels);
            	
            	
            	// ê±°ë˜í˜•íƒœ 
            	// ë°ì´í„° ë³€í™˜ (NaN ë°©ì§€)
            	const safeParse = (value) => {
            	    let num = parseFloat(value ? value.replace('%', '') : 0);
            	    return isNaN(num) ? 0 : num;
            	};

            	// ì™¼ìª½ ì°¨íŠ¸ ë°ì´í„° ë³€í™˜
            	const leftChartData = percentages.slice(3, 8).map(safeParse);
            	
            	// ì™¼ìª½ ì°¨íŠ¸ ìº”ë²„ìŠ¤ ìƒì„±
            	canvas = document.createElement('canvas');
            	const ctx = canvas.getContext('2d');
            	canvas.width = 500;
            	canvas.height = 500;

            	
            	var chartDataLabels2 = {
            		    id: 'chartDataLabels',
            		    afterDraw(chart, args, options) {
            		        const ctx2 = chart.ctx; // ì˜¬ë°”ë¥¸ ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©
            		        ctx2.textAlign = "center";
            		        ctx2.textBaseline = "middle";
            		        ctx2.fillStyle = '#000';
            		        ctx2.font = "21px NanumSquareB";
            		        ctx2.lineWidth = 2; // ì„  êµµê¸°

            		        let prevTextPositions2 = [];  // í…ìŠ¤íŠ¸ ìœ„ì¹˜ë¥¼ ì¶”ì í•  ë°°ì—´

            		        chart.data.datasets.forEach((dataset, i) => {
            		        	  chart.getDatasetMeta(i).data.forEach((datapoint, index) => {
            		                  const value = dataset.data[index]; // ë°ì´í„° ê°’
            		                  const label = chart.data.labels[index]; // í•´ë‹¹ ë°ì´í„°ì˜ ë¼ë²¨
            		                  const formattedText = `${label} : ${value}%`; // ì›í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ë¼ë²¨ ë§Œë“¤ê¸°

            		                  if (value <= 1) return; // 1% ì´í•˜ ê°’ì€ í‘œì‹œ ì•ˆ í•¨

            		                const { x, y } = datapoint.tooltipPosition(); // ë°ì´í„° ì¢Œí‘œ ê°€ì ¸ì˜¤ê¸°
            		                const radius2 = chart.outerRadius || (chart.chartArea.width / 2); // ì›ì˜ ë°˜ì§€ë¦„
            		                const angle2 = datapoint.startAngle !== undefined && datapoint.endAngle !== undefined
            		                    ? (datapoint.startAngle + datapoint.endAngle) / 2
            		                    : (index / dataset.data.length) * Math.PI * 2; // ê°ë„ ê³„ì‚°

            		                // ì› ë°”ê¹¥ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì¢Œí‘œ (ì¡°ì •)
            		                const xOuter2 = x + (radius2 * 0) * Math.cos(angle2);  // 0.6ìœ¼ë¡œ ê°’ ë³€ê²½í•˜ì—¬ ì›ì˜ ë°”ê¹¥ìª½ìœ¼ë¡œ
            		                const yOuter2 = y + (radius2 * 0) * Math.sin(angle2);  // 0.6ìœ¼ë¡œ ê°’ ë³€ê²½í•˜ì—¬ ì›ì˜ ë°”ê¹¥ìª½ìœ¼ë¡œ

            		                // êº¾ì¸ ì§€ì  ì´í›„, ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ ì„¤ì •
            		                const xMiddle2 = xOuter2 + (Math.cos(angle2) * 10);  // 30ìœ¼ë¡œ ê°’ ëŠ˜ë ¤ ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ
            		                const yMiddle2 = yOuter2 + (Math.sin(angle2) * 10);  // 30ìœ¼ë¡œ ê°’ ëŠ˜ë ¤ ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ

            		                // ìµœì¢… ë¼ë²¨ ìœ„ì¹˜ (ê¸¸ì´ë¥¼ ë” ë©€ë¦¬ ì„¤ì •)
            		                let xLine2 = xMiddle2 + (Math.cos(angle2) > 0 ? 10 : -10); // í…ìŠ¤íŠ¸ ìµœì¢… ìœ„ì¹˜ë„ ë” ë©€ë¦¬
            		                let yLine2 = yMiddle2;

            		                // í…ìŠ¤íŠ¸ ê°„ì˜ ìµœì†Œ ê±°ë¦¬ (ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ì¡°ì •)
            		                const minDistance2 = 30;  // ìµœì†Œ ê°„ê²© ì„¤ì •

            		                // í…ìŠ¤íŠ¸ê°€ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ê°„ê²© ì¡°ì •
            		                prevTextPositions2.forEach((prevPos) => {
            		                    let attempts = 0;
            		                    while (Math.abs(yLine2 - prevPos.y) < minDistance2 && attempts < 5) { 
            		                        yLine2 += (Math.sin(angle2) > 0 ? 10 : -10); // ìœ„ì•„ë˜ë¡œ ì¡°ì •
            		                        attempts++;
            		                    }
            		                });
            		                // í…ìŠ¤íŠ¸ ìœ„ì¹˜ë¥¼ ì´ì „ ìœ„ì¹˜ ë°°ì—´ì— ì¶”ê°€
            		                prevTextPositions2.push({ x: xLine2, y: yLine2 });

            		                // ìº”ë²„ìŠ¤ì— êº¾ì€ì„  ê·¸ë¦¬ê¸°
            		                ctx2.beginPath();
            		                ctx2.moveTo(xOuter2, yOuter2); // ì› í…Œë‘ë¦¬ì—ì„œ ì‹œì‘
            		                ctx2.lineTo(xMiddle2, yMiddle2); // êº¾ì¸ ì§€ì 
            		                ctx2.lineTo(xLine2, yLine2); // ìµœì¢… ìœ„ì¹˜
            		                ctx2.strokeStyle = 'rgba(129,212,250,0.9)';
            		                ctx2.stroke();

            		                // í…ìŠ¤íŠ¸ ì •ë ¬
            		                ctx2.textAlign = Math.cos(angle2) > 0 ? "left" : "right";

            		                // í…ìŠ¤íŠ¸ í‘œì‹œ
            		                ctx2.fillText(formattedText, xLine2, yLine2);
            		            });
            		        });
            		    }
            		};
            	
            	
            	// ì™¼ìª½ ì°¨íŠ¸ ìƒì„±
            	const chart = new Chart(ctx, {
            		plugins : [chartDataLabels2],
            		type: 'pie',
            	    data: {
            	        labels: ['ì¼ë°˜ìˆ˜ì…', 'ìˆ˜ë¦¬ë¬¼í’ˆ', 'ê²¬í’ˆ,ê´‘ê³ ìš©í’ˆ', 'ê¸°íƒ€ìˆ˜ì…', 'ì¬ìˆ˜ì¶œ'],
            	        datasets: [{
            	            data: leftChartData,
            	            backgroundColor: [  'rgb(113,162, 218)',
				            	            	'rgb(48,123,202)', 
				            	            	'rgb(166,196,232)',
				            	            	'rgb(216,225,234)',
				            	            	'rgb(40,101,168)']
	            	        }]
			            	/* backgroundColor: [  
			            		'rgb(71,140,114)',
			            		'rgb(49,97,79)', 
			 	            	'rgb(84,166, 135)', 
			 	            	'rgb(186,221,139)',
			 	            	'rgb(231,244,218)']
            	    		}]*///ê·¸ë¦°
		            	
            	    },
            	    options: {
            	        responsive: false,
            	        maintainAspectRatio: false,  // ë¹„ìœ¨ ìœ ì§€ í•´ì œ
            	        layout: {
            	            padding: {
            	                bottom: 20, // ì°¨íŠ¸ í•˜ë‹¨ ì—¬ë°± (ë¼ë²¨ ê³µê°„ í™•ë³´)
            	                right : 70,
            	                left : 70
            	            }
            	        },
            	        plugins: {
            	        	datalabels: { 
            	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
            	            },
            	            legend: {
            	                position: 'bottom',
            	                fullWidth: true,
            	                labels: {
            	                    font: {
            	                        size: 18  // ë¼ë²¨ í¬ê¸° ë™ì¼
            	                        ,weight: 'bold'
            	                    },
            	                    boxWidth: 15,  // ì•„ì´ì½˜ í¬ê¸° ë™ì¼
            	                    padding: 15
            	                }
            	            },
            	            title: {
            	                display: true,
            	                text: 'ê±°ë˜í˜•íƒœ',
            	                font: {
            	                    size: 28,  // ì œëª© í¬ê¸° ë™ì¼
            	                    weight: 'bold'},
            	                padding: {
            	                    bottom: 20
            	                }
            	            }
            	        }
            	    }
            	});
            	
            	
            	// ì˜¤ë¥¸ìª½ ì°¨íŠ¸ (ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™© ë¹„ìœ¨)
            	const rightChartData = [
            	    parseFloat(percentages[8].replace('%', '')) || 0, 
            	    parseFloat(percentages[9].replace('%', '')) || 0, 
            	    parseFloat(percentages[10].replace('%', '')) || 0 
            	];
            	
            	
            	// ì˜¤ë¥¸ìª½ ì°¨íŠ¸ ìº”ë²„ìŠ¤ ìƒì„±
            	rightCanvas = document.createElement('canvas');
            	const rightCtx = rightCanvas.getContext('2d');
            	rightCanvas.width = 500;
            	rightCanvas.height = 500;

            	// ì˜¤ë¥¸ìª½ ì°¨íŠ¸ ìƒì„±
            	const rightChart = new Chart(rightCtx, {
            		plugins : [chartDataLabels2],
            		type: 'pie',
            	    data: {
            	        labels: ['P/L', 'ì œì¶œì„œë¥˜', 'ê²€ì‚¬'],
            	        datasets: [{
            	            data: rightChartData,
            	            backgroundColor: [  'rgb(48,123,202)', 				            	             
				            	            	'rgb(113,162, 218)', 
				            	            	'rgb(166,196,232)']
            	        }]
            	            /*backgroundColor: [  
            	            	'rgb(49,97,79)', 
			 	            	'rgb(84,166, 135)', 
			 	            	'rgb(186,221,139)']
        	        		}]*/ //ê·¸ë¦°
            	    },
            	    options: {
            	        responsive: false,
            	        maintainAspectRatio: false,  
            	        layout: {
            	            padding: {
            	                bottom: 70, // ì•„ë˜ìª½ ì—¬ë°± ì¶”ê°€
            	                left: 90,  // ì™¼ìª½ ì—¬ë°± ì¶”ê°€
            	                right: 90  // ì˜¤ë¥¸ìª½ ì—¬ë°± ì¶”ê°€
            	            }
            	        },
            	        plugins: {
            	        	datalabels: {
             	                color: 'rgb(89,89,89)',
             	                formatter: function(value, context) {
             	                	let label = context.chart.data.labels[context.dataIndex];
             	                   if (value < 10) {  // ê°’ì´ 10% ë¯¸ë§Œì¸ ê²½ìš° ë¼ë²¨ì„ í‘œì‹œí•˜ì§€ ì•ŠìŒ
             	                       return null;  
             	                   }
             	                    return label + " : " +value + "%"; // ë¼ë²¨ê³¼ í¼ì„¼íŠ¸ í‘œì‹œ
             	                },
             	                font: {
             	                    size: 20,
             	                    weight : 'bold'
             	                },
            	        	}, 
            	        	datalabels: { 
           	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
            	        	},
            	        	legend: {
            	                position: 'bottom',
            	                fullWidth: true,
            	                labels: {
            	                    font: {
            	                        size: 18  // ë¼ë²¨ í¬ê¸° ë™ì¼
            	                        ,weight: 'bold'
            	                    },
            	                    boxWidth: 15,  // ì•„ì´ì½˜ í¬ê¸° ë™ì¼
            	                    padding: 15
            	                }
            	            },
            	            title: {
            	                display: true,
            	                text: 'ì‹ ê³ ì²˜ë¦¬',
            	                font: {
            	                    size: 28,  // ì œëª© í¬ê¸° ë™ì¼
            	                    weight: 'bold'
            	                },
            	                padding: {
            	                    bottom: 10
            	                }
            	            }
            	        }
            	    }
            	});
            	
            	// ğŸŸ¢ ìƒˆë¡œìš´ í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                // ğŸŸ¢ "ìˆ˜ì…í†µê´€ ì„¸ì•¡í˜„í™©" ì œëª© ì¶”ê°€
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "2.ìˆ˜ì…í†µê´€ ì„¸ì•¡í˜„í™©");
                
                // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                const boxMargin2 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                const boxWidth2 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                const boxHeight2 = 18;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                
                doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth2, boxHeight2, 'D'); 
	            
                const reportData2 = data.reportData2;
                console.log("reportData2",reportData2);
                const datas2 = reportData2.map(item => {
  	              const formattedCntImp = Intl.NumberFormat("ko-KR").format(item.cntImp);
  	              const formattedTotGs = Intl.NumberFormat("ko-KR").format(item.totGs);
  	              const formattedTotVat= Intl.NumberFormat("ko-KR").format(item.totVat);
  	              const formattedTotTs = Intl.NumberFormat("ko-KR").format(item.totTs);  
  	              const formattedTotGt = Intl.NumberFormat("ko-KR").format(item.totGt); 
  	              const formattedTotHof = Intl.NumberFormat("ko-KR").format(item.totHof); 
  	              const formattedTotKy = Intl.NumberFormat("ko-KR").format(item.totKy); 
  	              const formattedTotNt = Intl.NumberFormat("ko-KR").format(item.totNt); 
  	              const formattedTotDlyTax = Intl.NumberFormat("ko-KR").format(item.totDlyTax); 
  	              const formattedTotAddTax = Intl.NumberFormat("ko-KR").format(item.totAddTax); 
  	              const formattedTotTaxSum = Intl.NumberFormat("ko-KR").format(item.totTaxSum); 
  	              
  	              return [
  	                item.lisDay,        		// ìˆ˜ë¦¬ì¼ì
  	                formattedCntImp,			// ê±´ìˆ˜
  	                formattedTotGs, 			//ê´€ì„¸
  	                formattedTotVat,      	 	// ë¶€ê°€ì„¸
  	                formattedTotTs,       		// ê°œì†Œì„¸
  	               /* formattedTotGt,       		// êµí†µì„¸
  	                formattedTotHof,       	// ì£¼ì„¸*/
  	                formattedTotKy,       		// êµã„´ìœ¡ì„¸
  	                formattedTotNt,        	// ë†íŠ¹ì„¸
  	                formattedTotDlyTax,        	// ì‹ ê³ ì§€ì—°ê°€ì‚°ì„¸
  	                formattedTotAddTax,        // ë¯¸ì‹ ê³ ê°€ì‚°ì„¸
  	                formattedTotTaxSum,        // ì´ì„¸ì•¡
  	              ];
  	            });
                
                const defaultColumnCount2 = 9;
	            const defaultRow2 = Array(defaultColumnCount2).fill("");

	            // datasê°€ ìœ íš¨í•œ ë°°ì—´ì´ê³ , ìµœì†Œí•œ í•˜ë‚˜ ì´ìƒì˜ í–‰ì´ ìˆë‹¤ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³ 
	            // ì•„ë‹ˆë©´ defaultRowë¥¼ ë„£ì–´ì„œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
	            const safeDatas2 = (Array.isArray(datas2) && datas2.length > 0)
	              ? datas2
	              : [defaultRow2];

                // ğŸŸ¢ ì—´ë³„ í•©ê³„ ê³„ì‚°
                 const columnCount2 = safeDatas2[0].length;  // ì—´ ê°œìˆ˜
		         const totals2 = Array(columnCount2).fill(0);  // 0ìœ¼ë¡œ ì±„ìš´ í•©ê³„ ë°°ì—´

		         // í•©ê³„ ê³„ì‚° (ì²« ë²ˆì§¸ ì—´ì€ "í•©ê³„" ë¬¸ìì—´ì„ ë„£ê³ , ë‚˜ë¨¸ì§€ëŠ” ìˆ«ì í•©ì‚°)
		         totals2[0] = "í•©ê³„"; 
		         for (let i = 1; i < columnCount2; i++) {
		        	    // ì‰¼í‘œ(,)ë¥¼ ì œê±°í•œ í›„ ìˆ«ìë¡œ ë³€í™˜í•˜ì—¬ í•©ì‚°
		        	    totals2[i] = datas2.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0);

		        	    // í•©ê³„ë¥¼ ë‹¤ì‹œ í•œêµ­ì–´ ìˆ«ì í¬ë§·(ko-KR)ìœ¼ë¡œ ë³€í™˜
		        	    totals2[i] = Intl.NumberFormat("ko-KR").format(totals2[i]);
		         }
		         
		         
		         // ê´€ì„¸ ë¶€ê°€ì„¸ ì„¸ì•¡í•©ê³„ 
		         var gsTot = totals2[2]; //ê´€ì„¸
		         var vatTot = totals2[3]; //ë¶€ê³¼ì„¸
		         var taxSumTot = totals2[9]; //ì´ì„¸ì•¡
		         
  		        
                // ğŸŸ¢ ì„¤ëª… ì¶”ê°€ (ì™¼ìª½ ì •ë ¬ + ì¤„ ë‚˜ëˆ„ê¸°)
	            doc.setFontSize(9);
	            doc.addFont('/pf/fonts/NanumSquareR.ttf', 'NanumSquareR', 'normal');
	            doc.setFont('NanumSquareR', 'normal');
	            doc.setTextColor(0, 0, 0);
	            const description2 = [
	            	` ${data.rptDate2}ì›” í†µê´€ ê´€ì„¸ëŠ”${gsTot}ì›, ë¶€ê°€ì„¸ëŠ” ${vatTot}ì› ì´ë©° ì´ì„¸ì•¡í•©ê³„ëŠ”${taxSumTot}ì›ì…ë‹ˆë‹¤.`
	            ];
	          
	             startY = 23; // description ë†’ì´ ìœ„ì¹˜
	            description2.forEach((line, index) => {
	            	  doc.text(8, startY, line); // ì™¼ìª½ ì •ë ¬ (x: 8, y: startY)
	            	  startY += 5; // ê° ì¤„ ê°„ê²©ì„ 5ë¡œ ì„¤ì •í•˜ì—¬ ë‹¤ìŒ ì¤„ë¡œ ë‚´ë ¤ê°
	        	});
	        	// í…Œì´ë¸” í—¤ë”
			      var header2 = [[
			    	    'ìˆ˜ë¦¬ì¼ì', 'ê±´ìˆ˜', 'ê´€ì„¸','ë¶€ê°€ì„¸' ,'ê°œì†Œì„¸', /*'êµí†µì„¸', 'ì£¼ì„¸', */
			    	    'êµìœ¡ì„¸', 'ë†íŠ¹ì„¸', 'ì‹ ê³ ì§€ì—°ê°€ì‚°ì„¸', 'ë¯¸ì‹ ê³ ê°€ì‚°ì„¸', 'ì´ì„¸ì•¡'
			    	]];
			        
			   datas2.push(totals2);
			        
			     
			   doc.setPage(chartPage1 === page1 ? page1 + 1 : chartPage1 + 1);
			   // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
	            	doc.autoTable({
	            	  head: header2,
	            	  body:datas2,
	            	  startY: startY + 2, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
	            	  theme: 'grid',
	            	  styles: {
	            	    font: 'NanumSquareR',
	            	    fontSize: 7,
	            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
	            	    textColor: [0, 0, 0],
	            	    valign: 'middle',
	            	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
	                    wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
	            	  },
	            	  headStyles: {
	            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
	            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
	            	    fontSize: 8,
	            	    textColor: [255, 255, 255],
	            	    font: 'NanumSquareEB',
	            	    fontStyle: 'bold',
	            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
	            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
	            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
	            	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
	                    wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
	                    halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
	            	  },
	            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
	            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
	            	  columnStyles: {
	            		  	0: { halign: 'center'}, // ìˆ˜ë¦¬ì¼ì
	            	        1: { halign: 'center'}, // ê±´ìˆ˜
	            	        2: { halign: 'right'}, // ê´€ì„¸
	            	        3: { halign: 'right'}, // ë¶€ê°€ì„¸
	            	        4: { halign: 'right'}, // íŠ¹ì†Œì„¸
	            	        5: { halign: 'right'}, // êµí†µì„¸
	            	        6: { halign: 'right'}, // ì£¼ì„¸
	            	        7: { halign: 'right'}, // êµìœ¡ì„¸
	            	        8: { halign: 'right'}, // ë†íŠ¹ì„¸
	            	        9: { halign: 'right'}, // ì‹ ê³ ì§€ì—°ê°€ì‚°ì„¸
	            	        10: { halign: 'right'}, // ë¯¸ì‹ ê³ ê°€ì‚°ì„¸
	            	        11: { halign: 'right'}, // ì´ì„¸ì•¡
	            	  },
	            	  didParseCell: function (data) {
	            	        // ğŸŸ¡ ë§ˆì§€ë§‰ í–‰ (í•©ê³„ í–‰)ë§Œ ë°°ê²½ìƒ‰ ë³€ê²½
	            	        if (data.row.index === datas2.length - 1) {
	            	            data.cell.styles.fillColor = [246, 243, 202]; // ì—°í•œ íšŒìƒ‰ ë°°ê²½
	            	            data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
	            	            data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
	            	        }
	            	    }
	        		});
	            	
	            	let lastY2 = doc.lastAutoTable.finalY;
	            	let page2 = doc.internal.getCurrentPageInfo().pageNumber;
	            	let spaceLeft2 = doc.internal.pageSize.height - lastY2 - 10;
	            	let chartPage2, chartY2;

	            	if (spaceLeft2 < 85) {
	            	  doc.addPage();
	            	  chartPage2 = page2 + 1;
	            	  chartY2 = 15;
	            	} else {
	            	  chartPage2 = page2;
	            	  chartY2 = lastY2 + 10;
	            	}
	            	
	            	
	            	const reportData3 = data.reportData3;
	                console.log("reportData3",reportData3);
	                
	                // ì²« ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ `lisDay`ì—ì„œ ë…„ë„ë§Œ ì¶”ì¶œ
	                const firstYear = reportData3[0].lisDay.substring(0, 4);  // ì²« ë²ˆì§¸ ìš”ì†Œì—ì„œ '202401' -> '2024'
	                const lastYear = reportData3[reportData3.length - 1].lisDay.substring(0, 4);  // ë§ˆì§€ë§‰ ìš”ì†Œì—ì„œ '202503' -> '2025'
	                
	                const firstYearData = [];
	                const lastYearData = [];

	                reportData3.forEach(item => {
	                  const year = item.lisDay.substring(0, 4);  // '202401' -> '2024', '202502' -> '2025'
	                  if (year === firstYear) {
	                    // ì „ë…„ë„
	                    firstYearData.push(item.cntImp);  // cntImp ê°’ì„ ë„£ìŒ
	                  } else if (year === lastYear) {
	                	// ì˜¬í•´
	                    lastYearData.push(item.cntImp);  // cntImp ê°’ì„ ë„£ìŒ
	                  }
	                });
	                
	                // ì²« ë²ˆì§¸ì™€ ë‘ ë²ˆì§¸ ë°°ì—´ì—ì„œ ê°€ì¥ í° ê°’ ì¶”ì¶œ
	                const maxFirstYearData = Math.max(...firstYearData);
	                const maxLastYearData = Math.max(...lastYearData);

	                // ë‘ ë°°ì—´ì—ì„œ ê°€ì¥ í° ê°’ ì¤‘ ë” í° ê°’ì„ ì„ íƒ
	                const maxValue = Math.max(maxFirstYearData, maxLastYearData) + 30;  // ê°€ì¥ í° ê°’ì— 30ì„ ë”í•¨

	                
	                // ì°¨íŠ¸ ë°ì´í„° (ì „ë…„ë„ì™€ ì˜¬í•´ ë°ì´í„°)
	            	const barChartData = {
	            	    labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'],
	            	    datasets: [
	            	        {
	            	            label: `${firstYear}ë…„`, // ì „ë…„ë„
	            	            backgroundColor: 'rgba(75, 192, 192, 0.2)', // ì—°ë„ë³„ ìƒ‰ìƒ
	            	            borderColor: 'rgba(75, 192, 192, 1)',
	            	            borderWidth: 1,
	            	            data: firstYearData // ì „ë…„ë„ ë°ì´í„°
	            	        },
	            	        {
	            	            label: `${lastYear}ë…„`, // ì˜¬í•´
	            	            backgroundColor: 'rgba(255, 99, 132, 0.2)', // ì—°ë„ë³„ ìƒ‰ìƒ
	            	            borderColor: 'rgba(255, 99, 132, 1)',
	            	            borderWidth: 1,
	            	            data: lastYearData // ì˜¬í•´ ë°ì´í„°
	            	        }
	            	    ]
	            	};
            	
	                
	                
	                //ì „ë…„ ë™ì›” ëŒ€ë¹„ ê±´ìˆ˜ ë¹„êµ ì°¨íŠ¸ 
	            	//  ìº”ë²„ìŠ¤ ìƒì„±
		            const pdf2canvas = document.createElement('canvas');
	            	const pdf2ctx = pdf2canvas.getContext('2d');
	            	pdf2canvas.width = 450;
	            	pdf2canvas.height = 210;
	            	// ìº”ë²„ìŠ¤ë¥¼ í™”ë©´ì— ë³´ì´ì§€ ì•Šë„ë¡ ìˆ¨ê¹€ ì²˜ë¦¬
	            	pdf2canvas.style.display = 'none'; // ì›¹ í™”ë©´ì—ì„œ ìˆ¨ê¹€ ì²˜ë¦¬
	            	
	            	document.body.appendChild(pdf2canvas);  // ìº”ë²„ìŠ¤ë¥¼ DOMì— ì¶”ê°€ (ì°¨íŠ¸ê°€ ë³´ì´ë„ë¡)
	                
	               
            	const pdf2chart = new Chart(pdf2ctx, {
            		  type: 'bar',
            		  data: barChartData,
            		  options: {
            		    responsive: true,
            		    scales: {
            		    	x: {
            	                ticks: {
            	                    font: {
            	                        size: 18, // xì¶• í°íŠ¸ í¬ê¸°
            	                        //weight: 'bold' // xì¶• í°íŠ¸ ë‘ê»˜
            	                    }
            	                }
            	            },
            	            y: {
            	                ticks: {
            	                    beginAtZero: true, // yì¶•ì´ 0ë¶€í„° ì‹œì‘
            	                    max: maxValue, // yì¶• ìµœëŒ€ê°’ ì„¤ì •
            	                    font: {
            	                        size: 18, // yì¶• í°íŠ¸ í¬ê¸°
            	                        //weight: 'bold' // yì¶• í°íŠ¸ ë‘ê»˜
            	                    }
            	                }
            	            }
            	        },
            		    plugins: {
            		    	legend: {
            	                position: 'bottom',
            	                fullWidth: true,
            	                labels: {
            	                    font: {
            	                        size: 20  // ë¼ë²¨ í¬ê¸° ë™ì¼
            	                        ,weight: 'bold'
            	                    },
            	                    boxWidth: 20,  // ì•„ì´ì½˜ í¬ê¸° ë™ì¼
            	                    padding: 20
            	                }
            	            },
            		      title: {
          	                display: true,
          	                text: 'ì „ë…„ ë™ì›” ëŒ€ë¹„ ê±´ìˆ˜ ë¹„êµ',
          	                font: {
          	                    size: 28,  // ì œëª© í¬ê¸° ë™ì¼
          	                    weight: 'bold'},
          	                padding: {
          	                    bottom: 10
          	                }
          	              }
            		    },
            		  }
            		});
            	
            	// ğŸŸ¢ 4ë²ˆì§¸ í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "3.ìˆ˜ì…ë¬¼í’ˆ ê³¼ì„¸í˜„í™©");
                
                // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                const boxMargin3 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                const boxWidth3 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                const boxHeight3 = 28;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                
                doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth3, boxHeight3, 'D'); 
                
                
                const reportData4 = data.reportData4;
                console.log("reportData4",reportData4);
                const datas3 = reportData4.map(item => {
  	              const formattedTaxKrw = Intl.NumberFormat("ko-KR").format(item.taxKrw); 
  	              const formattedGs = Intl.NumberFormat("ko-KR").format(item.gs); 
  	              
  	              return [
  	                item.rowNum,        // ìˆœë²ˆ
  	                item.hs,            // hscode
  	                item.gsDivi,        // ê´€ì„¸êµ¬ë¶„
  	                item.excGname, 		// í’ˆëª…
  	                item.gsRate,       	// ê´€ì„¸ìœ¨
  	                formattedTaxKrw,	// ê³¼ì„¸ê°€ê²©
  	                formattedGs			// ê´€ì„¸ì•¡
  	              ];
  	            });
                
                const defaultColumnCount3 = 7;
	            const defaultRow3 = Array(defaultColumnCount3).fill("");

	            // datasê°€ ìœ íš¨í•œ ë°°ì—´ì´ê³ , ìµœì†Œí•œ í•˜ë‚˜ ì´ìƒì˜ í–‰ì´ ìˆë‹¤ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³ 
	            // ì•„ë‹ˆë©´ defaultRowë¥¼ ë„£ì–´ì„œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
	            const safeDatas3 = (Array.isArray(datas3) && datas3.length > 0)
	              ? datas3
	              : [defaultRow3];

                //ì—´ë³„ í•©ê³„
                 const columnCount3 = safeDatas3[0].length;  // ì—´ ê°œìˆ˜
		         const totals3 = Array(columnCount3).fill("");  // 0ìœ¼ë¡œ ì±„ìš´ í•©ê³„ ë°°ì—´
		         
		         
		         totals3[0] = "í•©ê³„"; 
		         for (let i = 5; i < columnCount3; i++) {
		        	    // ì‰¼í‘œ(,)ë¥¼ ì œê±°í•œ í›„ ìˆ«ìë¡œ ë³€í™˜í•˜ì—¬ í•©ì‚°
		        	 	totals3[i] = datas3.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0);

		        	    // í•©ê³„ë¥¼ ë‹¤ì‹œ í•œêµ­ì–´ ìˆ«ì í¬ë§·(ko-KR)ìœ¼ë¡œ ë³€í™˜
		        	 	totals3[i] = Intl.NumberFormat("ko-KR").format(totals3[i]);
		         }
		         
		         	// 1. ì „ì²´ ê³¼ì„¸ê°€ê²© ì´í•© ê³„ì‚°
	            	const totalTaxKrw = reportData4.reduce((sum, item) => sum + item.taxKrw, 0);

	            	// 2. íŒŒì´ ì°¨íŠ¸ ë°ì´í„° ìƒì„±
	            	const pieLabels = reportData4.map(item => item.excGname);  
	            	const pieData = reportData4.map(item => 
	                	parseFloat(((item.taxKrw / totalTaxKrw) * 100).toFixed(2))
	                 );
	            	
	            	// 1. ìµœëŒ€ ë¹„ìœ¨ ì°¾ê¸°
	            	const maxPercentage = Math.max(...pieData);  

	            	
		         // ğŸŸ¢ ì„¤ëª… ì¶”ê°€ (ì™¼ìª½ ì •ë ¬ + ì¤„ ë‚˜ëˆ„ê¸°)
	            doc.setFontSize(9);
	            doc.addFont('/pf/fonts/NanumSquareR.ttf', 'NanumSquareR', 'normal');
	            doc.setFont('NanumSquareR', 'normal');
	            doc.setTextColor(0, 0, 0);
	            const description3 = [
	            	`ë‹¤ìŒ ìë£ŒëŠ” HS CODEë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì£¼ìš” ìˆ˜ì… í’ˆëª© ê´€ì„¸ìœ¨ì„ ë³´ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤.`,
	                `HSCODE ${(reportData4[0] && reportData4[0].hs) ? reportData4[0].hs : "-"}ì˜ ${(reportData4[0] && reportData4[0].gsDivi) ? reportData4[0].gsDivi : "-"}ì ìš©  ${(reportData4[0] && reportData4[0].excGname) ? reportData4[0].excGname : "-"}ì´ ìƒìœ„ 10ê°œ í†µê´€ë¬¼í’ˆ ê³¼ì„¸ê°€ê²© ê¸°ì¤€ ${maxPercentage}%ë¡œ ê°€ì¥ ë§ì´ ìˆ˜ì…ë˜ì—ˆìŠµë‹ˆë‹¤.`,
	            	`í•œë‹¬ê°„ ì „ì²´ í’ˆëª©ì˜ í‰ê·  ê´€ì„¸ìœ¨ì€ ${data.avgRate}% ì´ë©° ìƒìœ„ 10ê°œ í†µê´€ ë¬¼í’ˆ í‰ê·  ê´€ì„¸ìœ¨ì€ ${data.topAvgRate}% ì…ë‹ˆë‹¤.`
	            ];
	          
	             startY = 23; // description ë†’ì´ ìœ„ì¹˜
	             description3.forEach((line, index) => {
	            	  doc.text(8, startY, line); // ì™¼ìª½ ì •ë ¬ (x: 8, y: startY)
	            	  startY += 5; // ê° ì¤„ ê°„ê²©ì„ 5ë¡œ ì„¤ì •í•˜ì—¬ ë‹¤ìŒ ì¤„ë¡œ ë‚´ë ¤ê°
	        	});
		        
	            datas3.push(totals3);
	            
	            // í…Œì´ë¸” í—¤ë”
	            var header3 = [['Rank', 'ì„¸ë²ˆë¶€í˜¸', 'ê´€ì„¸êµ¬ë¶„','í’ˆëª…' ,'ê´€ì„¸ìœ¨', 'ê³¼ì„¸ê°€ê²©(KRW)', 'ê´€ì„¸ì•¡']];
	            
	            
	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
            	doc.autoTable({
            	  head: header3,
            	  body:datas3,
            	  startY: startY + 2, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                    wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
            	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                    wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                    halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
            	  },
            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
            	  columnStyles: {
            		  	0: { halign: 'center'}, // ë­í¬
            	        1: { halign: 'center'}, // ì„¸ë²ˆë¶€í˜¸
            	        2: { halign: 'center'}, // ê´€ì„¸êµ¬ë¶„
            	        3: { halign: 'center'}, // í’ˆëª…
            	        4: { halign: 'center'}, // ê´€ì„¸ìœ¨
            	        5: { halign: 'right'}, // ê³¼ì„¸ê°€ê²©
            	        6: { halign: 'right'}, // ê´€ì„¸ì•¡
            	  },
            	  didParseCell: function (data) {
            	        // ğŸŸ¡ ë§ˆì§€ë§‰ í–‰ (í•©ê³„ í–‰)ë§Œ ë°°ê²½ìƒ‰ ë³€ê²½
            	        if (data.row.index === datas3.length - 1) {
            	            data.cell.styles.fillColor = [246, 243, 202]; // ì—°í•œ íšŒìƒ‰ ë°°ê²½
            	            data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
            	            data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
            	        }
            	    }
        		});
            	
            	
            	// 3ë²ˆì§¸ í…Œì´ë¸” yì¢Œí‘œ ì €ì¥ 
            	lastYPage3 = doc.lastAutoTable.finalY;  
            	const pageAfterTable3 = doc.internal.getCurrentPageInfo().pageNumber;
            	
            	// ğŸŸ¢ ë‚¨ì€ ê³µê°„ ê³„ì‚°
            	const spaceLeft3 = doc.internal.pageSize.height - lastYPage3 - 10;
            	
            	let chartPage3, chartY3;
            	
            	if(spaceLeft3< 130){
            		doc.addPage();
            		chartPage3 = pageAfterTable3 + 1;
            		chartY3 = 15;
            	}else{
            		 chartPage3 = pageAfterTable3;       // ê°™ì€ í˜ì´ì§€ì— ê·¸ë¦´ ìˆ˜ ìˆìŒ
            		  chartY3 = lastYPage3;
            	}
            	

            	
            	const pdf3canvas = document.createElement("canvas");
            	const pdf3ctx = pdf3canvas.getContext("2d");
            	pdf3canvas.width = 1000;
            	pdf3canvas.height = 1000;
            	pdf3canvas.style.display = 'none'; // ì›¹ í™”ë©´ì—ì„œ ìˆ¨ê¹€ ì²˜ë¦¬
            	document.body.appendChild(pdf3canvas);
            	
            	var chartDataLabels1 = {
            		    id: 'chartDataLabels',
            		    afterDraw(chart, args, options) {
            		        const ctx1 = chart.ctx; // ì˜¬ë°”ë¥¸ ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©
            		        ctx1.textAlign = "center";
            		        ctx1.textBaseline = "middle";
            		        ctx1.fillStyle = '#000';
            		        ctx1.font = "22px NanumSquareB";
            		        ctx1.lineWidth = 3; // ì„  êµµê¸°

            		        let prevTextPositions1 = [];  // í…ìŠ¤íŠ¸ ìœ„ì¹˜ë¥¼ ì¶”ì í•  ë°°ì—´

            		        chart.data.datasets.forEach((dataset, i) => {
            		            chart.getDatasetMeta(i).data.forEach((datapoint, index) => {
            		                const value = dataset.data[index]; // ë°ì´í„° ê°’
            		                const excGname = reportData4[index].excGname;
            		                if (value <= 3) return; // 0 ì´í•˜ ê°’ì€ í‘œì‹œ ì•ˆ í•¨

            		                const { x, y } = datapoint.tooltipPosition(); // ë°ì´í„° ì¢Œí‘œ ê°€ì ¸ì˜¤ê¸°
            		                const radius1 = chart.outerRadius || (chart.chartArea.width / 2); // ì›ì˜ ë°˜ì§€ë¦„
            		                const angle1 = datapoint.startAngle !== undefined && datapoint.endAngle !== undefined
            		                    ? (datapoint.startAngle + datapoint.endAngle) / 2
            		                    : (index / dataset.data.length) * Math.PI * 2; // ê°ë„ ê³„ì‚°

            		                // ì› ë°”ê¹¥ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì¢Œí‘œ (ì¡°ì •)
            		                const xOuter1 = x + (radius1 * 0.40) * Math.cos(angle1);  // 0.6ìœ¼ë¡œ ê°’ ë³€ê²½í•˜ì—¬ ì›ì˜ ë°”ê¹¥ìª½ìœ¼ë¡œ
            		                const yOuter1 = y + (radius1 * 0.40) * Math.sin(angle1);  // 0.6ìœ¼ë¡œ ê°’ ë³€ê²½í•˜ì—¬ ì›ì˜ ë°”ê¹¥ìª½ìœ¼ë¡œ

            		                // êº¾ì¸ ì§€ì  ì´í›„, ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ ì„¤ì •
            		                const xMiddle1 = xOuter1 + (Math.cos(angle1) * 20);  // 30ìœ¼ë¡œ ê°’ ëŠ˜ë ¤ ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ
            		                const yMiddle1 = yOuter1 + (Math.sin(angle1) * 20);  // 30ìœ¼ë¡œ ê°’ ëŠ˜ë ¤ ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ

            		                // ìµœì¢… ë¼ë²¨ ìœ„ì¹˜ (ê¸¸ì´ë¥¼ ë” ë©€ë¦¬ ì„¤ì •)
            		                let xLine1 = xMiddle1 + (Math.cos(angle1) > 0 ? 20 : -20); // í…ìŠ¤íŠ¸ ìµœì¢… ìœ„ì¹˜ë„ ë” ë©€ë¦¬
            		                let yLine1 = yMiddle1;

            		                // í…ìŠ¤íŠ¸ ê°„ì˜ ìµœì†Œ ê±°ë¦¬ (ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ì¡°ì •)
            		                const minDistance1 =90;  // ìµœì†Œ ê°„ê²© ì„¤ì •

            		                // í…ìŠ¤íŠ¸ê°€ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ê°„ê²© ì¡°ì •
            		                prevTextPositions1.forEach((prevPos) => {
            		                    const dist1 = Math.sqrt(Math.pow(xLine1 - prevPos.x, 2) + Math.pow(yLine1 - prevPos.y, 2));
            		                    if (dist1 < minDistance1) {
            		                        // ê²¹ì¹  ê²½ìš° ìœ„ì¹˜ ì¡°ì •1
            		                        const angleOffset1 = Math.PI / 18;  // ì•½ê°„ì˜ ê°ë„ ì˜¤í”„ì…‹ì„ ì¶”ê°€í•˜ì—¬ ì´ë™
            		                        xLine1 = xMiddle1 + (Math.cos(angle1 + angleOffset1) * 10);
            		                        yLine1 = yMiddle1 + (Math.sin(angle1 + angleOffset1) * 10);
            		                    }
            		                });

            		                // í…ìŠ¤íŠ¸ ìœ„ì¹˜ë¥¼ ì´ì „ ìœ„ì¹˜ ë°°ì—´ì— ì¶”ê°€
            		                prevTextPositions1.push({ x: xLine1, y: yLine1 });

            		                // ìº”ë²„ìŠ¤ì— êº¾ì€ì„  ê·¸ë¦¬ê¸°
            		                ctx1.beginPath();
            		                ctx1.moveTo(xOuter1, yOuter1); // ì› í…Œë‘ë¦¬ì—ì„œ ì‹œì‘
            		                ctx1.lineTo(xMiddle1, yMiddle1); // êº¾ì¸ ì§€ì 
            		                ctx1.lineTo(xLine1, yLine1); // ìµœì¢… ìœ„ì¹˜
            		                ctx1.strokeStyle = 'rgba(129,212,250,0.9)';
            		                ctx1.stroke();

            		                // í…ìŠ¤íŠ¸ ì •ë ¬
            		                ctx1.textAlign = Math.cos(angle1) > 0 ? "left" : "right";

            		                // í…ìŠ¤íŠ¸ í‘œì‹œ
            		                ctx1.fillText(`${value}%`, xLine1, yLine1);
            		            });
            		        });
            		    }
            		};
            	
            	const pdf3chart = new Chart(pdf3ctx, {
            		plugins : [chartDataLabels1],
            			type: "pie",
	            	    data: {
	            	        labels: pieLabels,
	            	        datasets: [{
	            	            data: pieData,
	            	            backgroundColor: [
	            	            	'rgba(1,87,155,0.7)',
	            	            	'rgba(2,119,189,0.7)',
	            	            	'rgba(2,136,209,0.7)',
	            	            	'rgba(3,155,229,0.7)',
	            	            	'rgba(3,169,244,0.7)',
	            	            	'rgba(41,182,246,0.7)',
	            	            	'rgba(79,195,247, 0.7)',
	            	            	'rgba(129,212,250,0.7)',
	            	            	'rgba(179,229,252,0.7)',
	            	            	'rgba(166,208,228,0.7)',
	            	            	]
	            	        }]
	            	    },
	            	    options: {
	            	    	 responsive: false, // âœ… ì°¨íŠ¸ í¬ê¸° ìë™ ì¡°ì ˆ ë¹„í™œì„±í™”
	            	         maintainAspectRatio: false, // âœ… ì›í˜• ë¹„ìœ¨ ìœ ì§€ ë¹„í™œì„±í™”
	            	        //aspectRatio: 1, // ê°€ë¡œì„¸ë¡œ ë¹„ìœ¨ì„ 1:1ë¡œ ê³ ì •í•˜ì—¬ ì›í˜• ìœ ì§€
	            	        layout: {
	            	            padding: {
	            	            	top: 80, 
	            	            	//bottom :5,
	            	            	left : 240,  
	            	            	right : 240
	            	            }
	            	        },
	            	        
	            	        plugins: {
	            	        	datalabels: { 
	            	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
	            	            },
	            	            legend: { 
	            	            	position: "bottom",
	            	            	 fullWidth: true,
	            	            	labels : {
	            	            		font: { size: 16,weight : 'bold' },
	            	            		boxWidth: 16,
	            	            		padding : 25
	            	            	}
	            	            },
	            	            title : {
	            	            	display: true,
	            	            	text: 'ìˆ˜ì…ë¬¼í’ˆ ê³¼ì„¸ í˜„í™©',
	            	            	font : {size :35,weight : 'bold'},
	            	            	padding: {bottom : 30}
	            	            },
	            	            tooltip: {
	             	               enabled : false // íˆ´íŒ ë¹„í™œì„±í™”
	             	            },
	             	            datalabels: { 
	             	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
	             	            }
	            	        }
	            	    },
	            	});
            	
            	// ğŸŸ¢5ë²ˆì§¸ í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "");
                doc.text(8, 15, "4.ìˆ˜ì…ë¬¼í’ˆ ì ìš©ì„¸ìœ¨");
                
                // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                const boxMargin4 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                const boxWidth4 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                const boxHeight4 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                
                doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth4, boxHeight4, 'D');
                
                
                
                const reportData5 = data.reportData5;
                console.log("reportData5",reportData5);
                const datas4 = reportData5.map(item => {
  	              const formattedCntRan = Intl.NumberFormat("ko-KR").format(item.cntRan); 
  	              
  	              return [
  	            	  item.gsRate,            // ì ìš© ì„¸ìœ¨
  	            	  item.gsDivi,        	// ê´€ì„¸êµ¬ë¶„
  	                formattedCntRan 		// í†µê´€ë€ìˆ˜
  	                
  	              ];
  	            });
                
                const defaultColumnCount4 = 3;
	            const defaultRow4 = Array(defaultColumnCount4).fill("");

	            // datasê°€ ìœ íš¨í•œ ë°°ì—´ì´ê³ , ìµœì†Œí•œ í•˜ë‚˜ ì´ìƒì˜ í–‰ì´ ìˆë‹¤ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³ 
	            // ì•„ë‹ˆë©´ defaultRowë¥¼ ë„£ì–´ì„œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
	            const safeDatas4 = (Array.isArray(datas4) && datas4.length > 0)
	              ? datas4
	              : [defaultRow4];

                //ì—´ë³„ í•©ê³„
                 const columnCount4 = safeDatas4[0].length;  // ì—´ ê°œìˆ˜
		         const totals4 = Array(columnCount4).fill("");  // 0ìœ¼ë¡œ ì±„ìš´ í•©ê³„ ë°°ì—´
		         
		         
		         totals4[0] = "í•©ê³„"; 
		         for (let i = 2; i < columnCount4; i++) {
		        	    // ì‰¼í‘œ(,)ë¥¼ ì œê±°í•œ í›„ ìˆ«ìë¡œ ë³€í™˜í•˜ì—¬ í•©ì‚°
		        	 	totals4[i] = datas4.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0);

		        	    // í•©ê³„ë¥¼ ë‹¤ì‹œ í•œêµ­ì–´ ìˆ«ì í¬ë§·(ko-KR)ìœ¼ë¡œ ë³€í™˜
		        	 	totals4[i] = Intl.NumberFormat("ko-KR").format(totals4[i]);
		         }
		         
		        
	            datas4.push(totals4);
	            
	            // í…Œì´ë¸” í—¤ë”
	            var header4 = [['ì ìš©ì„¸ìœ¨','ê´€ì„¸êµ¬ë¶„','í†µê´€ë€ìˆ˜']];
	            
	            
	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
            	doc.autoTable({
            	  head: header4,
            	  body:datas4,
            	  startY: 26, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                    wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
            	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                    wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                    halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
            	  },
            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
            	  columnStyles: {
            		  	0: { halign: 'center'}, // ì ìš©ì„¸ìœ¨
            	        1: { halign: 'center'}, // ê´€ì„¸êµ¬ë¶„
            	        2: { halign: 'right'}, // í†µê´€ë€ìˆ˜
            	  },
            	  didParseCell: function (data) {
            	        // ğŸŸ¡ ë§ˆì§€ë§‰ í–‰ (í•©ê³„ í–‰)ë§Œ ë°°ê²½ìƒ‰ ë³€ê²½
            	        if (data.row.index === datas4.length - 1) {
            	            data.cell.styles.fillColor = [246, 243, 202]; // ì—°í•œ íšŒìƒ‰ ë°°ê²½
            	            data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
            	            data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
            	        }
            	    }
        		});
            	
            	// 4ë²ˆì§¸ í…Œì´ë¸” yì¢Œí‘œ ì €ì¥ 
            	lastYPage4 = doc.lastAutoTable.finalY;
            	const pageAfterTable4 = doc.internal.getCurrentPageInfo().pageNumber;
            	
            	const spaceLeft4 = doc.internal.pageSize.height - lastYPage4 - 10;
            	
            	let chartPage4, chartY4;
            	
            	if(spaceLeft4< 110){
            		doc.addPage();
            		chartPage4 = pageAfterTable4 + 1;
            		chartY4 = 15;
            	}else{
            		 chartPage4 = pageAfterTable4;       // ê°™ì€ í˜ì´ì§€ì— ê·¸ë¦´ ìˆ˜ ìˆìŒ
            		  chartY4 = lastYPage4;
            	}
            	// 1. ì „ì²´ ê³¼ì„¸ê°€ê²© ì´í•© ê³„ì‚°
            	const totalCntRan = reportData5.reduce((sum, item) => sum + item.cntRan, 0);

            	// 2. íŒŒì´ ì°¨íŠ¸ ë°ì´í„° ìƒì„±
            	const pieLabels2 = reportData5.map(item => item.gsDivi);  
            	const pieData2 = reportData5.map(item => 
                	parseFloat(((item.cntRan / totalCntRan) * 100).toFixed(2))
                 );
            	
            	const pdf4canvas = document.createElement("canvas");
            	const pdf4ctx = pdf4canvas.getContext("2d");
            	
            	pdf4canvas.width = 1200;
            	pdf4canvas.height = 1200;
            	
            	pdf4canvas.style.display = 'none'; // ì›¹ í™”ë©´ì—ì„œ ìˆ¨ê¹€ ì²˜ë¦¬
            	document.body.appendChild(pdf4canvas);
            	
            	
            	var chartDataLabels = {
            		    id: 'chartDataLabels',
            		    afterDraw(chart, args, options) {
            		        const ctx = chart.ctx; // ì˜¬ë°”ë¥¸ ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©
            		        ctx.textAlign = "center";
            		        ctx.textBaseline = "middle";
            		        ctx.fillStyle = '#000';
            		        ctx.font = "35px NanumSquareB";
            		        ctx.lineWidth = 5; // ì„  êµµê¸°

            		        let prevTextPositions = [];  // í…ìŠ¤íŠ¸ ìœ„ì¹˜ë¥¼ ì¶”ì í•  ë°°ì—´

            		        chart.data.datasets.forEach((dataset, i) => {
            		            chart.getDatasetMeta(i).data.forEach((datapoint, index) => {
            		                const value = dataset.data[index]; // ë°ì´í„° ê°’
            		                const gs = reportData5[index].gsDivi;
            		                if (value <= 1) return; // 0 ì´í•˜ ê°’ì€ í‘œì‹œ ì•ˆ í•¨

            		                const { x, y } = datapoint.tooltipPosition(); // ë°ì´í„° ì¢Œí‘œ ê°€ì ¸ì˜¤ê¸°
            		                const radius = chart.outerRadius || (chart.chartArea.width / 2); // ì›ì˜ ë°˜ì§€ë¦„
            		                const angle = datapoint.startAngle !== undefined && datapoint.endAngle !== undefined
            		                    ? (datapoint.startAngle + datapoint.endAngle) / 2
            		                    : (index / dataset.data.length) * Math.PI * 2; // ê°ë„ ê³„ì‚°

            		                // ì› ë°”ê¹¥ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì¢Œí‘œ (ì¡°ì •)
            		                const xOuter = x + (radius * 0.3) * Math.cos(angle);  // 0.6ìœ¼ë¡œ ê°’ ë³€ê²½í•˜ì—¬ ì›ì˜ ë°”ê¹¥ìª½ìœ¼ë¡œ
            		                const yOuter = y + (radius * 0.3) * Math.sin(angle);  // 0.6ìœ¼ë¡œ ê°’ ë³€ê²½í•˜ì—¬ ì›ì˜ ë°”ê¹¥ìª½ìœ¼ë¡œ

            		                // êº¾ì¸ ì§€ì  ì´í›„, ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ ì„¤ì •
            		                const xMiddle = xOuter + (Math.cos(angle) * 20);  // 30ìœ¼ë¡œ ê°’ ëŠ˜ë ¤ ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ
            		                const yMiddle = yOuter + (Math.sin(angle) * 20);  // 30ìœ¼ë¡œ ê°’ ëŠ˜ë ¤ ì„  ê¸¸ì´ë¥¼ ë” ê¸¸ê²Œ

            		                // ìµœì¢… ë¼ë²¨ ìœ„ì¹˜ (ê¸¸ì´ë¥¼ ë” ë©€ë¦¬ ì„¤ì •)
            		                let xLine = xMiddle + (Math.cos(angle) > 0 ? 40 : -40); // í…ìŠ¤íŠ¸ ìµœì¢… ìœ„ì¹˜ë„ ë” ë©€ë¦¬
            		                let yLine = yMiddle;

            		                // í…ìŠ¤íŠ¸ ê°„ì˜ ìµœì†Œ ê±°ë¦¬ (ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ì¡°ì •)
            		                const minDistance = 40;  // ìµœì†Œ ê°„ê²© ì„¤ì •

            		                // í…ìŠ¤íŠ¸ê°€ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ê°„ê²© ì¡°ì •
            		                prevTextPositions.forEach((prevPos) => {
            		                    const dist = Math.sqrt(Math.pow(xLine - prevPos.x, 2) + Math.pow(yLine - prevPos.y, 2));
            		                    if (dist < minDistance) {
            		                        // ê²¹ì¹  ê²½ìš° ìœ„ì¹˜ ì¡°ì •
            		                        const angleOffset = Math.PI / 18;  // ì•½ê°„ì˜ ê°ë„ ì˜¤í”„ì…‹ì„ ì¶”ê°€í•˜ì—¬ ì´ë™
            		                        xLine = xMiddle + (Math.cos(angle + angleOffset) * 40);
            		                        yLine = yMiddle + (Math.sin(angle + angleOffset) * 40);
            		                    }
            		                });

            		                // í…ìŠ¤íŠ¸ ìœ„ì¹˜ë¥¼ ì´ì „ ìœ„ì¹˜ ë°°ì—´ì— ì¶”ê°€
            		                prevTextPositions.push({ x: xLine, y: yLine });

            		                // ìº”ë²„ìŠ¤ì— êº¾ì€ì„  ê·¸ë¦¬ê¸°
            		                ctx.beginPath();
            		                ctx.moveTo(xOuter, yOuter); // ì› í…Œë‘ë¦¬ì—ì„œ ì‹œì‘
            		                ctx.lineTo(xMiddle, yMiddle); // êº¾ì¸ ì§€ì 
            		                ctx.lineTo(xLine, yLine); // ìµœì¢… ìœ„ì¹˜
            		                ctx.strokeStyle = 'rgba(129,212,250,0.9)';
            		                ctx.stroke();

            		                // í…ìŠ¤íŠ¸ ì •ë ¬
            		                ctx.textAlign = Math.cos(angle) > 0 ? "left" : "right";

            		                // í…ìŠ¤íŠ¸ í‘œì‹œ
            		                ctx.fillText(`${gs} : ${value}%`, xLine, yLine);
            		            });
            		        });
            		    }
            		};

            	
            	const pdf4chart = new Chart(pdf4ctx, {
            	    plugins : [chartDataLabels],
            		type: "pie",
            	    data: {
            	        labels: pieLabels2,
            	        datasets: [{
            	            data: pieData2,
            	            backgroundColor: [
            	            	'rgba(1,87,155,0.7)',
            	            	'rgba(2,119,189,0.7)',
            	            	'rgba(2,136,209,0.7)',
            	            	'rgba(3,155,229,0.7)',
            	            	'rgba(3,169,244,0.7)',
            	            	'rgba(41,182,246,0.7)',
            	            	'rgba(79,195,247, 0.7)',
            	            	'rgba(129,212,250,0.7)',
            	            	'rgba(179,229,252,0.7)',
            	            	'rgba(166,208,228,0.7)',
            	            	]
            	        	}]
            	    	},
            	    options: {
            	    	responsive: false,
            	        maintainAspectRatio: false, //ë¹„ìœ¨ ë¬´ì‹œ
            	        layout: {
            	            padding: 180  // ğŸ”¹ ì°¨íŠ¸ ì£¼ë³€ ì—¬ë°± í™•ë³´ (ê°’ì„ ëŠ˜ë¦¬ë©´ ì°¨íŠ¸ê°€ ì‘ì•„ì§)
            	        },
            	        plugins: {
            	            legend: { 
            	            	position: "bottom",
            	            	display : true,
            	            	align : 'center',
            	            	labels : {
            	            		boxWidth : 18,
            	            		padding : 20,
            	            		font : {
            	            			size : 30,
            	            			weight : 'bold'
            	            		}
            	            	}
            	            },
            	            title : {
            	            	display: true,
            	            	text: 'ìˆ˜ì…ë¬¼í’ˆ ì ìš©ì„¸ìœ¨',
            	            	font : {size :43, weight : 'bold'},
            	            	padding: {bottom : 60}
            	            },
            	            tooltip: {
            	               enabled : false // íˆ´íŒ ë¹„í™œì„±í™”
            	            },
            	            datalabels: { 
            	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
            	            }
            	        }
            	    }
            	  
            	});
            	
            	/*// ğŸŸ¢6ë²ˆì§¸ í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "ìˆ˜ì…ì •ì •í˜„í™©");
                
                // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                const boxMargin5 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                const boxWidth5 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                const boxHeight5 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                
                doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth5, boxHeight5, 'D'); 
                
                const reportData6 = data.reportData6;
                console.log("reportData6",reportData6);
                const datas5 = reportData6.map(item => {
  	              const formattedCntRan = Intl.NumberFormat("ko-KR").format(item.cntRan); 
  	              
  	              return [
  	            	  item.rowNum,			// ë²ˆí˜¸
  	            	  item.impRpt,          // ì‹ ê³ ë²ˆí˜¸
  	            	  item.rptDay,        	// ì •ì •ì‹ ì²­ì¼
  	            	  item.petDay,        	// ì •ì •ìŠ¹ì¸ì¼
  	            	  item.reasonDoc,  		// ì •ì •ì‚¬ìœ 
  	            	  item.reason	  		// ê·€ì±…ì‚¬ìœ 
  	              ];
  	            });
	            
	            // í…Œì´ë¸” í—¤ë”
	            var header5 = [['ë²ˆí˜¸','ì‹ ê³ ë²ˆí˜¸','ì •ì •ì‹ ì²­ì¼','ì •ì •ìŠ¹ì¸ì¼','ì •ì •ì‚¬ìœ ','ê·€ì±…ì‚¬ìœ ']];
	            
	            
	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
            	doc.autoTable({
            	  head: header5,
            	  body:datas5,
            	  startY: 24, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                    wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
            	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                    wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                    halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
            	  },
            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
            	  columnStyles: {
            		  	0: { halign: 'center'}, // ë²ˆí˜¸
            	        1: { halign: 'center'}, // ì‹ ê³ ë²ˆí˜¸
            	        2: { halign: 'center'}, // ì •ì •ì‹ ì²­ì¼
            	        3: { halign: 'center'}, // ì •ì •ìŠ¹ì¸ì¼
            	        4: { halign: 'center'}, // ì •ì •ì‚¬ìœ 
            	        5: { halign: 'center'}, // ê·€ì±…ì‚¬ìœ 
            	  },
        		});*/
            	// ğŸŸ¢7ë²ˆì§¸ í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "5.FTA ì‚¬í›„ì ìš©ê¸ˆì•¡");
                
                // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                const boxMargin6 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                const boxWidth6 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                const boxHeight6 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                
                doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth6, boxHeight6, 'D'); 
                
                
                doc.setFontSize(12);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(4, 30, "ì‚¬í›„ì ìš© ê±´ìˆ˜ ë° ê¸ˆì•¡");
                
                const reportData7 = data.reportData7;
                console.log("reportData7",reportData7);
		         
                const datas6 = reportData7.map(item => {
  	              const formattedTransTaxSum = Intl.NumberFormat("ko-KR").format(item.transTaxSum); 
  	              const formattedTaxCot = Intl.NumberFormat("ko-KR").format(item.taxCot); 
  	              const formattedTaxCoVat = Intl.NumberFormat("ko-KR").format(item.taxCotVat); 
  	              
  	              return [
  	            	  item.rptNo,            	// ì‹ ê³ ë²ˆí˜¸
  	            	  item.impRptDay,        	// ì‹ ê³ ì¼ì
  	            	  item.rptDay,				//ì •ì •ì‹ ì²­ì¼
  	            	  item.cus,					//ìˆ˜ì…ì„¸ê´€
  	            	  item.reasonCode,			//ì •ì •ì‚¬ìœ ì½”ë“œ	
  	            	  item.petDay,				//ìŠ¹ì¸ì¼ì
  	            	  formattedTransTaxSum,		//ì¦ê°ë‚´ì—­
  	            	  formattedTaxCot,			//ê´€ì„¸ ì¦ê° ë‚´ì—­
  	            	  formattedTaxCoVat			//ë¶€ê°€ì„¸ ì¦ê° ë‚´ì—­
  	              ];
  	            });
	            
                // í…Œì´ë¸” í—¤ë”
	            var header5 = [['ìˆ˜ì…ì‹ ê³  ë²ˆí˜¸','ìˆ˜ì…ì‹ ê³ ì¼ì','ì •ì •ì‹ ì²­ì¼ì','ìˆ˜ì… ì„¸ê´€','ì •ì •ì‚¬ìœ ì½”ë“œ','ìŠ¹ì¸ ì¼ì','ì¦ê°ë‚´ì—­','ê´€ì„¸ ì¦ê°ë‚´ì—­','ë¶€ê°€ì„¸ ì¦ê°ë‚´ì—­']];
	            
	            
	            //const columnCount5 = datas6[0].length;  // ì—´ ê°œìˆ˜
	            const columnCount5 = (datas6.length > 0 && Array.isArray(datas6[0])) ? datas6[0].length : 0;
	            const rowCount5 = datas6.length; // í–‰ ê°œìˆ˜
	            
		         const totals5 = Array(columnCount5).fill("");  // 0ìœ¼ë¡œ ì±„ìš´ í•©ê³„ ë°°ì—´
		         
		         
		         for (let i = 6; i < columnCount5; i++) {
		        	    // ì‰¼í‘œ(,)ë¥¼ ì œê±°í•œ í›„ ìˆ«ìë¡œ ë³€í™˜í•˜ì—¬ í•©ì‚°
		        	 totals5[i] = datas6.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0);

		        	    // í•©ê³„ë¥¼ ë‹¤ì‹œ í•œêµ­ì–´ ìˆ«ì í¬ë§·(ko-KR)ìœ¼ë¡œ ë³€í™˜
		        	 totals5[i] = Intl.NumberFormat("ko-KR").format(totals5[i]);
		         }
		         
		         console.log("totals5",totals5);
                
                
                
                
                
                // í…Œì´ë¸” í—¤ë”
	            var header6 = [['ê±´ìˆ˜','í™˜ê¸‰ì•¡','ê´€ì„¸','ë¶€ê°€ì„¸']];
	            
	            var ftaTotalData = [[rowCount5, totals5[6], totals5[7], totals5[8]]];
	            
	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
            	doc.autoTable({
            	  head: header6,
            	  body: ftaTotalData,
            	  startY: 32, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                    wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
            	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                    wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                    halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
            	  },
            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
            	  columnStyles: {
            		  	0: { halign: 'center'}, // ê±´ìˆ˜
            	        1: { halign: 'right'}, // í™˜ê¸‰ì•¡
            	        2: { halign: 'right'}, // ê´€ì„¸
            	        3: { halign: 'right'}, // ë¶€ê°€ì„¸
            	  },
        		});
            	
               
	            
	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
            	doc.autoTable({
            	  head: header5,
            	  body:datas6,
            	  startY: 55, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                    wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
            	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                    wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                    halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
            	  },
            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
            	  columnStyles: {
            		  	0: { halign: 'center'}, // ë²ˆí˜¸
            	        1: { halign: 'center'}, // ì‹ ê³ ì¼
            	        2: { halign: 'center'}, // ì •ì •ì‹ ì²­ì¼
            	        3: { halign: 'center'}, // ìˆ˜ì…ì„¸ê´€
            	        4: { halign: 'center'}, // ì •ì •ì‚¬ìœ ì½”ë“œ
            	        5: { halign: 'center'}, // ìŠ¹ì¸ì¼ì
            	        6: { halign: 'right'}, // ì¦ê°ë‚´ì—­
            	        7: { halign: 'right'}, // ê´€ì„¸ ì¦ê°ë‚´ì—­
            	        8: { halign: 'right'}, // ë¶€ê°€ì„¸ ì¦ê°ë‚´ì—­
            	  },
        		});
            	
            	
            	// ğŸŸ¢8ë²ˆì§¸ í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "6.ì£¼ìš” í•´ì™¸ ê±°ë˜ì²˜(ìˆ˜ì…)");
                
                // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                const boxMargin7 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                const boxWidth7 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                const boxHeight7 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                
                doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth7, boxHeight7, 'D'); 
                
                const reportData8 = data.reportData8;
               
                // ìˆ˜ì…ê¸ˆì•¡(ì›í™”)ì˜ ì´í•© ê³„ì‚°
                const totalConTotAmt = reportData8.reduce((sum, item) => sum + item.conTotAmt, 0);
               
                const datas7 = reportData8.map(item => {
  	              const formattedTotImp = Intl.NumberFormat("ko-KR").format(item.totImp); 
  	              const formattedConTotAmt = Intl.NumberFormat("ko-KR").format(item.conTotAmt);
  	              
  	              // ë¹„ìœ¨ ê³„ì‚° (ì´ì•¡ ëŒ€ë¹„ ë°±ë¶„ìœ¨)
  	            const percentage = totalConTotAmt > 0 ? ((item.conTotAmt / totalConTotAmt) * 100).toFixed(2) + "%" : "0%";

  	              
  	              return [
  	            	  item.supFirm,            // í•´ì™¸ê±°ë˜ì²˜
  	            	  item.supStSht,        	// êµ­ê°€
  	            	  formattedTotImp,			//ê±´ìˆ˜
  	            	  formattedConTotAmt,    	// ìˆ˜ì…ê¸ˆì•¡(ì›í™”)
  	            	  percentage
  	              ];
  	            });
	            
	            // í…Œì´ë¸” í—¤ë”
	            var header5 = [['í•´ì™¸ê±°ë˜ì²˜','êµ­ê°€','ê±´ìˆ˜','ìˆ˜ì…ê¸ˆì•¡(ì›í™”)','ë¹„ìœ¨']];
	            
	            
	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
            	doc.autoTable({
            	  head: header5,
            	  body:datas7,
            	  startY: 24, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
            	  theme: 'grid',
            	  styles: {
            	    font: 'NanumSquareR',
            	    fontSize: 7,
            	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
            	    textColor: [0, 0, 0],
            	    valign: 'middle',
            	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                    wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
            	  },
            	  headStyles: {
            		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
            		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
            	    fontSize: 8,
            	    textColor: [255, 255, 255],
            	    font: 'NanumSquareEB',
            	    fontStyle: 'bold',
            	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
            	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
            	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
            	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                    wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                    halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
            	  },
            	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
            	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
            	  columnStyles: {
            		  	0: { halign: 'center'}, // í•´ì™¸ê±°ë˜ì²˜
            	        1: { halign: 'center'}, // êµ­ê°€
            	        2: { halign: 'right'}, // ê±´ìˆ˜
            	        3: { halign: 'right'}, // ìˆ˜ì…ê¸ˆì•¡(ì›í™”)
            	        4: { halign: 'right'}, // ë¹„ìœ¨
            	  },
        		});
            	
            	
            	lastYPage6 = doc.lastAutoTable.finalY;  
            	const pageAfterTable6 = doc.internal.getCurrentPageInfo().pageNumber;
            	
            	const spaceLeft6 = doc.internal.pageSize.height - lastYPage6 - 10;
            	
            	let chartPage6, chartY6;
            	
            	if(spaceLeft6< 130){
            		doc.addPage();
            		chartPage6 = pageAfterTable6 + 1;
            		chartY6 = 15;
            	}else{
            		 chartPage6 = pageAfterTable6;       // ê°™ì€ í˜ì´ì§€ì— ê·¸ë¦´ ìˆ˜ ìˆìŒ
            		  chartY6 = lastYPage6;
            	}
            	
            	
               	const pdf7canvas = document.createElement("canvas");
            	const pdf7ctx = pdf7canvas.getContext("2d");
            	pdf7canvas.width = 1000;
            	pdf7canvas.height = 1000;
            	pdf7canvas.style.visibility = 'hidden';
            	document.body.appendChild(pdf7canvas);
            	
            	// í”ŒëŸ¬ê·¸ì¸ ì •ì˜
            	const chartDataLabels3 = {
            	  id: 'chartDataLabels',
            	  afterDraw(chart, args, options) {
            	    const ctx3 = chart.ctx;
            	    ctx3.textAlign = "center";
            	    ctx3.textBaseline = "middle";
            	    ctx3.fillStyle = '#000';
            	    ctx3.font = "16px NanumSquare";
            	    ctx3.lineWidth =3;

            	    const prevTextPositions3 = [];

            	    chart.data.datasets.forEach((dataset, i) => {
            	      chart.getDatasetMeta(i).data.forEach((datapoint, index) => {
            	        const supFirm = chart.data.labels[index]; // supFirm ì´ë¦„
            	        const percentage = dataset.data[index];   // ë¹„ìœ¨ ìˆ«ì

            	        if (percentage < 1) return;

            	        const { x, y } = datapoint.tooltipPosition();
            	        const radius = chart.outerRadius || (chart.chartArea.width / 2);
            	        const angle = (datapoint.startAngle + datapoint.endAngle) / 2;

            	        const xOuter = x + (radius * 0.4) * Math.cos(angle);
            	        const yOuter = y + (radius * 0.4) * Math.sin(angle);

            	        const xMiddle = xOuter + Math.cos(angle) * 20;
            	        const yMiddle = yOuter + Math.sin(angle) * 20;

            	        let xLine = xMiddle + (Math.cos(angle) >= 0 ? 20 : -20);
            	        let yLine = yMiddle;

            	        const minDistance = 90;
            	        let attempts = 0;

            	        // í…ìŠ¤íŠ¸ ê°„ê²© ì¡°ì • ë°˜ë³µ
            	        prevTextPositions3.forEach((prevPos) => {
		                    const dist3 = Math.sqrt(Math.pow(xLine - prevPos.x, 2) + Math.pow(yLine - prevPos.y, 2));
		                    if (dist3 < minDistance) {
		                        // ê²¹ì¹  ê²½ìš° ìœ„ì¹˜ ì¡°ì •1
		                        const angleOffset3 = Math.PI / 18;  // ì•½ê°„ì˜ ê°ë„ ì˜¤í”„ì…‹ì„ ì¶”ê°€í•˜ì—¬ ì´ë™
		                        xLine = xMiddle + (Math.cos(angle + angleOffset3) * 10);
		                        yLine = yMiddle + (Math.sin(angle + angleOffset3) * 10);
		                    }
		                });

            	        prevTextPositions3.push({ x: xLine, y: yLine });

            	        ctx3.beginPath();
            	        ctx3.moveTo(xOuter, yOuter);
            	        ctx3.lineTo(xMiddle, yMiddle);
            	        ctx3.lineTo(xLine, yLine);
            	        ctx3.strokeStyle = 'rgba(129,212,250,0.9)';
            	        ctx3.stroke();

            	        ctx3.textAlign = Math.cos(angle) >= 0 ? "left" : "right";

            	       
            	        //let labelText = `${supFirm} : ${percentage.toFixed(2)}%`;
            	        let labelText = `${percentage.toFixed(2)}%`;

            	        ctx3.fillText(labelText, xLine, yLine);
            	      });
            	    });
            	  }
            	};

            	
            	// 1% ì´ìƒì¸ ë°ì´í„°ë§Œ í•„í„°ë§
            	const chartDataFiltered = reportData8
            	  .map(item => {
            	    const percentage = totalConTotAmt > 0 ? (item.conTotAmt / totalConTotAmt) * 100 : 0;
            	    return {
            	      supFirm: item.supFirm,
            	      percentage: percentage
            	    };
            	  })
            	  .filter(item => item.percentage >= 5); // ğŸ”¥5% ì´ìƒë§Œ

            	// ë¼ë²¨: supFirm ì´ë¦„
            	const supFirmLabels = chartDataFiltered.map(item => item.supFirm);

            	// ë°ì´í„°: ë¹„ìœ¨ (ì†Œìˆ˜ì  2ìë¦¬)
            	const impPieData = chartDataFiltered.map(item => Number(item.percentage.toFixed(2)));
            	
            	const pdf7chart = new Chart(pdf7ctx, {
            		plugins : [chartDataLabels3],
            			type: "pie",
	            	    data: {
	            	        labels: supFirmLabels,
	            	        datasets: [{
	            	            data: impPieData,
	            	            backgroundColor: [
	            	            	'rgba(1,87,155,0.7)',
	            	            	'rgba(2,119,189,0.7)',
	            	            	'rgba(2,136,209,0.7)',
	            	            	'rgba(3,155,229,0.7)',
	            	            	'rgba(3,169,244,0.7)',
	            	            	'rgba(41,182,246,0.7)',
	            	            	'rgba(79,195,247, 0.7)',
	            	            	'rgba(129,212,250,0.7)',
	            	            	'rgba(179,229,252,0.7)',
	            	            	'rgba(166,208,228,0.7)',
	            	            	/*'rgb(49,97,79)',
	            	            	'rgb(71,140,114)',
	            	            	'rgb(84,166,135)',
	            	            	'rgb(123,211,171)',
	            	            	'rgb(153,184,169)',
	            	            	'rgb(102,178,103)',
	            	            	'rgb(154,204,153)',
	            	            	'rgb(186,221,139)',
	            	            	'rgb(238,231,148)',
	            	            	'rgb(231,244,218)',*/
	            	            	]
	            	        }]
	            	    },
	            	    options: {
	            	    	 responsive: false, // âœ… ì°¨íŠ¸ í¬ê¸° ìë™ ì¡°ì ˆ ë¹„í™œì„±í™”
	            	         maintainAspectRatio: false, // âœ… ì›í˜• ë¹„ìœ¨ ìœ ì§€ ë¹„í™œì„±í™”
	            	         //radius: '50%',
	            	        //aspectRatio: 1, // ê°€ë¡œì„¸ë¡œ ë¹„ìœ¨ì„ 1:1ë¡œ ê³ ì •í•˜ì—¬ ì›í˜• ìœ ì§€
	            	        layout: {
	            	        	padding: {
	            	                top: 300,
	            	                right: 320,
	            	                bottom: 30,
	            	                left: 320
	            	            }
	            	        	//padding:250
	            	        },
	            	        plugins: {
	            	            legend: { 
	            	            	position: "bottom",
	            	            	 fullWidth: true,
	            	            	labels : {
	            	            		boxWidth : 8,
	            	            		padding : 10,
	            	            		font : {
	            	            			size : 13,
	            	            			weight : 'bold'
	            	            		}
	            	            	}

	            	            },
	            	            title : {
	            	            	display: true,
	            	            	text: 'ì£¼ìš” í•´ì™¸ê±°ë˜ì²˜(ìˆ˜ì…)',
	            	            	font : {size :24 ,weight : 'bold'},
	            	            	padding: {bottom :30}
	            	            },
	            	            tooltip: {
	             	               enabled : false // íˆ´íŒ ë¹„í™œì„±í™”
	             	            },
	             	            datalabels: { 
	             	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
	             	            }
	            	        }
	            	    },
	            	});
            	
            	

            	// ğŸŸ¢ 9ë²ˆ  í˜ì´ì§€ ì¶”ê°€
                doc.addPage();
                
                doc.setFontSize(16);
                doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                doc.setFont('NanumSquareB', 'normal');
                //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                doc.setTextColor(71, 140, 114); 
                doc.text(8, 15, "7.ìˆ˜ì¶œí†µê´€í˜„í™©");
                
                // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                const boxMargin8 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                const boxWidth8 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                const boxHeight8 = 23;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                
                doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                doc.setDrawColor(35, 69,56); 
                doc.rect(5, 8, boxWidth8, boxHeight8, 'D'); 
                
                
                const reportData9 = data.reportData9;  
                	console.log("reportData9",reportData9);
    	            const datas8 = reportData9.map(item => {
    	              const amountKrw = parseFloat(item.amountKrw) || 0;  // ì›ë³¸ ê°’
    	              const formattedAmountKrw = Intl.NumberFormat("ko-KR").format(amountKrw);  // í¬ë§¤íŒ…ëœ ê°’
    	              
    	              return [
    	                item.lisDay,        // ìˆ˜ë¦¬ì¼ì
    	                item.cnt,           // ê±´ìˆ˜
    	                formattedAmountKrw, // ì‹ ê³ ê°€ê²©
    	                item.exType1,       // ì¼ë°˜ìˆ˜ì¶œ
    	                item.exType2,       // ì›ìƒíƒœ
    	                item.exType3,       // ë°˜ì†¡ìˆ˜ì¶œ
    	                item.exType4,       // ìˆ˜ë¦¬ìš©
    	                item.exType5,       // ê¸°íƒ€ë¬´ìƒìˆ˜ì¶œ
    	                item.exPrc1,        // P/L
    	                item.exPrc3,        // ì œì¶œì„œë¥˜
    	                item.exPrc2,        // ê²€ì‚¬
    	              ];
    	            });
    		        // ğŸŸ¢ ì—´ë³„ í•©ê³„ ê³„ì‚°
    		         
    	            
    	             const columnCount6 = (datas8.length > 0 && Array.isArray(datas8[0])) ? datas8[0].length : 0; // ì—´ ê°œìˆ˜
    		         const totals6 = Array(columnCount6).fill(0);  // 0ìœ¼ë¡œ ì±„ìš´ í•©ê³„ ë°°ì—´

    		         // í•©ê³„ ê³„ì‚° (ì²« ë²ˆì§¸ ì—´ì€ "í•©ê³„" ë¬¸ìì—´ì„ ë„£ê³ , ë‚˜ë¨¸ì§€ëŠ” ìˆ«ì í•©ì‚°)
    		         totals6[0] = "í•©ê³„"; 
    		         for (let i = 1; i < columnCount6; i++) {
    		        	  // ê³¼ì„¸ê°€ê²©(3ë²ˆì§¸ ì—´)ì„ ì œì™¸í•œ ê°’ë“¤ë§Œ í•©ì‚°
    		        	  if (i === 2) {
    		        	    totals6[i] = datas8.reduce((sum, row) => sum + (parseFloat(row[i].replace(/,/g, "")) || 0), 0); // ì›ë³¸ ê°’ìœ¼ë¡œ í•©ê³„ ê³„ì‚°
    		        	  } else {
    		        	    totals6[i] = datas8.reduce((sum, row) => sum + (parseFloat(row[i]) || 0), 0);
    		        	  }
    		        	}

    		         // ğŸŸ¢ ë¹„ìœ¨ ê³„ì‚° (ê° ê·¸ë£¹ì„ 100%ë¡œ ì„¤ì •)
    		         const percentages1 = Array(columnCount6).fill("-");
    		         percentages1[0] = "ë¹„ìœ¨(%)"; // ì²« ë²ˆì§¸ ì—´ì€ "ë¹„ìœ¨(%)"

    		         // ğŸŸ¢ ìˆ˜ì¸¨ ê±°ë˜í˜•íƒœ ë¹„ìœ¨ ê³„ì‚°
    		         const tradeTotal1 = totals6.slice(3, 8).reduce((sum, value) => sum + value, 0); // 3~7ë²ˆì§¸ ì—´ í•©ê³„
    		         for (let i = 3; i < 8; i++) {
    		             percentages1[i] = tradeTotal1 > 0 ? ((totals6[i] / tradeTotal1) * 100).toFixed(1) + "%" : "-";
    		         }

    		         // ğŸŸ¢ ìˆ˜ì¶œì²˜ë¦¬í˜„í™© ë¹„ìœ¨ ê³„ì‚°
    		         const processTotal1 = totals6.slice(8, 11).reduce((sum, value) => sum + value, 0); // 8~10ë²ˆì§¸ ì—´ í•©ê³„
    		         for (let i = 8; i < 11; i++) {
    		             percentages1[i] = processTotal1 > 0 ? ((totals6[i] / processTotal1) * 100).toFixed(1) + "%" : "-";
    		         }

    		         
    		     	 // ğŸŸ¢ ìˆ«ì ë°ì´í„° í¬ë§·íŒ… (ì²œ ë‹¨ìœ„ ì½¤ë§ˆ ì¶”ê°€)
    		         const formattedTotals1 = totals6.map((value, index) =>
    		         typeof value === "number" ? Intl.NumberFormat("ko-KR").format(value) : value
    		      	);
    		         
    		     	// ğŸŸ¢ ê±´ìˆ˜, P/L, ì œì¶œì„œë¥˜, ê²€ì‚¬ ê°€ì ¸ì˜¤ê¸°
    		         const countTotal1 = formattedTotals1[1] || 0;              // í†µê´€ê±´ìˆ˜
    		         const plTotal1 = formattedTotals1[8] || 0;                 // P/L í•©ê³„
    		         const plPercentage1 = percentages1[8] || 0;                // P/L ë¹„ìœ¨
    		         const submissionTotal1 = formattedTotals1[9] || 0;         // ì œì¶œì„œë¥˜ í•©ê³„
    		         const submissionPercentage1 = percentages1[9] || 0;        // ì œì¶œì„œë¥˜ ë¹„ìœ¨
    		         const inspectionTotal1 = formattedTotals1[10] || 0;        // ê²€ì‚¬ í•©ê³„
    		         const inspectionPercentage1 = percentages1[10] || 0;       // ê²€ì‚¬ ë¹„ìœ¨
    	       
    		            // ğŸŸ¢ ì„¤ëª… ì¶”ê°€ (ì™¼ìª½ ì •ë ¬ + ì¤„ ë‚˜ëˆ„ê¸°)
    		            doc.setFontSize(9);
    		            doc.addFont('/pf/fonts/NanumSquareR.ttf', 'NanumSquareR', 'normal');
    		            doc.setFont('NanumSquareR', 'normal');
    		            doc.setTextColor(0, 0, 0);
    		            const description4 = [
    		            	`ë‹¤ìŒ ìë£ŒëŠ” ${data.rptDate2}ì›” í•œë‹¬ ìˆ˜ì…í†µê´€ ìë£Œì´ë©° ì´ ${countTotal1}ê±´ ìˆ˜ì…ì‹ ê³ ë¥¼ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.`,
    		                `ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™©ì€ P/L ${plTotal1}ê±´ (${plPercentage1}), ì œì¶œ ${submissionTotal1}ê±´ (${submissionPercentage1}), ê²€ì‚¬ ${inspectionTotal1}ê±´ (${inspectionPercentage1}) ì…ë‹ˆë‹¤.`
    		            ];
    		          
    		             startY = 23; // description ë†’ì´ ìœ„ì¹˜
    		            description4.forEach((line, index) => {
    		            	  doc.text(8, startY, line); // ì™¼ìª½ ì •ë ¬ (x: 8, y: startY)
    		            	  startY += 5; // ê° ì¤„ ê°„ê²©ì„ 5ë¡œ ì„¤ì •í•˜ì—¬ ë‹¤ìŒ ì¤„ë¡œ ë‚´ë ¤ê°
    		        	});
    		         
    		      // ğŸŸ¢ datasì— í•©ê³„ì™€ ë¹„ìœ¨ í–‰ ì¶”ê°€
    		         datas8.push(formattedTotals1);
    		         datas8.push(percentages1);
    		         
                	// í…Œì´ë¸” í—¤ë”
    		       const header7 = [
    		    	   	[ 
    		    		    { content: 'ìˆ˜ë¦¬ì¼ì', rowSpan: 2, border: [true, true, true, true] },  // ìˆ˜ë¦¬ì¼ì ì…€ì— í…Œë‘ë¦¬ ì¶”ê°€
    		    		    { content: 'ê±´ìˆ˜', rowSpan: 2, border: [true, true, true, true] },
    		    		    { content: 'ì‹ ê³ ê°€ê²©(KRW)', rowSpan: 2, border: [true, true, true, true] },
    		    		    { content: 'ìˆ˜ì¶œì‹ ê³  ê±°ë˜í˜•íƒœ í˜„í™©', colSpan: 5, border: [true, true, true, true] },  // ìˆ˜ì… ê±°ë˜í˜•íƒœ í˜„í™© ì…€ì— í…Œë‘ë¦¬ ì¶”ê°€
    		    		    { content: 'ìˆ˜ì¶œì‹ ê³  ì²˜ë¦¬í˜„í™©', colSpan: 3, border: [true, true, true, true] },  // ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™© ì…€ì— í…Œë‘ë¦¬ ì¶”ê°€
    		    		  ],  // ì²« ë²ˆì§¸ í–‰
    		    		  [
    		    		    { content: 'ì¼ë°˜ìˆ˜ì…', border: [true, true, true, true] },
    		    		    { content: 'ì›ìƒíƒœ', border: [true, true, true, true] },
    		    		    { content: 'ë°˜ì†¡ìˆ˜ì¶œ', border: [true, true, true, true] },
    		    		    { content: 'ìˆ˜ë¦¬ìš©', border: [true, true, true, true] },
    		    		    { content: 'ê¸°íƒ€ë¬´ìƒìˆ˜ì¶œ', border: [true, true, true, true] },
    		    		    { content: 'P/L', border: [true, true, true, true] },
    		    		    { content: 'ì œì¶œì„œë¥˜', border: [true, true, true, true] },
    		    		    { content: 'ê²€ì‚¬', border: [true, true, true, true] },
    		    		  ]
    		    	 ];
    		       
    		       
                	// ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
                	doc.autoTable({
                	  head: header7,
                	  body:datas8,
                	  startY: startY + 2, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
                	  theme: 'grid',
                	  styles: {
                	    font: 'NanumSquareR',
                	    fontSize: 7,
                	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
                	    textColor: [0, 0, 0],
                	    valign: 'middle',
                	    halign: 'center',
                	    overflow: 'linebreak', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ì ìš©
                	  },
                	  headStyles: {
                		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
                		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
                	    fontSize: 8,
                	    textColor: [255, 255, 255],
                	    font: 'NanumSquareEB',
                	    fontStyle: 'bold',
                	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
                	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
                	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
                	  },
                	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
                	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
                	  columnStyles: {
                		  	0: { halign: 'center' , cellWidth: 23 }, // ìˆ˜ë¦¬ì¼ì
                	        1: { halign: 'right' , cellWidth: 18}, // ê±´ìˆ˜
                	        2: { halign: 'right' , cellWidth: 23}, // ê³¼ì„¸ê°€ê²©
                	        3: { halign: 'center' , cellWidth: 17}, // ì¼ë°˜ìˆ˜ì…
                	        4: { halign: 'center' , cellWidth: 17}, // ìˆ˜ë¦¬ë¬¼í’ˆ
                	        5: { halign: 'center' , cellWidth: 17}, // ê²¬í’ˆ ë° ê´‘ê³ ìš©í’ˆ
                	        6: { halign: 'center' , cellWidth: 17}, // ê¸°íƒ€ ìˆ˜ì… ìŠ¹ì¸ë©´ì„¸
                	        7: { halign: 'center' , cellWidth: 17}, // ì¬ìˆ˜ì¶œì¡°ê±´
                	        8: { halign: 'center' , cellWidth: 17 }, // P/L
                	        9: { halign: 'center' , cellWidth: 17}, // ì œì¶œì„œë¥˜
                	        10: { halign: 'center' , cellWidth: 17}, // ê²€ì‚¬
                	  },
                	  didParseCell: function(data) {
                		    // ğŸŸ¢ í•©ê³„ í–‰ ìŠ¤íƒ€ì¼ ì ìš© (ë§ˆì§€ë§‰ì—ì„œ ë‘ ë²ˆì§¸ í–‰)
                		    if (data.row.index === datas8.length - 2) {
                		      data.cell.styles.fillColor = [246, 243, 202]; // ë°°ê²½
              	              data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
              	              data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
                		    }
                		    // ğŸŸ¢ ë¹„ìœ¨ í–‰ ìŠ¤íƒ€ì¼ ì ìš© (ë§ˆì§€ë§‰ í–‰)
                		    if (data.row.index === datas8.length - 1) {
                		    	data.cell.styles.fillColor = [246, 243, 202]; // ë°°ê²½
                	            data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
                	            data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
                		    }
                		  }
            		});
                	
                	// 5ë²ˆì§¸ í…Œì´ë¸” yì¢Œí‘œ ì €ì¥ 
                	lastYPage5 = doc.lastAutoTable.finalY; 
                	const pageAfterTable5 = doc.internal.getCurrentPageInfo().pageNumber;
                	
                	const spaceLeft5 = doc.internal.pageSize.height - lastYPage5 - 10;
                	
                	let chartPage5, chartY5;
                	
                	if(spaceLeft5< 70){
                		doc.addPage();
                		chartPage5 = pageAfterTable5 + 1;
                		chartY5 = 15;
                	}else{
                		 chartPage5 = pageAfterTable5;       // ê°™ì€ í˜ì´ì§€ì— ê·¸ë¦´ ìˆ˜ ìˆìŒ
                		  chartY5 = lastYPage5;
                	}
                	
                	// ê±°ë˜í˜•íƒœ 
                	// ë°ì´í„° ë³€í™˜ (NaN ë°©ì§€)
                	const safeParse1 = (value) => {
                	    let num = parseFloat(value ? value.replace('%', '') : 0);
                	    return isNaN(num) ? 0 : num;
                	};

                	if (Chart.getChart("myChart")) {  
                	    Chart.getChart("myChart").destroy();  
                	}
                	
                	// ì™¼ìª½ ì°¨íŠ¸ ë°ì´í„° ë³€í™˜
                	const pdf5ImgData = percentages1.slice(3, 7).map(safeParse1);
                	
                	// ì™¼ìª½ ì°¨íŠ¸ ìº”ë²„ìŠ¤ ìƒì„±
                	pdf5canvas = document.createElement('canvas');
                	const pdf5ctx = pdf5canvas.getContext('2d');
                	pdf5canvas.width = 500;
                	pdf5canvas.height = 500;

                	
                	
                	
                	// ì™¼ìª½ ì°¨íŠ¸ ìƒì„±
                	const pdf5chart = new Chart(pdf5ctx, {
                		plugins : [chartDataLabels2],
                		type: 'pie',
                	    data: {
                	        labels: ['ì¼ë°˜ìˆ˜ì¶œ', 'ì›ìƒíƒœ', 'ë°˜ì†¡ìˆ˜ì¶œ', 'ìˆ˜ë¦¬ìš©', 'ê¸°íƒ€ë¬´ìƒìˆ˜ì¶œ'],
                	        datasets: [{
                	            data: pdf5ImgData,
                	            backgroundColor: [  'rgb(113,162, 218)',
    				            	            	'rgb(48,123,202)', 
    				            	            	'rgb(166,196,232)',
    				            	            	'rgb(216,225,234)',
    				            	            	'rgb(40,101,168)']
    	            	        }]
    			            	
                	    },
                	    options: {
                	        responsive: false,
                	        maintainAspectRatio: false,  // ë¹„ìœ¨ ìœ ì§€ í•´ì œ
                	        layout: {
                	            padding: {
                	                bottom: 20, // ì°¨íŠ¸ í•˜ë‹¨ ì—¬ë°± (ë¼ë²¨ ê³µê°„ í™•ë³´)
                	                right : 90,
                	                left : 90
                	            }
                	        },
                	        plugins: {
                	        	datalabels: { 
                	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
                	            },
                	            legend: {
                	                position: 'bottom',
                	                fullWidth: true,
                	                labels: {
                	                    font: {
                	                        size: 18  // ë¼ë²¨ í¬ê¸° ë™ì¼
                	                        ,weight: 'bold'
                	                    },
                	                    boxWidth: 15,  // ì•„ì´ì½˜ í¬ê¸° ë™ì¼
                	                    padding: 15
                	                }
                	            },
                	            title: {
                	                display: true,
                	                text: 'ê±°ë˜í˜•íƒœ',
                	                font: {
                	                    size: 28,  // ì œëª© í¬ê¸° ë™ì¼
                	                    weight: 'bold'},
                	                padding: {
                	                    bottom: 20
                	                }
                	            }
                	        }
                	    }
                	});
                	
                	
                	// ì˜¤ë¥¸ìª½ ì°¨íŠ¸ (ìˆ˜ì…ì‹ ê³  ì²˜ë¦¬í˜„í™© ë¹„ìœ¨)
                	const pdf6ImgData = [
                	    parseFloat(percentages1[8].replace('%', '')) || 0, 
                	    parseFloat(percentages1[9].replace('%', '')) || 0, 
                	    parseFloat(percentages1[10].replace('%', '')) || 0 
                	];
                	
                	
                	// ì˜¤ë¥¸ìª½ ì°¨íŠ¸ ìº”ë²„ìŠ¤ ìƒì„±
                	pdf6canvas = document.createElement('canvas');
                	const pdf6Ctx = pdf6canvas.getContext('2d');
                	pdf6canvas.width = 500;
                	pdf6canvas.height = 500;

                	// ì˜¤ë¥¸ìª½ ì°¨íŠ¸ ìƒì„±
                	const pdf6chart = new Chart(pdf6Ctx, {
                		plugins : [chartDataLabels2],
                		type: 'pie',
                	    data: {
                	        labels: ['P/L', 'ì œì¶œì„œë¥˜', 'ê²€ì‚¬'],
                	        datasets: [{
                	            data: pdf6ImgData,
                	            backgroundColor: [  'rgb(48,123,202)', 				            	             
    				            	            	'rgb(113,162, 218)', 
    				            	            	'rgb(166,196,232)']
                	        }]
                	    },
                	    options: {
                	        responsive: false,
                	        maintainAspectRatio: false,  
                	        layout: {
                	            padding: {
                	                bottom: 70, // ì•„ë˜ìª½ ì—¬ë°± ì¶”ê°€
                	                left: 90,  // ì™¼ìª½ ì—¬ë°± ì¶”ê°€
                	                right: 90  // ì˜¤ë¥¸ìª½ ì—¬ë°± ì¶”ê°€
                	            }
                	        },
                	        plugins: {
                	        	datalabels: {
                 	                color: 'rgb(89,89,89)',
                 	                formatter: function(value, context) {
                 	                	let label = context.chart.data.labels[context.dataIndex];
                 	                   if (value < 10) {  // ê°’ì´ 10% ë¯¸ë§Œì¸ ê²½ìš° ë¼ë²¨ì„ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                 	                       return null;  
                 	                   }
                 	                    return label + " : " +value + "%"; // ë¼ë²¨ê³¼ í¼ì„¼íŠ¸ í‘œì‹œ
                 	                },
                 	                font: {
                 	                    size: 20,
                 	                    weight : 'bold'
                 	                },
                	        	}, 
                	        	datalabels: { 
               	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
                	        	},
                	        	legend: {
                	                position: 'bottom',
                	                fullWidth: true,
                	                labels: {
                	                    font: {
                	                        size: 18  // ë¼ë²¨ í¬ê¸° ë™ì¼
                	                        ,weight: 'bold'
                	                    },
                	                    boxWidth: 15,  // ì•„ì´ì½˜ í¬ê¸° ë™ì¼
                	                    padding: 15
                	                }
                	            },
                	            title: {
                	                display: true,
                	                text: 'ì‹ ê³ ì²˜ë¦¬',
                	                font: {
                	                    size: 28,  // ì œëª© í¬ê¸° ë™ì¼
                	                    weight: 'bold'
                	                },
                	                padding: {
                	                    bottom: 10
                	                }
                	            }
                	        }
                	    }
                	});
                	
                	// ğŸŸ¢ í˜ì´ì§€ ì¶”ê°€
                    doc.addPage();
                    
                    doc.setFontSize(16);
                    doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                    doc.setFont('NanumSquareB', 'normal');
                    //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                    doc.setTextColor(71, 140, 114); 
                    doc.text(8, 15, "8.ì£¼ìš” í•´ì™¸ ê±°ë˜ì²˜(ìˆ˜ì¶œ)");
                    
                    // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                    const boxMargin9 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                    const boxWidth9 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                    const boxHeight9 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                    
                    doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                    doc.setDrawColor(35, 69,56); 
                    doc.rect(5, 8, boxWidth9, boxHeight9, 'D'); 
                    
                    const reportData10 = data.reportData10;
                   console.log("reportData10",reportData10);
                    // ìˆ˜ì¶œê¸ˆì•¡ ì´í•© ê³„ì‚°
                    const totalTotRptKrw  = reportData10.reduce((sum, item) => sum + item.totRptKrw, 0);
                   console.log("totalTotRptKrw",totalTotRptKrw);
                    const datas9 = reportData10.map(item => {
      	              const formattedTotExp = Intl.NumberFormat("ko-KR").format(item.cmtExp); 
      	              const formattedConTotRptKrw = Intl.NumberFormat("ko-KR").format(item.totRptKrw);
      	              
      	              // ë¹„ìœ¨ ê³„ì‚° (ì´ì•¡ ëŒ€ë¹„ ë°±ë¶„ìœ¨)
      	              const rpt = Number(item.totRptKrw || 0); // ì•ˆì „í•˜ê²Œ ìˆ«ì ë³€í™˜

	      	          // ë¹„ìœ¨ ê³„ì‚°
	      	          const expPercentage = totalTotRptKrw > 0
	      	            ? ((rpt / totalTotRptKrw) * 100).toFixed(2) + "%"
	      	            : "0%";
      	              
      	              return [
      	            	  item.buyFirm,            // í•´ì™¸ê±°ë˜ì²˜
      	            	  item.taStIsonm,        	// êµ­ê°€
      	            	  formattedTotExp,			// ê±´ìˆ˜
      	            	  formattedConTotRptKrw,    // ìˆ˜ì¶œê¸ˆì•¡
      	            	  expPercentage				// ë¹„ìœ¨
      	              ];
      	            });
    	            
    	            // í…Œì´ë¸” í—¤ë”
    	            var header8 = [['í•´ì™¸ê±°ë˜ì²˜','êµ­ê°€','ê±´ìˆ˜','ìˆ˜ì¶œê¸ˆì•¡','ë¹„ìœ¨']];
    	            
    	            
    	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
                	doc.autoTable({
                	  head: header8,
                	  body:datas9,
                	  startY: 24, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
                	  theme: 'grid',
                	  styles: {
                	    font: 'NanumSquareR',
                	    fontSize: 7,
                	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
                	    textColor: [0, 0, 0],
                	    valign: 'middle',
                	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                        wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
                	  },
                	  headStyles: {
                		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
                		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
                	    fontSize: 8,
                	    textColor: [255, 255, 255],
                	    font: 'NanumSquareEB',
                	    fontStyle: 'bold',
                	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
                	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
                	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
                	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                        wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                        halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
                	  },
                	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
                	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
                	  columnStyles: {
                		  	0: { halign: 'center'}, // í•´ì™¸ê±°ë˜ì²˜
                	        1: { halign: 'center'}, // êµ­ê°€
                	        2: { halign: 'right'}, // ê±´ìˆ˜
                	        3: { halign: 'right'}, // ìˆ˜ì¶œê¸ˆì•¡
                	        4: { halign: 'right'}, // ë¹„ìœ¨
                	  },
            		});
                	
                	lastYPage7 = doc.lastAutoTable.finalY;  
                	const pageAfterTable7 = doc.internal.getCurrentPageInfo().pageNumber;
                	
                	const spaceLeft7 = doc.internal.pageSize.height - lastYPage7 - 10;
                	
                	let chartPage7, chartY7;
                	
                	if(spaceLeft7< 120){
                		doc.addPage();
                		chartPage7 = pageAfterTable7 + 1;
                		chartY7 = 15;
                	}else{
                		 chartPage7 = pageAfterTable7;       // ê°™ì€ í˜ì´ì§€ì— ê·¸ë¦´ ìˆ˜ ìˆìŒ
                		  chartY7 = lastYPage7;
                	}
                	
                	
                	
                	const pdf8canvas = document.createElement("canvas");
                	const pdf8ctx = pdf8canvas.getContext("2d");
                	pdf8canvas.width = 1000;
                	pdf8canvas.height = 1000;
                	pdf8canvas.style.visibility = 'hidden';
                	document.body.appendChild(pdf8canvas);
                	
                	// í”ŒëŸ¬ê·¸ì¸ ì •ì˜
                	const chartDataLabels4 = {
                	  id: 'chartDataLabels',
                	  afterDraw(chart, args, options) {
                	    const ctx4 = chart.ctx;
                	    ctx4.textAlign = "center";
                	    ctx4.textBaseline = "middle";
                	    ctx4.fillStyle = '#000';
                	    ctx4.font = "16px NanumSquare";
                	    ctx4.lineWidth =3;

                	    const prevTextPositions4 = [];

                	    chart.data.datasets.forEach((dataset, i) => {
                	      chart.getDatasetMeta(i).data.forEach((datapoint, index) => {
                	        //const supFirm = chart.data.labels[index]; // supFirm ì´ë¦„
                	        const expPercentage = dataset.data[index];   // ë¹„ìœ¨ ìˆ«ì

                	        if (expPercentage < 1) return;

                	        const { x, y } = datapoint.tooltipPosition();
                	        const radius = chart.outerRadius || (chart.chartArea.width / 2);
                	        const angle = (datapoint.startAngle + datapoint.endAngle) / 2;

                	        const xOuter = x + (radius * 0.4) * Math.cos(angle);
                	        const yOuter = y + (radius * 0.4) * Math.sin(angle);

                	        const xMiddle = xOuter + Math.cos(angle) * 20;
                	        const yMiddle = yOuter + Math.sin(angle) * 20;

                	        let xLine = xMiddle + (Math.cos(angle) >= 0 ? 20 : -20);
                	        let yLine = yMiddle;

                	        const minDistance = 90;
                	        let attempts = 0;

                	        // í…ìŠ¤íŠ¸ ê°„ê²© ì¡°ì • ë°˜ë³µ
                	        prevTextPositions4.forEach((prevPos) => {
    		                    const dist2 = Math.sqrt(Math.pow(xLine - prevPos.x, 2) + Math.pow(yLine - prevPos.y, 2));
    		                    if (dist2 < minDistance) {
    		                        // ê²¹ì¹  ê²½ìš° ìœ„ì¹˜ ì¡°ì •1
    		                        const angleOffset2 = Math.PI / 18;  // ì•½ê°„ì˜ ê°ë„ ì˜¤í”„ì…‹ì„ ì¶”ê°€í•˜ì—¬ ì´ë™
    		                        xLine = xMiddle + (Math.cos(angle + angleOffset2) * 10);
    		                        yLine = yMiddle + (Math.sin(angle + angleOffset2) * 10);
    		                    }
    		                });

                	        prevTextPositions4.push({ x: xLine, y: yLine });

                	        ctx4.beginPath();
                	        ctx4.moveTo(xOuter, yOuter);
                	        ctx4.lineTo(xMiddle, yMiddle);
                	        ctx4.lineTo(xLine, yLine);
                	        ctx4.strokeStyle = 'rgba(129,212,250,0.9)';
                	        ctx4.stroke();

                	        ctx4.textAlign = Math.cos(angle) >= 0 ? "left" : "right";

                	       
                	        //let labelText = `${supFirm} : ${percentage.toFixed(2)}%`;
                	        let labelText = `${expPercentage.toFixed(2)}%`;

                	        ctx4.fillText(labelText, xLine, yLine);
                	      });
                	    });
                	  }
                	};

                	
                	// 1% ì´ìƒì¸ ë°ì´í„°ë§Œ í•„í„°ë§
                	const chartDataFilter = reportData10
                	  .map(item => {
                	    	const rpt = Number(item.totRptKrw || 0); // ê¸ˆì•¡
                	        const percentage = totalTotRptKrw > 0 ? (rpt / totalTotRptKrw) * 100 : 0;
                	        
                	        return {
                	          buyFirm: item.buyFirm,
                	          percentage: percentage
                	        };
                	      })
                	  .filter(item => item.percentage >= 5); //  ğŸ”¥3% ì´ìƒë§Œ

                	// ë¼ë²¨: supFirm ì´ë¦„
                	const expLabels = chartDataFilter.map(item => item.buyFirm);

                	// ë°ì´í„°: ë¹„ìœ¨ (ì†Œìˆ˜ì  2ìë¦¬)
                	const expPieData = chartDataFilter.map(item => Number(item.percentage.toFixed(2)));
                	
                	const pdf8chart = new Chart(pdf8ctx, {
                		plugins : [chartDataLabels4],
                			type: "pie",
    	            	    data: {
    	            	        labels: expLabels,
    	            	        datasets: [{
    	            	            data: expPieData,
    	            	            backgroundColor: [
    	            	            	'rgba(1,87,155,0.7)',
    	            	            	'rgba(2,119,189,0.7)',
    	            	            	'rgba(2,136,209,0.7)',
    	            	            	'rgba(3,155,229,0.7)',
    	            	            	'rgba(3,169,244,0.7)',
    	            	            	'rgba(41,182,246,0.7)',
    	            	            	'rgba(79,195,247, 0.7)',
    	            	            	'rgba(129,212,250,0.7)',
    	            	            	'rgba(179,229,252,0.7)',
    	            	            	'rgba(166,208,228,0.7)',
    	            	            	]
    	            	        }]
    	            	    },
    	            	    options: {
    	            	    	 responsive: false, // âœ… ì°¨íŠ¸ í¬ê¸° ìë™ ì¡°ì ˆ ë¹„í™œì„±í™”
    	            	         maintainAspectRatio: true, // âœ… ì›í˜• ë¹„ìœ¨ ìœ ì§€ ë¹„í™œì„±í™”
    	            	        layout: {
    	            	        	padding: {
    	            	                top: 300,
    	            	                right: 320,
    	            	                bottom: 30,
    	            	                left: 320
    	            	            }
    	            	        },
    	            	        plugins: {
    	            	            legend: { 
    	            	            	position: "bottom",
    	            	            	 fullWidth: true,
    	            	            	labels : {
    	            	            		boxWidth : 8,
    	            	            		padding : 10,
    	            	            		font : {
    	            	            			size : 13,
    	            	            			//weight : 'bold'
    	            	            		}
    	            	            	}

    	            	            },
    	            	            title : {
    	            	            	display: true,
    	            	            	text: 'ì£¼ìš” í•´ì™¸ê±°ë˜ì²˜(ìˆ˜ì¶œ)',
    	            	            	font : {size :24 ,weight : 'bold'},
    	            	            	padding: {bottom :30}
    	            	            },
    	            	            tooltip: {
    	             	               enabled : false // íˆ´íŒ ë¹„í™œì„±í™”
    	             	            },
    	             	            datalabels: { 
    	             	            	 display: false // âœ… ì°¨íŠ¸ ë‚´ë¶€ ë°ì´í„° ìˆ¨ê¹€
    	             	            }
    	            	        }
    	            	    },
    	            	});
                	
                	// ğŸŸ¢ í˜ì´ì§€ ì¶”ê°€
                    doc.addPage();
                    
                    doc.setFontSize(16);
                    doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                    doc.setFont('NanumSquareB', 'normal');
                    //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                    doc.setTextColor(71, 140, 114); 
                    doc.text(8, 15, "9.ìˆ˜ì¶œì… ì •ì • ê·€ì±…ìë³„ ë¹„ìœ¨");
                    
                    // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                    const boxMargin10 = 5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                    const boxWidth10 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                    const boxHeight10 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                    
                    doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                    doc.setDrawColor(35, 69,56); 
                    doc.rect(5, 8, boxWidth10, boxHeight10, 'D'); 
                    
                    const reportData11 = data.reportData11;
                   console.log("reportData11",reportData11);
                   
                   const datas10 = [];

                   
                   for (let i = 0; i < reportData11.length; i += 2) {
                	   const row1 = reportData11[i];     // ê±´ìˆ˜
                	   const row2 = reportData11[i + 1]; // ë¹„ìœ¨

                	   datas10.push([
                	     {
                	       content: row1.div1,  // ìˆ˜ì… or ìˆ˜ì¶œ
                	       rowSpan: 2,
                	       styles: { halign: 'center', valign: 'middle' }
                	     },
                	     { content: row1.div2, styles: { halign: 'center' } },
                	     { content: row1.cunt1, styles: { halign: 'right' } },
                	     { content: row1.cunt2, styles: { halign: 'right' } },
                	     { content: row1.cunt3, styles: { halign: 'right' } },
                	     { content: row1.cunt4, styles: { halign: 'right' } },
                	     { content: row1.total, styles: { halign: 'right' } }
                	   ]);

                	   datas10.push([
                	     { content: row2.div2, styles: { halign: 'center' } },
                	     { content: row2.cunt1, styles: { halign: 'right' } },
                	     { content: row2.cunt2, styles: { halign: 'right' } },
                	     { content: row2.cunt3, styles: { halign: 'right' } },
                	     { content: row2.cunt4, styles: { halign: 'right' } },
                	     { content: row2.total, styles: { halign: 'right' } }
                	   ]);
                	 }
                
    	            // í…Œì´ë¸” í—¤ë”
    	            var header9 = [
    	            	  	[
    	            		    { content: 'êµ¬ë¶„', colSpan: 2, styles: { halign: 'center' } },
    	            		    { content: 'ì‹ ê³ ì¸', styles: { halign: 'center' } },
    	            		    { content: 'ì‹ ê³ ì˜ë¢°ì¸(í™”ì£¼ ë“±)', styles: { halign: 'center' } },
    	            		    { content: 'ì™¸êµ­ì¸êµ¬ë§¤ì(íŒë§¤ì)', styles: { halign: 'center' } },
    	            		    { content: 'ê¸°íƒ€', styles: { halign: 'center' } },
    	            		    { content: 'í•©ê³„', styles: { halign: 'center' } }
    	            		  ]
    	            		];
    	            
    	            
    	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
                	doc.autoTable({
                	  head: header9,
                	  body:datas10,
                	  startY: 24, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
                	  theme: 'grid',
                	  styles: {
                	    font: 'NanumSquareR',
                	    fontSize: 7,
                	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
                	    textColor: [0, 0, 0],
                	    valign: 'middle',
                	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                        wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
                	  },
                	  headStyles: {
                		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
                		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
                	    fontSize: 8,
                	    textColor: [255, 255, 255],
                	    font: 'NanumSquareEB',
                	    fontStyle: 'bold',
                	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
                	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
                	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
                	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                        wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                        halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
                	  },
                	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
                	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
                	  columnStyles: {
                		  0: { halign: 'center' },
                		  1: { halign: 'center' },
                		  2: { halign: 'right' },
                		  3: { halign: 'right' },
                		  4: { halign: 'right' },
                		  5: { halign: 'right' },
                		  6: { halign: 'right' }
                	  },
            		});
                	
                	lastYPage8 = doc.lastAutoTable.finalY;
                    
                    doc.setFontSize(16);
                    doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                    doc.setFont('NanumSquareB', 'normal');
                    //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                    doc.setTextColor(71, 140, 114); 
                    doc.text(8, lastYPage8 + 20, "10.ìˆ˜ì¶œì… ì •í˜•ì¡°ê±´");
                    
                    // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                    const boxMargin11 =  5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                    const boxWidth11 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                    const boxHeight11 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                    
                    doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                    doc.setDrawColor(35, 69,56); 
                    doc.rect(5, lastYPage8 + 13, boxWidth11, boxHeight11, 'D'); 
                    
                    const reportData12 = data.reportData12;
                   console.log("reportData12",reportData12);
                   
                   
                   // 1. ê°ê° ì´í•© ê³„ì‚°
                   const totalImpAmt = reportData12.reduce((sum, item) => sum + Number(item.impAmt || 0), 0);
                   const totalExpAmt = reportData12.reduce((sum, item) => sum + Number(item.expAmt || 0), 0);

                   // 2. map ëŒë©´ì„œ ë¹„ìœ¨ ê³„ì‚°
                   const datas11 = reportData12.map(item => {
                	 const formattedlmpAmt = Intl.NumberFormat("ko-KR").format(item.impAmt); 
                	 const formattedEmpAmt = Intl.NumberFormat("ko-KR").format(item.expAmt); 
                     const impAmt = Number(item.impAmt || 0);
                     const expAmt = Number(item.expAmt || 0);

                     // ìˆ˜ì… ë¹„ìœ¨
                     const impRate = totalImpAmt === 0 ? '0.0%' : ((impAmt / totalImpAmt) * 100).toFixed(1) + '%';
                     // ìˆ˜ì¶œ ë¹„ìœ¨
                     const expRate = totalExpAmt === 0 ? '0.0%' : ((expAmt / totalExpAmt) * 100).toFixed(1) + '%';

                     return [
                       item.incoterms,  // ì¸ì½”í…€ì¦ˆ
                       item.impCnt,     // ìˆ˜ì… ê±´ìˆ˜
                       formattedlmpAmt, // ìˆ˜ì… ê¸ˆì•¡
                       impRate,         // ìˆ˜ì… ë¹„ìœ¨
                       item.expCnt,     // ìˆ˜ì¶œ ê±´ìˆ˜
                       formattedEmpAmt, // ìˆ˜ì¶œ ê¸ˆì•¡
                       expRate          // ìˆ˜ì¶œ ë¹„ìœ¨
                     ];
                   });
                   
                   
                // í…Œì´ë¸” í—¤ë”
    		       const header10 = [
    		    	   	[ 
    		    		    { content: 'ì¸ì½”í…€ì¦ˆ', rowSpan: 3, border: [true, true, true, true] },  // ìˆ˜ë¦¬ì¼ì ì…€ì— í…Œë‘ë¦¬ ì¶”ê°€
    		    		    { content: 'ìˆ˜ì…', colSpan: 3, border: [true, true, true, true] },
    		    		    { content: 'ìˆ˜ì¶œ', colSpan: 3, border: [true, true, true, true] },
    		    		  ],  // ì²« ë²ˆì§¸ í–‰
    		    		  [
      		    		    { content: 'ì‹ ê³ ê¸ˆì•¡(USD)',colSpan: 3, border: [true, true, true, true] },
      		    		    { content: 'ì‹ ê³ ê¸ˆì•¡(USD)',colSpan: 3, border: [true, true, true, true] },
      		    		    
      		    		  ],
    		    		  [
    		    		    { content: 'ê±´ìˆ˜', border: [true, true, true, true] },
    		    		    { content: 'ê¸ˆì•¡', border: [true, true, true, true] },
    		    		    { content: 'ë¹„ìœ¨', border: [true, true, true, true] },
    		    		    { content: 'ê±´ìˆ˜', border: [true, true, true, true] },
    		    		    { content: 'ê¸ˆì•¡', border: [true, true, true, true] },
    		    		    { content: 'ë¹„ìœ¨', border: [true, true, true, true] },
    		    		  ]
    		    	 ];
    		       
    	            // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
                	doc.autoTable({
                	  head: header10,
                	  body:datas11,
                	  startY: lastYPage8 + 29, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
                	  theme: 'grid',
                	  styles: {
                	    font: 'NanumSquareR',
                	    fontSize: 7,
                	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
                	    textColor: [0, 0, 0],
                	    valign: 'middle',
                	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                        wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
                	  },
                	  headStyles: {
                		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
                		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
                	    fontSize: 8,
                	    textColor: [255, 255, 255],
                	    font: 'NanumSquareEB',
                	    fontStyle: 'bold',
                	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
                	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
                	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
                	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                        wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                        halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
                	  },
                	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
                	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
                	  columnStyles: {
                		  0: { halign: 'center' },
                		  1: { halign: 'right' },
                		  2: { halign: 'right' },
                		  3: { halign: 'right' },
                		  4: { halign: 'right' },
                		  5: { halign: 'right' },
                		  6: { halign: 'right' }
                	  },
            		});
                	
                	lastYPage9 = doc.lastAutoTable.finalY;
                	
                    doc.setFontSize(16);
                    doc.addFont('/pf/fonts/NanumSquareB.ttf', 'NanumSquareB', 'normal');
                    doc.setFont('NanumSquareB', 'normal');
                    //doc.setTextColor(62, 113, 175); //íŒŒë€ìƒ‰
                    doc.setTextColor(71, 140, 114); 
                    doc.text(8, lastYPage9 + 20, "11.ì„¸ê´€ë³„ ì‹ ê³ ê±´ìˆ˜ ë° ê¸ˆì•¡");
                    
                    // ì œëª© + ì„¤ëª…ì„ ë„£ì„ ì˜ì—­ì„ ë„¤ëª¨ë°•ìŠ¤ë¡œ ê·¸ë¦¬ê¸°
                    const boxMargin12 =  5;  // í…Œë‘ë¦¬ì™€ì˜ ì—¬ë°±
                    const boxWidth12 = 200;  // ë°•ìŠ¤ì˜ ë„ˆë¹„
                    const boxHeight12 = 15;  // ë°•ìŠ¤ì˜ ë†’ì´ (ì„¤ëª… í¬í•¨)
                    
                    doc.setLineWidth(0.5);  // í…Œë‘ë¦¬ ë‘ê»˜ ì„¤ì • (ê¸°ë³¸ê°’ì€ 0.2)
                    doc.setDrawColor(35, 69,56); 
                    doc.rect(5, lastYPage9 + 13, boxWidth12, boxHeight12, 'D'); 
                    
                    const reportData13 = data.reportData13;
                    console.log("reportData13",reportData13);
                    
                    const datas12 = [];
                    let currentGroupStartRow = 0;

                    reportData13.forEach((item, index) => {
                      const formattedCnt = Intl.NumberFormat("ko-KR").format(item.cnt);
                      const formattedTaxKrw = Intl.NumberFormat("ko-KR").format(item.taxKrw);
                      const formattedTaxSum = Intl.NumberFormat("ko-KR").format(item.taxSum);
                      const formattedTaxUsd = Intl.NumberFormat("ko-KR").format(item.taxUsd);


                      datas12.push([
                    	item.al,
                        item.cus,
                        item.cusnm,
                        formattedCnt,
                        formattedTaxUsd,
                        formattedTaxKrw,
                        formattedTaxSum,
                        item.taxRate,
                      ]);
                    });
                    
                 // í…Œì´ë¸” í—¤ë”
    	            var header11 = [['êµ¬ë¶„','ì„¸ê´€ì½”ë“œ','ì„¸ê´€ëª…','ì‹ ê³ ê±´ìˆ˜','ì‹ ê³ ê¸ˆì•¡(USD)','ê³¼ì„¸ê°€ê²©(ì›í™”)','ë‚©ë¶€ì„¸ì•¡','ë¹„ì¤‘']];
                    
    	         // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
                	doc.autoTable({
                	  head: header11,
                	  body:datas12,
                	  startY: lastYPage9 + 29, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
                	  theme: 'grid',
                	  styles: {
                	    font: 'NanumSquareR',
                	    fontSize: 7,
                	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
                	    textColor: [0, 0, 0],
                	    valign: 'middle',
                	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                        wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
                	  },
                	  headStyles: {
                		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
                		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
                	    fontSize: 8,
                	    textColor: [255, 255, 255],
                	    font: 'NanumSquareEB',
                	    fontStyle: 'bold',
                	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
                	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
                	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
                	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                        wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                        halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
                	  },
                	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
                	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
                	  columnStyles: {
                		  	0: { halign: 'center'},
                	        1: { halign: 'center'},
                	        2: { halign: 'center'},
                	        3: { halign: 'right'},
                	        4: { halign: 'right'},
                	        5: { halign: 'right'},
                	        6: { halign: 'right'},
                	        7: { halign: 'right'},
                	  },
                	  didParseCell: function (data) {
                		    // ë°ì´í„° ì…€ì´ê³ , 'í•©ê³„'ì¸ ê²½ìš°
                		    if (data.section === 'body' && data.row.raw[0] === 'í•©ê³„') {
                		      data.cell.styles.fillColor = [246, 243, 202]; // ë°°ê²½
              	              data.cell.styles.font = 'NanumSquareB'; // êµµì€ í°íŠ¸ ì ìš©
              	              data.cell.styles.fontStyle = 'bold'; // ë³¼ë“œ ì²˜ë¦¬
                		    }
                		  }
                		});
                	
            		/*lastYPage10 = doc.lastAutoTable.finalY;
                	
                    const reportData14 = data.reportData14;
                    console.log("reportData14",reportData14);
                    
                    let lastAl1 = null; // <-- ì´ ì¤„ì„ map() í•¨ìˆ˜ ë°”ê¹¥ì— ì„ ì–¸í•´ì¤˜ì•¼ í•´
                    let rowSpanTracker1 = {};
                    let rowIndex1 = 0;
                    
                    const datas13 = reportData14.map(item => {
      	              const formattedCnt = Intl.NumberFormat("ko-KR").format(item.cnt);
      	              const formattedTaxKrw = Intl.NumberFormat("ko-KR").format(item.taxKrw);
      	              const formattedTaxSum = Intl.NumberFormat("ko-KR").format(item.taxSum);
      	              const formattedTaxUsd = Intl.NumberFormat("ko-KR").format(item.taxUsd);
      	              
      	            // rowspanì„ ìœ„í•´ í˜„ì¬ alì´ ì´ì „ê³¼ ë‹¤ë¥¸ ê²½ìš°ë§Œ í‘œì‹œ
      	            const showAl1 = item.al !== lastAl1;
	      	          if (showAl1) {
	      	            const sameAlCount1 = reportData13.filter(i => i.al === item.al).length;
	      	            rowSpanTracker1[rowIndex1] = { text: item.al, rowSpan: sameAlCount1 };
	      	            lastAl1 = item.al;
	      	          }
      	              
      	          const row = [
      	            item.al,                // ë‚˜ì¤‘ì— ì»¤ìŠ¤í…€ ë Œë”ë§ í•  ì—´
      	            item.cus,
      	            item.cusnm,
      	            formattedCnt,
      	            formattedTaxUsd,
      	            formattedTaxKrw,
      	            formattedTaxSum,
      	            item.taxRate,
      	          ];

      	          rowIndex++;
      	          return row;
      	        });
                    
                 // í…Œì´ë¸” í—¤ë”
    	            var header12 = [['êµ¬ë¶„','ì„¸ê´€ì½”ë“œ','ì„¸ê´€ëª…','ì‹ ê³ ê±´ìˆ˜','ì‹ ê³ ê¸ˆì•¡(USD)','ê³¼ì„¸ê°€ê²©(ì›í™”)','ë‚©ë¶€ì„¸ì•¡','ë¹„ì¤‘']];
                    
    	         // ğŸŸ¢ í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì ìš©
                	doc.autoTable({
                	  head: header12,
                	  body:datas13,
                	  startY: lastYPage10 + 5, // ì„¤ëª… ì•„ë˜ì— í…Œì´ë¸” ë°°ì¹˜
                	  theme: 'grid',
                	  styles: {
                	    font: 'NanumSquareR',
                	    fontSize: 7,
                	    cellPadding: 2,   // ì…€ íŒ¨ë”©ì„ ì¤„ì—¬ì„œ í–‰ ë†’ì´ ì¤„ì´ê¸°
                	    textColor: [0, 0, 0],
                	    valign: 'middle',
                	    overflow: 'hidden', // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆì„ ë°©ì§€í•˜ê³  ë„˜ì¹˜ì§€ ì•Šê²Œ ì„¤ì •
                        wordWrap: 'normal', // ì¤„ë°”ê¿ˆ ë°©ì§€ (í•œ ì¤„ë¡œë§Œ ë³´ì´ê²Œ)
                	  },
                	  headStyles: {
                		//fillColor: [36, 83, 118], // í—¤ë” ë°°ê²½ (íŒŒë€)
                		fillColor: [35, 69, 56], // í—¤ë” ë°°ê²½ (ì´ˆë¡)
                	    fontSize: 8,
                	    textColor: [255, 255, 255],
                	    font: 'NanumSquareEB',
                	    fontStyle: 'bold',
                	    cellPadding: 2, // í—¤ë” ë†’ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŒ¨ë”©ì„ ì ê²Œ ì„¤ì •
                	    lineWidth: 0.2, // í…Œë‘ë¦¬ ë‘ê»˜
                	    border: [true, true, true, true],  // í—¤ë”ì— í…Œë‘ë¦¬ ì¶”ê°€
                	    overflow: 'linebreak', // í—¤ë”ì˜ í…ìŠ¤íŠ¸ê°€ ë‘ ì¤„ë¡œ ë„˜ì–´ê°€ë„ë¡ ì„¤ì •
                        wordWrap: 'break-word', // í…ìŠ¤íŠ¸ê°€ ì…€ ë„ˆë¹„ë¥¼ ë„˜ì–´ì„œë©´ ì¤„ë°”ê¿ˆ ë˜ë„ë¡ ì„¤ì •
                        halign: 'center', // í…ìŠ¤íŠ¸ ê°€ìš´ë° ì •ë ¬
                	  },
                	  tableWidth: 'auto', // PDF í¬ê¸°ì— ë§ê²Œ ìë™ ì¡°ì •
                	  margin: { left: 5, right: 5 }, // ì¢Œìš° ê³µë°± ì¶”ê°€
                	  columnStyles: {
                		  	0: { halign: 'center'},
                	        1: { halign: 'center'},
                	        2: { halign: 'center'},
                	        3: { halign: 'right'},
                	        4: { halign: 'right'},
                	        5: { halign: 'right'},
                	        6: { halign: 'right'},
                	        7: { halign: 'right'},
                	  },
                	  didParseCell: function (data) {
                		    if (data.section === 'body' && data.column.index === 0) {
                		      const rowSpanInfo = rowSpanTracker[data.row.index];
                		      if (rowSpanInfo) {
                		        data.cell.rowSpan = rowSpanInfo.rowSpan;
                		        data.cell.text = rowSpanInfo.text;
                		      } else {
                		        // ë³‘í•©ëœ ì…€ ì•„ë˜ìª½ì€ ìˆ¨ê¹€ ì²˜ë¦¬
                		        data.cell.text = '';
                		      }
                		    }
                		  },
            		});*/
            	
	            	
	            setTimeout(() => {
	            	const imgData = canvas.toDataURL('image/png'); // ì™¼ìª½ ì°¨íŠ¸ ìº”ë²„ìŠ¤ë¥¼ PNGë¡œ ë³€í™˜
	                const rightImgData = rightCanvas.toDataURL('image/png'); // ì˜¤ë¥¸ìª½ ì°¨íŠ¸ ìº”ë²„ìŠ¤ë¥¼ PNGë¡œ ë³€í™˜
	                const pdf2ImgData = pdf2canvas.toDataURL('image/png');
	                const pdf3ImgData = pdf3canvas.toDataURL('image/png');
	                const pdf4ImgData = pdf4canvas.toDataURL('image/png');
	                const pdf5ImgData = pdf5canvas.toDataURL('image/png');
	                const pdf6ImgData = pdf6canvas.toDataURL('image/png');
	                const pdf7ImgData = pdf7canvas.toDataURL('image/png');
	                const pdf8ImgData = pdf8canvas.toDataURL('image/png');
	               

	                doc.setPage(chartPage1);
	                doc.addImage(imgData, 'PNG', 25, chartY1, 60, 60);      // ì™¼ìª½ ì°¨íŠ¸
	                doc.addImage(rightImgData, 'PNG', 125, chartY1, 60, 60); // ì˜¤ë¥¸ìª½ ì°¨íŠ¸
            	    
	                doc.setPage(chartPage2);
            	    doc.addImage(pdf2ImgData, 'PNG', 15, chartY2, 180, 70); // ì „ì›” ëŒ€ë¹„ ì°¨íŠ¸ (x, y, width, height)
            	    
            	    doc.setPage(chartPage3);
            	    doc.addImage(pdf3ImgData, 'PNG', 43, chartY3, 120, 120);
            	    
            	    doc.setPage(chartPage4);
            	   
            	    doc.addImage(pdf4ImgData, 'PNG', 55, chartY4-10,100,100);
            	    
            	    doc.setPage(chartPage5);  
            	    
            	    doc.addImage(pdf5ImgData, 'PNG', 25, chartY5+5, 60, 60); // ì™¼ìª½ ì°¨íŠ¸ (x, y, width, height)
            	    doc.addImage(pdf6ImgData, 'PNG', 125, chartY5+5 , 60, 60); // ì˜¤ë¥¸ìª½ ì°¨íŠ¸ (x, y, width, height)
            	    
            	    doc.setPage(chartPage6);
            	    
            	    doc.addImage(pdf7ImgData, 'PNG', 15, chartY6-45,180,180);
            	    
            	    doc.setPage(chartPage7);
            	   
            	    doc.addImage(pdf8ImgData, 'PNG', 15, chartY7-45,180,180);
            	    //doc.addImage(pdf7ImgData, 'PNG', 15, lastYPage6 , pdfWidth, pdfHeight);

            	    // ğŸŸ¢ í˜ì´ì§€ ë²ˆí˜¸ ì¶”ê°€
            	    let totalPages = doc.getNumberOfPages();
            	    for (let i = 3; i <= totalPages; i++) {
            	        doc.setPage(i);
            	        doc.setFontSize(9);
            	        doc.setTextColor(0, 0, 0);
            	        doc.text(`-${i-2}-`, 105, 290, { align: "center" }); // ì¤‘ì•™ ì •ë ¬
            	    }
            	    
            	    // ğŸŸ¢ PDF ì €ì¥
	               doc.save(String(data.rptDate1) + 'ë…„ ' + String(data.rptDate2) + 'ì›”_' + String(data.cmpnyInfo) +'_'+'_report.pdf');
	               fn_loading(false);
				    fn_dashInfo1("02");
					fn_dashManagerInfo();
					fn_dashSrch();

	            }, 3000); // 3ì´ˆ ë”œë ˆì´ (ì°¨íŠ¸ ë Œë”ë§ ê¸°ë‹¤ë¦¬ê¸°)
        }

        img.onerror = function() {
            console.error("Failed to load background image");
        };

	}




